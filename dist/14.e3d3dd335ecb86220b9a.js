(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{299:function(e,t,a){},345:function(e,t,a){"use strict";a(299)},389:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.analysis?a("app-content",{attrs:{title:e.analysis.name||"",navback:!0,eventId:e.analysis.id},scopedSlots:e._u([{key:"subtitle",fn:function(){return[e.analysis.current_state?a("div",[a("b",[e._v(e._s(e.$t(e.analysis.current_state.state.name)))])]):e._e()]},proxy:!0}],null,!1,80026355)},[a("div",{staticClass:"app-edit-analysis"},[a("b-tabs",[a("b-tab",{staticClass:"app-edit-analysis-download-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"download"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("download")))])]},proxy:!0}],null,!1,1288288109)},[a("app-download-analysis-files",{attrs:{analysis:e.analysis}})],1),e.uploadAllowed?a("b-tab",{staticClass:"app-edit-analysis-upload-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"upload"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("upload")))])]},proxy:!0}],null,!1,3987617677)},[a("app-upload-analysis-files",{attrs:{analysis:e.analysis}})],1):e._e(),a("b-tab",{staticClass:"app-edit-analysis-edit-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"pencil-square"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("edit")))])]},proxy:!0}],null,!1,725662720)},[a("b-row",[a("b-col",{attrs:{sm:""}},[a("app-box",{attrs:{title:e.$t("edit-analysis")}},[a("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmitEditAnalysis(t)}}},[a("b-form-group",{attrs:{label:e.$t("acquisition-date"),"label-cols-sm":"4","label-cols-lg":"2"}},[a("b-datepicker",{attrs:{required:""},model:{value:e.flownAt,callback:function(t){e.flownAt=t},expression:"flownAt"}})],1),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("apply")))])],1)],1)],1)],1)],1),e.hasReferenceMeasurements?a("b-tab",{staticClass:"app-edit-analysis-ref-measures",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"clipboard-check"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("reference-measurements")))])]},proxy:!0}],null,!1,4254738997)},[a("app-analysis-reference-measurements",{attrs:{analysis:e.analysis}})],1):e._e(),e.isSuperAdmin?a("b-tab",{staticClass:"app-edit-analysis-admin-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"braces"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("admin-panel")))])]},proxy:!0}],null,!1,3372386877)},[a("app-edit-analysis-admin",{attrs:{analysis:e.analysis}})],1):e._e()],1)],1)]):e._e()},n=[];s._withStripped=!0;var r=a(9),i=a(14),l=a(21),o=a(22),c=a(31),u=a(30),p=a(40),d=(a(71),a(25),a(190),a(34)),f=a(62),h=a(56),y=a(61),b=a(86),v=a(255),m=a(289),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-button",{attrs:{disabled:e.isDownloadButtonDisabled,loading:e.downloadButtonLoading},on:{click:e.onDownloadSelectedFilesClick}},[e._v(" "+e._s(e.$t("download-selected-files"))+" ")]),a("app-table-container",[a("b-table",{ref:"downloadFilesTable",attrs:{items:e.downloadFilesTableItems,fields:e.downloadFilesTableColumns,"select-mode":"multi",selectable:"",hover:"","head-variant":"light",busy:e.isFilesLoading},on:{"row-selected":e.onDownloadFilesSelected},scopedSlots:e._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center"},[a("b-spinner",{staticClass:"align-middle"})],1)]},proxy:!0},{key:"head(selected)",fn:function(){return[a("b-checkbox",{attrs:{checked:e.allDownloadFilesSelected},on:{change:e.onSelectAllDownloadFiles}})]},proxy:!0},{key:"cell(selected)",fn:function(e){var t=e.rowSelected;return[a("b-checkbox",{staticClass:"b-table-selectable-checkbox",attrs:{checked:t,disabled:""}})]}},{key:"cell(uploadedAt)",fn:function(t){return[e._v(" "+e._s(e.getReadableDate(t.item.uploadedAt))+" ")]}}])})],1)],1)},w=[];g._withStripped=!0;var O=a(63),_=(a(85),a(131),a(135),a(103),a(271),a(191),a(133),a(274),a(264)),S=a(281),k=a(292),A=a(266),j=a(110),x=a(296),R=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},T=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.isDownloadButtonDisabled=!0,e.downloadButtonLoading=!1,e.downloadFilesTableColumns=[{key:"selected",label:""},{key:"name",label:e.$t("name").toString()},{key:"size",label:e.$t("size").toString()},{key:"uploadedAt",label:e.$t("uploaded-at").toString()}],e.downloadFilesTableItems=[],e.allDownloadFilesSelected=!1,e.selectedDonwloadFiles=[],e.isFilesLoading=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadFiles();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onAnalysisChanged",value:function(){this.loadFiles(!0)}},{key:"onDownloadFilesSelected",value:function(e){this.selectedDonwloadFiles=e,this.isDownloadButtonDisabled=0===this.selectedDonwloadFiles.length}},{key:"onDownloadSelectedFilesClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t,a,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.downloadButtonLoading=!0,1!==this.selectedDonwloadFiles.length){e.next=9;break}return e.next=5,y["a"].getAnalysisFileDownloadUrl(this.analysis.id,this.selectedDonwloadFiles[0].name);case 5:t=e.sent,S["a"].download(t.url,this.selectedDonwloadFiles[0].name),e.next=14;break;case 9:return a="analysis-".concat(this.analysis.name,"-selected-files.zip"),e.next=12,y["a"].generateDownloadUrl(y["a"].downloadMultipleAnalysisFilesUrl(this.analysis.id,this.selectedDonwloadFiles.map((function(e){return e.name}))));case 12:s=e.sent,S["a"].download(s,a);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](0),this.showError(e.t0);case 19:return e.prev=19,this.downloadButtonLoading=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[0,16,19,22]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSelectAllDownloadFiles",value:function(e){if(e)this.downloadFilesTable.selectAllRows();else for(var t=0;t<this.downloadFilesTableItems.length;t++)this.downloadFilesTable.unselectRow(t)}},{key:"getReadableDate",value:function(e){return e&&new Date(e).toLocaleString()||""}},{key:"loadFiles",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t,a,s,n,i,l,o,c,u,p,d,f,h,b,v,m,g=arguments;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=g.length>0&&void 0!==g[0]&&g[0],this.isFilesLoading=!0,e.prev=2,a=[],this.downloadFilesTableItems=[],this.analysis.files){e.next=7;break}return e.abrupt("return");case 7:for(s=0,n=Object.keys(this.analysis.files);s<n.length;s++)i=n[s],a=a.concat(this.analysis.files[i]);return this.downloadFilesTableItems=[],e.next=11,y["a"].getAnalysisFilesInfo(this.analysis.id,a);case 11:for(l=e.sent,o=0,c=Object.keys(l);o<c.length;o++)u=c[o],p=l[u],p?this.downloadFilesTableItems.push({name:u,size:Object(k["a"])(p.size),uploadedAt:Date.parse(p.uploaded_at)}):this.downloadFilesTableItems.push({name:u,size:null,uploadedAt:null});if(this.downloadFilesTableItems.sort((function(e,t){var a=e.uploadedAt||1,s=t.uploadedAt||1;return a<s?1:a>s?-1:0})),this.analysis.current_state.state.id!==A["a"].UPLOADING){e.next=25;break}return e.next=17,y["a"].getMe();case 17:if(d=e.sent,!t){e.next=21;break}return e.next=21,Object(x["b"])(3e3);case 21:return e.next=23,y["a"].getUploadingUsers(this.analysis.id);case 23:if(f=e.sent,0===f.length)j["a"].showWarning(this.analysis.id,this.$t("state-uploading-without-uploading-user").toString());else if(f=f.filter((function(e){return e.email!=d.email})),f.length>0){h=[],b=Object(O["a"])(f);try{for(b.s();!(v=b.n()).done;)m=v.value,h.push(this.$t("user-is-uploading",{user:((m.first_name||"")+" "+(m.last_name||"")).trim()||m.email}).toString())}catch(r){b.e(r)}finally{b.f()}h.push(this.$t("files-of-files-uploaded",{current_files:Object.keys(l).filter((function(e){return!!l[e]})).length,max_files:Object.keys(l).length}).toString()),j["a"].showInfo(this.analysis.id,h.join("<br>"))}case 25:e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](2),this.showError(e.t0);case 30:return e.prev=30,this.isFilesLoading=!1,e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[2,27,30,33]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);R([Object(d["b"])({required:!0})],T.prototype,"analysis",void 0),R([Object(d["c"])()],T.prototype,"downloadFilesTable",void 0),R([Object(d["d"])("analysis")],T.prototype,"onAnalysisChanged",null),T=R([Object(d["a"])({name:"app-download-analysis-files",components:{AppTableContainer:_["a"],AppButton:v["a"]}})],T);var F=T,E=F,I=a(43),D=Object(I["a"])(E,g,w,!1,null,null,null);D.options.__file="src/app/analysis/edit-analysis/download-analysis-files.vue";var M=D.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-row",[a("b-col",{attrs:{sm:""}},[a("app-update-analysis-state",{attrs:{analysis:e.analysis}})],1),a("b-col",{attrs:{sm:""}},[a("app-import-analysis-result",{attrs:{analysis:e.analysis}})],1)],1),a("b-row",[a("b-col",{attrs:{sm:""}},[a("app-delete-analysis",{attrs:{analysis:e.analysis}})],1),a("b-col",{attrs:{sm:""}},[a("app-run-q-fly-for-analysis",{attrs:{analysis:e.analysis}})],1)],1)],1)},C=[];$._withStripped=!0;var U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{scopedSlots:e._u([{key:"title",fn:function(){return[a("h4",{staticStyle:{"margin-bottom":"1em"}},[e._v(" "+e._s(e.$t("update-analysis-state"))+" ")])]},proxy:!0}])},[e.analysis.plant.in_setup_phase?e._e():a("b-alert",{attrs:{variant:"warning",show:""}},[a("span",{domProps:{innerHTML:e._s(e.$t("attention-state-update-starts-evaulation_expl"))}})]),a("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmitUpdateState(t)}}},[a("b-form-group",[a("b-form-checkbox",{model:{value:e.sendNotification,callback:function(t){e.sendNotification=t},expression:"sendNotification"}},[e._v(" "+e._s(e.$t("send-notification"))+" ")])],1),a("b-form-group",{attrs:{label:e.$t("select-new-analysis-state")}},[a("b-form-select",{attrs:{required:"",options:e.updateStateOptions},model:{value:e.selectedUpdateState,callback:function(t){e.selectedUpdateState=t},expression:"selectedUpdateState"}})],1),a("b-form-group",{attrs:{label:e.$t("message")}},[a("b-form-textarea",{attrs:{placeholder:e.$t("message"),row:"5"},model:{value:e.selectedUpdateStateMessage,callback:function(t){e.selectedUpdateStateMessage=t},expression:"selectedUpdateStateMessage"}})],1),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("update")))])],1)],1)},L=[];U._withStripped=!0;var N=a(277),P=a(276),q=a(273),V=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},Y=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.selectedUpdateState=null,e.updateStateOptions=null,e.selectedUpdateStateMessage="",e.sendNotification=!1,e.analysisStates=null,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysisStates();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onUpdateAnalysis",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysisStates();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateAnalysisStates",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,null!==this.analysisStates){e.next=5;break}return e.next=4,y["a"].getStates();case 4:this.analysisStates=e.sent;case 5:this.setUpdateStateOptions(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSubmitUpdateState",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.loading=!0,this.selectedUpdateState){e.next=4;break}throw{error:"NO_STATE_SELECTED",message:"Please, selecte a state"};case 4:return e.next=6,y["a"].updateAnalysisState(this.analysis.id,{state_id:this.selectedUpdateState,message:this.selectedUpdateStateMessage,do_send_mail:this.sendNotification});case 6:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),this.showSuccess(this.$t("update-analysis-state-success").toString()),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.showError(e.t0);case 13:return e.prev=13,this.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setUpdateStateOptions",value:function(){var e=this;if(this.analysis.current_state){var t=this.analysisStates[this.analysis.current_state.state.id];0!==t.length?this.updateStateOptions=t.map((function(t){return{value:t,text:e.$t(A["b"][t]).toString()}})):this.updateStateOptions=[]}else this.updateStateOptions=[]}}]),a}(f["a"]);V([Object(d["b"])({required:!0})],Y.prototype,"analysis",void 0),V([Object(d["d"])("analysis")],Y.prototype,"onUpdateAnalysis",null),Y=V([Object(d["a"])({name:"app-update-analysis-state",components:{AppButton:v["a"],AppBox:q["a"]}})],Y);var z=Y,B=z,G=Object(I["a"])(B,U,L,!1,null,null,null);G.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/update-analysis-state.vue";var K,Q,H,Z=G.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{attrs:{title:e.$t("manage-result-files")}},[a("b-alert",{attrs:{variant:"info"},model:{value:e.showAlertInfo,callback:function(t){e.showAlertInfo=t},expression:"showAlertInfo"}},[e._v(" "+e._s(e.$t("import-task-running-on-qfly-server"))+" ")]),a("b-form",{on:{submit:function(t){return t.preventDefault(),e.saveManageResultFiles(t)}}},[a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.analysis.analysis_result,expression:"analysis.analysis_result"}],attrs:{label:e.$t("download-existing-result-files")}},e._l(e.importedResultFiles,(function(t){return a("a",{key:t.id,attrs:{href:"#"},on:{click:function(a){return e.onResultFileClick(t)}}},[e._v(" "+e._s(t.filename)+" ")])})),0),a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.analysis.analysis_result,expression:"analysis.analysis_result"}]},[a("b-form-checkbox",{attrs:{id:"removeAllAnalysisResultFiles"},model:{value:e.removeAllAnalysisResultFiles,callback:function(t){e.removeAllAnalysisResultFiles=t},expression:"removeAllAnalysisResultFiles"}},[e._v(" "+e._s(e.$t("remove-result-files"))+" ")])],1),a("b-form-group",{attrs:{label:e.$t("select-json-result-file-import")}},[a("b-form-file",{attrs:{accept:".json"},model:{value:e.jsonFile,callback:function(t){e.jsonFile=t},expression:"jsonFile"}})],1),a("b-form-group",{attrs:{label:e.$t("select-result-image-files-zip")}},[a("b-form-file",{attrs:{accept:".zip"},model:{value:e.imageFilesZip,callback:function(t){e.imageFilesZip=t},expression:"imageFilesZip"}}),e.uploadProgress?a("div",{staticClass:"mar-top"},[e._v(" "+e._s(e.$t("uploading"))+" "),a("b-progress",{attrs:{max:e.uploadProgress.total}},[a("b-progress-bar",{attrs:{value:e.uploadProgress.loaded,variant:"success"}},[e.uploadProgress.loaded===e.uploadProgress.total?a("span",[e._v(" "+e._s(e.$t("upload-succes-filename",{filename:e.imageFilesZip.name}))+" ")]):e._e(),e.uploadProgress.loaded<e.uploadProgress.total?a("span",[e._v(" "+e._s(Math.round(e.uploadProgress.loaded/e.uploadProgress.total*100))+"% ")]):e._e()])],1)],1):e._e()],1),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("apply")))])],1)],1)},J=[];W._withStripped=!0,function(e){e["import_analysis_results"]="import_analysis_results",e["validate_plant_metadata"]="validate_plant_metadata",e["run_qfly_wizard"]="run_qfly_wizard"}(K||(K={})),function(e){e["UNALLOCATED"]="UNALLOCATED",e["STOPPED"]="STOPPED",e["RUNNING"]="RUNNING"}(Q||(Q={})),function(e){e["ALLOCATE_AND_START"]="ALLOCATE_AND_START",e["START"]="START",e["RELEASE"]="RELEASE",e["STOP"]="STOP",e["STOP_AND_RELEASE"]="STOP_AND_RELEASE"}(H||(H={}));var X=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},ee=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.importedResultFiles=[],e.removeAllAnalysisResultFiles=!1,e.jsonFile=null,e.imageFilesZip=null,e.uploadProgress=null,e.showAlertInfo=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.setManageImportFiles();case 2:N["a"].on(this.analysis.id,P["a"].RUN_ANALYSIS_TASK,(function(e){e.name===K.import_analysis_results&&(t.loading=!0)})),N["a"].on(this.analysis.id,P["a"].FINISHED_ANALYSIS_TASK,(function(e){e.name===K.import_analysis_results&&(t.loading=!1,"SUCCESSFUL"===e.state&&t.successfullyFinished())})),N["a"].on(this.analysis.id,P["a"].QFLY_SERVER_STATE_CHANGED,(function(e){t.showAlertInfo=e===Q.RUNNING}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onUpdateAnalysis",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.setManageImportFiles();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onResultFileClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].getAnalysisResultFileUrl(t.id);case 3:a=e.sent,S["a"].download(a.url,t.filename),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setManageImportFiles",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.analysis.analysis_result){e.next=4;break}return e.next=3,y["a"].getAnalysisResultFiles(this.analysis.analysis_result.id);case 3:this.importedResultFiles=e.sent;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveManageResultFiles",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t,a=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.loading=!0,!this.analysis.analysis_result||!this.removeAllAnalysisResultFiles){e.next=5;break}return e.next=5,y["a"].deleteAnalysisResult(this.analysis.analysis_result.id);case 5:if(!this.jsonFile){e.next=15;break}return j["a"].showInfo(this.analysis.id,"Uploading result file..."),e.next=9,y["a"].importAnalysisResult(this.jsonFile,this.analysis.id,null===(t=this.imageFilesZip)||void 0===t?void 0:t.name);case 9:if(N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),!this.imageFilesZip){e.next=13;break}return e.next=13,y["a"].uploadImportAnalysisResultImageFiles(this.analysis.id,this.imageFilesZip,(function(e){a.uploadProgress={total:e.total,loaded:e.loaded}}));case 13:e.next=16;break;case 15:this.successfullyFinished();case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](0),this.showError(e.t0),this.loading=!1;case 22:return e.prev=22,this.uploadProgress=null,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[0,18,22,25]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"successfullyFinished",value:function(){this.showSuccess(this.$t("success-managing-result-files").toString()),this.loading=!1,N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS)}}]),a}(f["a"]);X([Object(d["b"])({required:!0})],ee.prototype,"analysis",void 0),X([Object(d["d"])("analysis")],ee.prototype,"onUpdateAnalysis",null),ee=X([Object(d["a"])({name:"app-import-analysis-result",components:{AppButton:v["a"],AppBox:q["a"]}})],ee);var te=ee,ae=te,se=Object(I["a"])(ae,W,J,!1,null,null,null);se.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/import-analysis-result.vue";var ne=se.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{attrs:{title:e.$t("danger-zone")}},[a("app-button",{attrs:{type:"button",variant:"danger",loading:e.finishTaskLoading,disabled:!e.analysis.task_id},on:{click:e.onFinishTaskClick}},[e._v(" "+e._s(e.$t("finish-running-task"))+" ")]),a("hr"),a("app-button",{attrs:{type:"button",variant:"danger",loading:e.loading},on:{click:e.onDeleteAnalysisClick}},[e._v(" "+e._s(e.$t("delete"))+" ")])],1)},ie=[];re._withStripped=!0;var le=a(109),oe=a(295),ce=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},ue=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.finishTaskLoading=!1,e}return Object(o["a"])(a,[{key:"onDeleteAnalysisClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!confirm("Delete analysis and all according files? This cannot be undone.")){e.next=7;break}return this.loading=!0,le["a"].removeItem(oe["a"]+"-"+this.analysis.id),e.next=6,y["a"].deleteAnalysis(this.analysis.id);case 6:this.$router.push({name:"Analyses"});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.showError(e.t0);case 12:return e.prev=12,this.loading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[0,9,12,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFinishTaskClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.finishTaskLoading=!0,e.prev=1,e.next=4,y["a"].finishRunningTask(this.analysis.id);case 4:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),this.showSuccess(this.$t("successfully-finished-running-task").toString()),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),this.showError(e.t0);case 11:return e.prev=11,this.finishTaskLoading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);ce([Object(d["b"])({required:!0})],ue.prototype,"analysis",void 0),ue=ce([Object(d["a"])({name:"app-delete-analysis",components:{AppButton:v["a"],AppBox:q["a"]}})],ue);var pe=ue,de=pe,fe=Object(I["a"])(de,re,ie,!1,null,null,null);fe.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/delete-analysis.vue";var he=fe.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{scopedSlots:e._u([{key:"title",fn:function(){return[a("h4",{staticClass:"box-title"},[e._v(" "+e._s(e.$t("run-qfly-server"))),a("br"),a("small",{staticClass:"grayed",domProps:{innerHTML:e._s(e.serverInfo)}})])]},proxy:!0}])},[e.qFlyServer?a("b-form",{on:{submit:function(t){return t.preventDefault(),e.runServerAction(t)}}},[e.serverStateUnallocated?e._e():a("b-form-group",{attrs:{label:e.$t("server-tags")}},e._l(e.qFlyServer.server.tags,(function(t){return a("b-row",{key:t.Key,staticClass:"mar-bottom"},[a("b-col",[a("b-form-input",{on:{change:e.onTagChanged},model:{value:t.Key,callback:function(a){e.$set(t,"Key",a)},expression:"tag.Key"}})],1),a("b-col",[a("b-form-input",{on:{change:e.onTagChanged},model:{value:t.Value,callback:function(a){e.$set(t,"Value",a)},expression:"tag.Value"}})],1)],1)})),1),a("b-form-group",{attrs:{label:e.$t("run-server-action")}},[a("b-form-select",{attrs:{options:e.qFlyServerActionSelection},model:{value:e.selectedServerAction,callback:function(t){e.selectedServerAction=t},expression:"selectedServerAction"}})],1),a("b-form-group",{attrs:{label:e.$t("run-task")}},[a("b-form-select",{attrs:{options:e.runTaskSelection,disabled:e.taskSelectionDisabled},model:{value:e.selectedTask,callback:function(t){e.selectedTask=t},expression:"selectedTask"}})],1),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("apply")))])],1):e._e()],1)},be=[];ye._withStripped=!0;var ve=a(72),me=(a(192),a(193),function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i}),ge=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.qFlyServer=null,e.qFlyServerActionSelection=[],e.runTaskSelection=[],e.tagsChanged=!1,e.selectedServerAction=null,e.selectedTask=null,e.taskSelectionDisabled=!1,e.loading=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateQFlyServer();case 2:N["a"].on(this.analysis.id,P["a"].RUN_ANALYSIS_TASK,(function(e){t.taskSelectionDisabled=!0})),N["a"].on(this.analysis.id,P["a"].FINISHED_ANALYSIS_TASK,(function(e){t.taskSelectionDisabled=!1,"SUCCESSFUL"===e.state&&(e.name===K.validate_plant_metadata?t.showSuccess(t.$t("uploaded-data-complete-success").toString()):e.name===K.run_qfly_wizard&&t.showSuccess(t.$t("evaluation-finished-success").toString()))}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"serverInfo",get:function(){var e;return this.qFlyServer?this.$t("SERVER_STATE_".concat(this.qFlyServer.state),{server:null===(e=this.qFlyServer.server)||void 0===e?void 0:e.name}).toString()+(this.serverStateUnallocated&&"<br>"+this.$t("servers-available",{count:this.qFlyServer.servers_available}).toString()||""):""}},{key:"updateQFlyServer",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t,a=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].getQFlyServer(this.analysis.id);case 3:t=e.sent,this.qFlyServer&&this.qFlyServer.state===t.state||N["a"].emit(this.analysis.id,P["a"].QFLY_SERVER_STATE_CHANGED,t.state),this.qFlyServer=t,this.qFlyServerActionSelection=[{value:null,text:""}].concat(Object(ve["a"])(this.qFlyServer.actions.map((function(e){return{value:e,text:a.$t("SERVER_ACTION_".concat(e)).toString()}})))),this.runTaskSelection=[{value:null,text:""}],this.analysis.current_state.state.id===A["a"].DATA_COMPLETE&&this.runTaskSelection.push({text:this.$t("validate-file-completenes").toString(),value:K.validate_plant_metadata}),[A["a"].DATA_COMPLETE_VERIFIED,A["a"].PROCESSING].includes(this.analysis.current_state.state.id)&&this.runTaskSelection.push({text:this.$t("run-qfly-wizard").toString(),value:K.run_qfly_wizard}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),this.showError(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"serverStateUnallocated",get:function(){return this.qFlyServer.state==Q.UNALLOCATED}},{key:"onTagChanged",value:function(){this.tagsChanged=!0}},{key:"serverStateStopped",get:function(){return this.qFlyServer.state==Q.STOPPED}},{key:"serverStateRunning",get:function(){return this.qFlyServer.state==Q.RUNNING}},{key:"validateFilesDisabled",get:function(){return this.analysis.current_state.state.id!==A["a"].DATA_COMPLETE}},{key:"runQFlyWizardDisabled",get:function(){return![A["a"].DATA_COMPLETE_VERIFIED,A["a"].PROCESSING].includes(this.analysis.current_state.state.id)}},{key:"runServerAction",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,e.prev=1,console.log("this.selectedTask"),console.log(this.selectedTask),console.log(K[this.selectedTask]),!confirm("Are you sure?")){e.next=11;break}return e.next=8,y["a"].runQFlyServerAction(this.analysis.id,{action:this.selectedServerAction&&H[this.selectedServerAction]||void 0,start_task:this.selectedTask&&K[this.selectedTask]||void 0,tags:this.tagsChanged?null===(t=this.qFlyServer.server)||void 0===t?void 0:t.tags:void 0});case 8:return e.next=10,this.updateQFlyServer();case 10:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),this.showError(e.t0);case 16:return e.prev=16,this.loading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);me([Object(d["b"])({required:!0})],ge.prototype,"analysis",void 0),ge=me([Object(d["a"])({name:"app-run-qfly-for-analysis",components:{AppButton:v["a"],AppBox:q["a"]}})],ge);var we=ge,Oe=we,_e=Object(I["a"])(Oe,ye,be,!1,null,null,null);_e.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/run-qfly-for-analysis.vue";var Se=_e.exports,ke=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},Ae=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){return Object(l["a"])(this,a),t.apply(this,arguments)}return Object(o["a"])(a)}(f["a"]);ke([Object(d["b"])({required:!0})],Ae.prototype,"analysis",void 0),Ae=ke([Object(d["a"])({name:"app-edit-analysis-result-admin",components:{AppUpdateAnalysisState:Z,AppImportAnalysisResult:ne,AppDeleteAnalysis:he,AppRunQFlyForAnalysis:Se}})],Ae);var je=Ae,xe=je,Re=Object(I["a"])(xe,$,C,!1,null,null,null);Re.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/edit-analysis-admin.vue";var Te=Re.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-analysis-upload",{attrs:{analysis:e.analysis},on:{startUpload:e.onStartUpload,cancelUpload:e.onCancelUpload,retryUpload:e.onRetryUpload}})],1)},Ee=[];Fe._withStripped=!0;var Ie=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},De=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){return Object(l["a"])(this,a),t.apply(this,arguments)}return Object(o["a"])(a,[{key:"onStartUpload",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t,a,s){var n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!(this.analysis.current_state.state.id>=A["a"].DATA_COMPLETE)){e.next=3;break}throw{error:"INVALID_STATE_FOR_UPLOAD",message:"State DATA_INCOMPLETE (or less) required to upload further files."};case 3:return n=a?[]:t,e.next=6,y["a"].prepareAnalysisUpload(this.analysis.id,n);case 6:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),s(this.analysis),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),this.showError(e.t0),s(void 0);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t,a,s){return e.apply(this,arguments)}return t}()},{key:"onCancelUpload",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].cancelAnalysisUpload(this.analysis.id);case 3:return e.next=5,y["a"].updateAnalysisState(this.analysis.id,{state_id:A["a"].UPLOAD_FAILED,message:"Upload canceled"});case 5:t(!1),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0),t(!0);case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRetryUpload",value:function(){this.$router.go(0)}}]),a}(f["a"]);Ie([Object(d["b"])({required:!0})],De.prototype,"analysis",void 0),De=Ie([Object(d["a"])({name:"app-upload-analysis-files",components:{AppAnalysisUpload:m["a"]}})],De);var Me=De,$e=Me,Ce=Object(I["a"])($e,Fe,Ee,!1,null,null,null);Ce.options.__file="src/app/analysis/edit-analysis/upload-analysis-files.vue";var Ue=Ce.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-table-container",[a("b-table",{attrs:{items:e.refMeasureItems,fields:e.refMeasureColumns,"select-mode":"single",selectable:"",hover:"","head-variant":"light",busy:e.loading},on:{"row-selected":e.onRefMeasureSelected},scopedSlots:e._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center"},[a("b-spinner",{staticClass:"align-middle"})],1)]},proxy:!0},{key:"cell(actions)",fn:function(t){return[a("div",{staticClass:"hover-cell pull-right"},[a("b-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("move-to-another-analysis")},on:{click:function(a){return e.onMoveClick(t.item)}}},[a("b-icon",{attrs:{icon:"arrow-right-circle-fill"}})],1),a("b-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"outline-danger",size:"sm",title:e.$t("delete")},on:{click:function(a){return e.onDeleteClick(t.item)}}},[a("b-icon",{attrs:{icon:"trash"}})],1)],1)]}}])})],1),a("app-reference-measurement-values",{attrs:{refMeasureId:e.selectedRefMeasureId}}),a("app-modal-form",{ref:"moveModal",attrs:{id:"move-modal",title:e.$t("move-to-another-analysis"),"ok-title":e.$t("move"),modalLoading:e.moveModalLoading},on:{submit:e.onMove}},[a("b-form-group",{attrs:{label:e.$t("select-analysis")}},[a("b-form-select",{attrs:{options:e.moveToAnalyses,required:""},model:{value:e.moveTargetAnalysisId,callback:function(t){e.moveTargetAnalysisId=t},expression:"moveTargetAnalysisId"}})],1)],1)],1)},Ne=[];Le._withStripped=!0;var Pe=a(265),qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.refMeasureId,expression:"refMeasureId"}]},[a("app-table-container",[a("b-table",{attrs:{items:e.refMeasureValueItems,fields:e.refMeasureValueColumns,hover:"","head-variant":"light",busy:e.loading},scopedSlots:e._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center"},[a("b-spinner",{staticClass:"align-middle"})],1)]},proxy:!0},{key:"cell(actions)",fn:function(t){return[a("div",{staticClass:"hover-cell pull-right"},[a("b-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:t.item.ignored?e.$t("ignore-value-undo"):e.$t("ignore-value")},on:{click:function(a){return e.onIgnoreClick(t.item)}}},[t.item.ignored?a("b-icon",{attrs:{icon:"plus-circle"}}):e._e(),t.item.ignored?e._e():a("b-icon",{attrs:{icon:"dash-circle"}})],1)],1)]}}])})],1)],1)},Ve=[];qe._withStripped=!0;var Ye=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},ze=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.refMeasureValueItems=[],e.refMeasureValueColumns=[{key:"pcs",label:e.$t("pcs").toString()},{key:"absorberTemperature",label:e.$t("glass-tube-temperature").toString()},{key:"brokenGlass",label:e.$t("missing-gct").toString()},{key:"notes",label:e.$t("notes").toString()},{key:"ignored",label:e.$t("ignored").toString()},{key:"actions",label:""}],e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateRefMeasurementValues();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onRefMeasureChanged",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateRefMeasurementValues();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onIgnoreClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].ignoreReferenceMeasurementValue(t.id,!t.ignored);case 3:return this.showSuccess(this.$t("reference-measurement-value-change-success").toString()),e.next=6,this.updateRefMeasurementValues();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateRefMeasurementValues",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.loading=!0,this.refMeasureId){e.next=5;break}return this.refMeasureValueItems=[],e.abrupt("return");case 5:return e.next=7,y["a"].getReferencMeasurementValues(this.refMeasureId);case 7:this.refMeasureValueItems=e.sent.map((function(e){return{id:e.id,pcs:e.fieldgeometry_component.kks,absorberTemperature:e.hce_temperature,brokenGlass:e.hce_broken_glass,notes:e.notes,ignored:e.ignore}})).sort((function(e,t){var a=e.pcs.toLowerCase(),s=t.pcs.toLowerCase();return a<s?-1:a>s?1:0})),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.showError(e.t0);case 13:return e.prev=13,this.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);Ye([Object(d["b"])({default:null})],ze.prototype,"refMeasureId",void 0),Ye([Object(d["d"])("refMeasureId")],ze.prototype,"onRefMeasureChanged",null),ze=Ye([Object(d["a"])({name:"app-reference-measurement-values",components:{AppTableContainer:_["a"]}})],ze);var Be=ze,Ge=Be,Ke=Object(I["a"])(Ge,qe,Ve,!1,null,null,null);Ke.options.__file="src/app/analysis/edit-analysis/reference-measurement/reference-measurement-values.vue";var Qe=Ke.exports,He=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},Ze=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.refMeasureItems=[],e.refMeasureColumns=[{key:"measureDate",label:e.$t("measure-date").toString()},{key:"measureNotes",label:e.$t("notes").toString()},{key:"user",label:e.$t("acquired-by").toString()},{key:"actions",label:""}],e.selectedRefMeasureId=null,e.moveRefMeasureId=null,e.moveTargetAnalysisId=null,e.moveToAnalyses=[],e.moveModalLoading=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.updateRefMeasurements();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onMoveClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){var a=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,this.moveRefMeasureId=t.id,e.next=5,y["a"].getAllAnalysis({plant_id:this.analysis.plant.id});case 5:this.moveToAnalyses=e.sent.filter((function(e){return e.id!==a.analysis.id})).map((function(e){return{value:e.id,text:e.name}})),this.moveTargetAnalysisId=null,this.moveModal.show(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.showError(e.t0);case 13:return e.prev=13,this.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onMove",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.moveModalLoading=!0,this.moveTargetAnalysisId){e.next=4;break}throw{error:"MISSING_TARGET_ANALYSIS",message:"Please select an analysis"};case 4:return e.next=6,y["a"].moveReferenceMeasurement(this.moveRefMeasureId,this.moveTargetAnalysisId);case 6:return this.showSuccess(this.$t("reference-measurement-moved-success").toString()),e.next=9,this.updateRefMeasurements();case 9:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),this.moveModal.hide(),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),this.showError(e.t0);case 16:return e.prev=16,this.moveModalLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[0,13,16,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeleteClick",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,confirm(this.$t("reference-measurement-delete-are-you-sure").toString())){e.next=3;break}return e.abrupt("return");case 3:return this.loading=!0,e.next=6,y["a"].deleteRerefenceMeasurement(t.id);case 6:return this.showSuccess(this.$t("reference-measurement-delete-success").toString()),e.next=9,this.updateRefMeasurements();case 9:N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),this.showError(e.t0);case 15:return e.prev=15,this.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[0,12,15,18]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRefMeasureSelected",value:function(e){e.length>0?this.selectedRefMeasureId=e[0].id:this.selectedRefMeasureId=null}},{key:"updateRefMeasurements",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,y["a"].getReferenceMeasurements(this.analysis.id);case 4:this.refMeasureItems=e.sent.map((function(e){return{id:e.id,measureDate:new Date(Date.parse(e.measure_date)).toLocaleDateString(),measureNotes:e.notes,user:(e.user.first_name+" "+e.user.last_name).trim()||e.user.email}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[0,7,10,13]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);He([Object(d["b"])({required:!0})],Ze.prototype,"analysis",void 0),He([Object(d["c"])()],Ze.prototype,"moveModal",void 0),Ze=He([Object(d["a"])({name:"app-analysis-reference-measurements",components:{AppTableContainer:_["a"],AppModalForm:Pe["a"],AppReferenceMeasurementValues:Qe}})],Ze);var We=Ze,Je=We,Xe=Object(I["a"])(Je,Le,Ne,!1,null,null,null);Xe.options.__file="src/app/analysis/edit-analysis/reference-measurement/analysis-reference-measurements.vue";var et=Xe.exports,tt=function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},at=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.analysis=null,e.flownAt="",e.loading=!1,e.hasReferenceMeasurements=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysis(this.$route.params.id);case 2:N["a"].on(this.analysis.id,P["a"].UPDATE_ANALYSIS,(function(){t.updateAnalysis(t.analysis.id)}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"uploadAllowed",get:function(){return this.analysis&&this.analysis.current_state.state.id<A["a"].DATA_COMPLETE_VERIFIED||!1}},{key:"updateAnalysis",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y["a"].getAnalysis(t);case 3:return this.analysis=e.sent,this.flownAt=this.analysis.flown_at,e.next=7,y["a"].getReferenceMeasurements(this.analysis.id);case 7:e.t0=e.sent.length,this.hasReferenceMeasurements=e.t0>0,this.watchAnalysisTask(),e.next=15;break;case 12:e.prev=12,e.t1=e["catch"](0),this.showError(e.t1);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"watchAnalysisTask",value:function(){var e=this;this.analysis.task_id&&y["a"].waitForTask(this.analysis.task_id,(function(t,a){a?j["a"].showError(e.analysis.id,{error:h["a"].SOMETHING_WENT_WRONG,message:"<b>".concat(t.output.error,"</b><br><br>")+y["a"].getTaskOutputAsMessage(t)}):j["a"].showSuccess(e.analysis.id,y["a"].getTaskOutputAsMessage(t)),N["a"].emit(e.analysis.id,P["a"].FINISHED_ANALYSIS_TASK,t)}),(function(t){j["a"].showInfo(e.analysis.id,y["a"].getTaskOutputAsMessage(t,e.$t("wait-for-start").toString())),N["a"].emit(e.analysis.id,P["a"].RUN_ANALYSIS_TASK,t)}))}},{key:"onSubmitEditAnalysis",value:function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,y["a"].updateAnalysis(this.analysis.id,{flown_at:this.flownAt});case 4:this.showSuccess(this.$t("analysis-updated-successfully").toString()),N["a"].emit(this.analysis.id,P["a"].UPDATE_ANALYSIS),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:return e.prev=11,this.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);at=tt([Object(d["a"])({name:"app-edit-analysis",components:{AppContent:b["a"],AppButton:v["a"],AppAnalysisUpload:m["a"],AppDownloadAnalysisFiles:M,AppEditAnalysisAdmin:Te,AppUploadAnalysisFiles:Ue,AppBox:q["a"],AppAnalysisReferenceMeasurements:et}})],at);var st=at,nt=st,rt=(a(345),Object(I["a"])(nt,s,n,!1,null,null,null));rt.options.__file="src/app/analysis/edit-analysis/edit-analysis.vue";t["default"]=rt.exports}}]);