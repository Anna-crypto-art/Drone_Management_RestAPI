(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{290:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"app-explanation"},[n("span",{ref:"appExplTarget",staticClass:"app-explanation-container"},[n("b-icon",{attrs:{icon:"question-circle-fill"}})],1),n("b-popover",{attrs:{target:function(){return e.$refs.appExplTarget},triggers:"hover",placement:"top"}},[e._t("default")],2)],1)},s=[];a._withStripped=!0;var r=n(20),l=n(19),i=n(25),c=n(24),o=n(27),p=(n(46),n(22),n(17)),u=n(16),d=function(e,t,n,a){var s,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(o["a"])(Reflect))&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(l=(r<3?s(l):r>3?s(t,n,l):s(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},h=function(e){Object(i["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(l["a"])(this,n),t.apply(this,arguments)}return Object(r["a"])(n)}(p["default"]);h=d([Object(u["a"])({name:"app-explanation"})],h);var f=h,b=f,g=(n(340),n(32)),v=Object(g["a"])(b,a,s,!1,null,null,null);v.options.__file="src/app/shared/components/app-explanation/app-explanation.vue";t["a"]=v.exports},314:function(e,t,n){},340:function(e,t,n){"use strict";n(314)},514:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-content",{attrs:{title:e.$t("new-data-upload"),navback:!0,subtitle:e.plantName,eventId:"newAnalysis"}},[n("div",{staticClass:"app-new-analysis mar-bottom-2x"},[n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.plantOptions.length>1,expression:"plantOptions.length > 1"}],attrs:{"label-cols-lg":"2",label:e.$t("plant")}},[n("b-form-select",{attrs:{required:"",options:e.plantOptions},model:{value:e.selectedPlantId,callback:function(t){e.selectedPlantId=t},expression:"selectedPlantId"}})],1),n("b-form-group",{attrs:{"label-cols-lg":"2",label:e.$t("acquisition-date")}},[n("app-datepicker",{attrs:{required:""},model:{value:e.flownAt,callback:function(t){e.flownAt=t},expression:"flownAt"}})],1),n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.productPackagesSelection.length>0,expression:"productPackagesSelection.length > 0"}],attrs:{"label-cols-lg":"2",label:e.$t("product-packages")}},[n("app-multiselect",{attrs:{options:e.productPackagesSelection},model:{value:e.selectedProductPackages,callback:function(t){e.selectedProductPackages=t},expression:"selectedProductPackages"}})],1),n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.droneOptions.length>0,expression:"droneOptions.length > 0"}],attrs:{"label-cols-lg":"2",label:e.$t("drone")}},[n("b-form-select",{attrs:{options:e.droneOptions},model:{value:e.selectedDroneId,callback:function(t){e.selectedDroneId=t},expression:"selectedDroneId"}})],1)],1),n("app-analysis-uploader",{attrs:{plantId:e.selectedPlantId,analysis:e.analysis,flownAt:e.flownAt,orderProductPackageIds:e.selectedProductPackages},scopedSlots:e._u([{key:"addActions",fn:function(){return[n("app-button",{attrs:{variant:"secondary",loading:e.loadingEmptyAnalysis},on:{click:e.onCreateEmptyAnalysisClick}},[e._v(" "+e._s(e.$t("create-empty-analysis"))+" ")])]},proxy:!0}])})],1)},s=[];a._withStripped=!0;var r=n(6),l=n(10),i=n(19),c=n(20),o=n(25),p=n(24),u=n(27),d=(n(46),n(22),n(43),n(51),n(147),n(75),n(94),n(146),n(96),n(16)),h=n(42),f=n(98),b=n(47),g=n(74),v=n(401),y=n(309),w=n(313),P=n(294),O=n(278),m=function(e,t,n,a){var s,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(u["a"])(Reflect))&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(l=(r<3?s(l):r>3?s(t,n,l):s(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},k=function(e){Object(o["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(i["a"])(this,n),e=t.apply(this,arguments),e.selectedPlantId=null,e.plantOptions=[],e.flownAt=null,e.analysis=null,e.productPackagesSelection=[],e.selectedProductPackages=null,e.selectedDroneId=null,e.droneOptions=[],e.loadingEmptyAnalysis=!1,e}return Object(c["a"])(n,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.preparePlantSelection();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSelectedPlantIdChanged",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadProductPackagesSelection();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFlownAtChanged",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:Promise.all([this.loadProductPackagesSelection(),this.prepareDroneSelection()]);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"plantName",get:function(){var e=this;if(this.selectedPlantId,this.plants){var t=this.plants.find((function(t){return t.id===e.selectedPlantId}));if(t)return t.name}return"&nbsp;"}},{key:"onCreateEmptyAnalysisClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.flownAt){e.next=2;break}throw{error:"INVALID_OR_MISSING_PARAMS",message:this.$t("missing").toString()+" "+this.$t("acquisition-date").toString()};case 2:if(this.selectedPlantId){e.next=4;break}throw{error:"INVALID_OR_MISSING_PARAMS",message:this.$t("missing").toString()+" "+this.$t("plant").toString()};case 4:return e.next=6,b["a"].createEmptyAnalysis({flown_at:this.flownAt,plant_id:this.selectedPlantId,order_product_package_ids:this.selectedProductPackages||void 0,drone_id:this.selectedDroneId||void 0});case 6:return t=e.sent,this.showSuccess(this.$t("analysis-created-success").toString()),e.next=10,this.$nextTick();case 10:this.$router.push({name:"EditAnalysis",params:{id:t.id}});case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"preparePlantSelection",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getPlants();case 2:return this.plants=e.sent,t=this.$route.query.plantId,t&&!Array.isArray(t)?this.plants=this.plants.filter((function(e){return e.id===t})):t=void 0,e.next=7,b["a"].getAllAnalysis({plant_id:t});case 7:if(n=e.sent,this.plants=this.plants.filter((function(e){return!n.find((function(t){return t.plant.id===e.id&&t.current_state&&t.current_state.state.id<=P["a"].DATA_INCOMPLETE}))})),0!==this.plants.length){e.next=12;break}return this.$router.push({name:"Analyses"}),e.abrupt("return");case 12:this.plantOptions=this.plants.map((function(e){return{value:e.id,text:e.name}})),1===this.plants.length&&(this.selectedPlantId=this.plants[0].id);case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"prepareDroneSelection",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={},this.selectedPlantId&&(t.plant_id=this.selectedPlantId),e.next=4,b["a"].getDrones(t);case 4:this.drones=e.sent,this.droneOptions=this.drones.map((function(e){return{value:e.id,text:e.custom_name+" ("+e.drone_model.name_abbrev+")"}})),1===this.drones.length&&(this.selectedDroneId=this.drones[0].id);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadProductPackagesSelection",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.productPackagesSelection=[],this.selectedPlantId&&this.flownAt){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,b["a"].getOrderPPsMulitselectOptions(this.selectedPlantId,this.flownAt);case 5:return this.productPackagesSelection=e.sent,e.next=8,b["a"].getNewAnalysisProductPackagesProposal(this.selectedPlantId,this.flownAt);case 8:this.selectedProductPackages=e.sent.map((function(e){return e.id}));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(h["a"]);m([Object(O["a"])()],k.prototype,"created",null),m([Object(d["d"])("selectedPlantId")],k.prototype,"onSelectedPlantIdChanged",null),m([Object(d["d"])("flownAt")],k.prototype,"onFlownAtChanged",null),m([Object(O["a"])("loadingEmptyAnalysis")],k.prototype,"onCreateEmptyAnalysisClick",null),m([Object(O["a"])()],k.prototype,"prepareDroneSelection",null),m([Object(O["a"])()],k.prototype,"loadProductPackagesSelection",null),k=m([Object(d["a"])({name:"app-new-analysis",components:{AppContent:f["a"],AppButton:g["a"],AppAnalysisUploader:v["a"],AppMultiselect:y["a"],AppDatepicker:w["a"]}})],k);var j=k,A=j,x=n(32),I=Object(x["a"])(A,a,s,!1,null,null,null);I.options.__file="src/app/analysis/new-analysis/new-analysis.vue";t["default"]=I.exports}}]);