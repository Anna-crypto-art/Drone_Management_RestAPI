(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{293:function(e,t,n){},302:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),i=n(20),l=function(){function e(){Object(a["a"])(this,e)}return Object(i["a"])(e,null,[{key:"download",value:function(e,t){var n=document.createElement("a");n.href=e,n.setAttribute("download",t||e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"open",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";null===(t=window.open(e,n))||void 0===t||t.focus()}}]),e}()},305:function(e,t,n){"use strict";n(293)},307:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(284);function a(e,t){return e.sort((function(e,n){var a=e[t].toLowerCase(),i=n[t].toLowerCase();return a<i?-1:a>i?1:0}))}},311:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"app-modal-form-info-area "+e.cls},[e._t("default")],2)},i=[];a._withStripped=!0;var l=n(20),r=n(19),o=n(23),s=n(22),c=n(27),u=(n(46),n(21),n(17)),d=n(16),p=function(e,t,n,a){var i,l=arguments.length,r=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,n,r):i(t,n))||r);return l>3&&r&&Object.defineProperty(t,n,r),r},m=function(e){Object(o["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(r["a"])(this,n),t.apply(this,arguments)}return Object(l["a"])(n)}(u["default"]);p([Object(d["b"])({default:""})],m.prototype,"cls",void 0),m=p([Object(d["a"])({name:"app-modal-form-info-area"})],m);var f=m,h=f,b=(n(305),n(32)),g=Object(b["a"])(h,a,i,!1,null,null,null);g.options.__file="src/app/shared/components/app-modal/app-modal-form-info-area.vue";t["a"]=g.exports},483:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-content",{attrs:{title:e.$t("plants-overview"),subtitle:e.$t("plants-overview_descr")}},[e.isSuperAdmin?n("div",{staticClass:"plant-tools"},[n("app-button",{attrs:{variant:"secondary",superAdminProtected:!0},on:{click:function(t){return e.onCreatePlantClick()}}},[e._v(e._s(e.$t("create-plant")))])],1):e._e(),n("app-table-container",[n("app-table",{attrs:{columns:e.columns,rows:e.plants,loading:e.tableLoading,hoverActions:!0},scopedSlots:e._u([{key:"cell(name)",fn:function(t){return[n("router-link",{directives:[{name:"show",rawName:"v-show",value:t.item.digitized,expression:"row.item.digitized"}],attrs:{to:{name:"Plant",params:{id:t.item.id}}}},[n("span",{attrs:{translate:"no"}},[e._v(e._s(t.item.name))])]),t.item.digitized?e._e():n("span",[e._v(e._s(t.item.name))]),n("div",[n("small",{staticClass:"grayed"},[e._v(" "+e._s(t.item.analysesCount)+" "+e._s(e.$t("analysis"))+" ")])])]}},{key:"cell(productPackages)",fn:function(e){return[n("app-order-pps-view",{attrs:{orderProductPackages:e.item.productPackages}})]}},{key:"cell(digitized)",fn:function(e){return[n("app-icon",{attrs:{cls:e.item.digitized?"green":"red",icon:e.item.digitized?"check2":"x"}})]}},{key:"cell(established)",fn:function(e){return[n("app-icon",{attrs:{cls:e.item.established?"green":"red",icon:e.item.established?"check2":"x"}})]}},{key:"hoverActions",fn:function(t){return[n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("upload-dt"),icon:"hammer",superAdminProtected:!0},on:{click:function(n){return e.onManagePlantClick(t.item)}}}),n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("edit-plant"),icon:"wrench",superAdminProtected:!0},on:{click:function(n){return e.onEditPlantClick(t.item)}}}),n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"outline-danger",size:"sm",title:e.$t("delete-plant"),icon:"trash",superAdminProtected:!0},on:{click:function(n){return e.onDeletePlantClick(t.item)}}})]}}])})],1),n("app-modal-form",{ref:"managePlantModal",attrs:{id:"manage-plant-modal",title:e.$t("upload-dt"),subtitle:e.managePlantModel.plant&&e.managePlantModel.plant.name||"","ok-title":e.$t("apply"),modalLoading:e.plantModalLoading,superAdminProtected:!0},on:{submit:e.saveManagePlant}},[e.managePlantModel.plant?n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.managePlantModel.plant.fieldgeometry,expression:"managePlantModel.plant.fieldgeometry"}]},[n("a",{attrs:{href:"#"},on:{click:function(t){return e.onFileClick(e.managePlantModel.plant.fieldgeometry)}}},[e._v(" "+e._s(e.managePlantModel.plant.fieldgeometry&&e.managePlantModel.plant.fieldgeometry.file_name)+" ")])]):e._e(),n("b-form-group",[n("b-form-checkbox",{attrs:{id:"clear-before-checkbox"},model:{value:e.managePlantModel.clearBefore,callback:function(t){e.$set(e.managePlantModel,"clearBefore",t)},expression:"managePlantModel.clearBefore"}},[e._v(" "+e._s(e.$t("clear-before"))+" ")])],1),n("b-form-group",{attrs:{label:e.$t("select-dt-json-file")}},[n("b-form-file",{attrs:{required:"",accept:".json"},model:{value:e.managePlantModel.file,callback:function(t){e.$set(e.managePlantModel,"file",t)},expression:"managePlantModel.file"}})],1)],1),n("app-modal-form",{ref:"appCreatePlantModal",attrs:{id:"create-plant-modal",title:e.$t("create-plant"),okTitle:e.$t("create"),modalLoading:e.createPlantLoading,superAdminProtected:!0},on:{submit:e.onSubmitCreatePlant}},[n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:e.$t("name")}},[n("b-form-input",{attrs:{id:"new-plant-name",required:"",placeholder:e.$t("name")},model:{value:e.newPlant.name,callback:function(t){e.$set(e.newPlant,"name",t)},expression:"newPlant.name"}})],1)],1)],1),n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:e.$t("technology")}},[n("b-form-select",{attrs:{id:"new-plant-technology",options:e.technologies,required:""},model:{value:e.newPlant.technology_id,callback:function(t){e.$set(e.newPlant,"technology_id",t)},expression:"newPlant.technology_id"}})],1)],1),n("b-col",[n("b-form-group",{attrs:{label:e.$t("customer")}},[n("b-form-select",{attrs:{id:"new-plant-customer",options:e.customers,required:""},model:{value:e.newPlant.customer_id,callback:function(t){e.$set(e.newPlant,"customer_id",t)},expression:"newPlant.customer_id"}})],1)],1)],1)],1),n("app-modal-form",{ref:"appEditPlantModal",attrs:{id:"edit-plant-modal",title:e.$t("edit-plant"),subtitle:e.editPlant&&e.editPlant.name||"",okTitle:e.$t("apply"),modalLoading:e.editPlantLoading,superAdminProtected:!0},on:{submit:e.onSubmitEditPlant}},[e.editPlant?n("div",[n("b-form-group",{attrs:{label:e.$t("name")}},[n("b-form-input",{attrs:{id:"edit-plant-name",required:"",placeholder:e.$t("name")},model:{value:e.editPlant.name,callback:function(t){e.$set(e.editPlant,"name",t)},expression:"editPlant.name"}})],1),e.editPlant.digitized?n("b-form-group",{attrs:{label:e.$t("setup-phase")}},[n("b-form-checkbox",{attrs:{switch:""},model:{value:e.editPlant.inSetupPhase,callback:function(t){e.$set(e.editPlant,"inSetupPhase",t)},expression:"editPlant.inSetupPhase"}},[e._v(" "+e._s(e.$t("in-setup-phase"))+" ")])],1):e._e(),e.editPlant.digitized?n("b-form-group",{attrs:{label:e.$t("orientation-angle")}},[n("b-form-input",{attrs:{type:"number",step:"0.01",min:"-90",max:"90"},model:{value:e.editPlant.orientation,callback:function(t){e.$set(e.editPlant,"orientation",t)},expression:"editPlant.orientation"}})],1):e._e()],1):e._e()])],1)},i=[];a._withStripped=!0;var l=n(67),r=n(6),o=n(59),s=n(11),c=n(19),u=n(20),d=n(23),p=n(22),m=n(27),f=(n(46),n(21),n(112),n(95),n(94),n(72),n(151),n(145),n(97)),h=n(147),b=n(281),g=n(16),P=n(42),v=n(302),y=n(47),w=n(71),k=n(279),O=n(149),j=n(60),_=n(311),M=n(313),x=n(307),$=n(277),S=function(e,t,n,a){var i,l=arguments.length,r=l<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(m["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,n,r):i(t,n))||r);return l>3&&r&&Object.defineProperty(t,n,r),r},C=function(e){Object(d["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.plantModalLoading=!1,e.columns=null,e.plants=null,e.tableLoading=!1,e.managePlantModel={plant:null,clearBefore:!0,file:null},e.customers=[],e.technologies=[],e.createPlantLoading=!1,e.newPlant={name:"",technology_id:null,customer_id:null},e.editPlantLoading=!1,e.editPlant=null,e}return Object(u["a"])(n,[{key:"created",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.columns=[{key:"name",label:this.$t("name").toString()},{key:"productPackages",label:this.$t("product-packages").toString()}],!this.isSuperAdmin){e.next=15;break}return this.columns.push({key:"established",label:this.$t("established").toString(),superAdminOnly:!0}),this.columns.push({key:"technology",label:this.$t("technology").toString(),superAdminOnly:!0}),this.columns.push({key:"customerNames",label:this.$t("customers").toString(),superAdminOnly:!0}),e.t0=[{value:null,text:""}],e.t1=o["a"],e.next=9,y["a"].getCustomers();case 9:return e.t2=e.sent.map((function(e){return{value:e.id,text:e.name}})),e.t3=(0,e.t1)(e.t2),this.customers=e.t0.concat.call(e.t0,e.t3),e.next=14,y["a"].getTechnologies();case 14:this.technologies=e.sent.map((function(e){return{value:e.id,text:e.abbrev}}));case 15:return e.next=17,this.updatePlants();case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updatePlants",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=x["a"],e.next=3,y["a"].getPlants(!0,!0);case 3:e.t1=e.sent,this.plants=(0,e.t0)(e.t1,"name").map((function(e){var t;return{id:e.id,name:e.name,digitized:!!e.fieldgeometry,analysesCount:e.analysis_results_count,established:!e.in_setup_phase,fieldgeometry:e.fieldgeometry,technology:e.technology.abbrev,customerNames:null===(t=e.customers)||void 0===t?void 0:t.map((function(e){return e.name})).join(", "),customers:e.customers,productPackages:function(e){var t,n=[],a=Object(l["a"])(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push.apply(n,Object(o["a"])(i.order_product_packages.filter((function(e){return 1!==e.product_package.id}))))}}catch(r){a.e(r)}finally{a.f()}return n}(e.current_orders)}}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveManagePlant",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(){var t,n=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].importFieldgeometry(this.managePlantModel.file,this.managePlantModel.plant.id,this.managePlantModel.clearBefore);case 2:t=e.sent,y["a"].waitForTask(t.id,function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(t,a){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.plantModalLoading=!1,!a){e.next=5;break}n.showError({error:"SOMETHING_WENT_WRONG",message:t.output.error}),e.next=9;break;case 5:return n.managePlantModal.hide(),n.showSuccess(n.$t("dt-imported-successfully").toString()),e.next=9,n.updatePlants();case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),(function(e){n.managePlantModal.alertInfo(y["a"].getTaskOutputAsMessage(e,n.$t("wait-for-start").toString()))}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onManagePlantClick",value:function(e){this.managePlantModel.plant=e,this.managePlantModel.clearBefore=!0,this.managePlantModel.file=null,this.managePlantModal.show()}},{key:"onFileClick",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(t){var n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].getFieldgeometryFileUrl(t.id);case 2:n=e.sent,v["a"].download(n.url,t.file_name);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCreatePlantClick",value:function(){var e;this.newPlant={name:"",technology_id:null,customer_id:(null===(e=this.selectedCustomer)||void 0===e?void 0:e.id)||null},this.appCreatePlantModal.hideAlert(),this.appCreatePlantModal.show()}},{key:"onSubmitCreatePlant",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].createPlant({name:this.newPlant.name,technology_id:this.newPlant.technology_id,customer_id:this.newPlant.customer_id});case 2:return this.appCreatePlantModal.hide(),this.showSuccess(this.$t("plant-created-success").toString()),e.next=6,this.updatePlants();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeletePlantClick",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(confirm(this.$t("sure-delete-plant",{plant:t.name}).toString())){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,y["a"].deletePlant(t.id);case 4:return this.showSuccess(this.$t("plant-deleted-success",{plant:t.name}).toString()),e.next=7,this.updatePlants();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onEditPlantClick",value:function(e){var t;this.editPlant={id:e.id,name:e.name,digitized:e.digitized,inSetupPhase:!e.established,orientation:null===(t=e.fieldgeometry)||void 0===t?void 0:t.orientation},this.appEditPlantModal.show()}},{key:"onSubmitEditPlant",value:function(){var e=Object(s["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].updatePlant(this.editPlant.id,{name:this.editPlant.name,in_setup_phase:this.editPlant.inSetupPhase,orientation:(null===(t=this.editPlant)||void 0===t?void 0:t.orientation)||void 0});case 2:return this.appEditPlantModal.hide(),this.showSuccess(this.$t("plant-updated-success",{plant:this.editPlant.name}).toString()),e.next=6,this.updatePlants();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(P["a"]);S([Object(g["c"])()],C.prototype,"managePlantModal",void 0),S([Object(g["c"])()],C.prototype,"appCreatePlantModal",void 0),S([Object(g["c"])()],C.prototype,"appEditPlantModal",void 0),S([Object($["a"])("tableLoading")],C.prototype,"created",null),S([Object($["a"])("plantModalLoading")],C.prototype,"saveManagePlant",null),S([Object($["a"])()],C.prototype,"onManagePlantClick",null),S([Object($["a"])()],C.prototype,"onFileClick",null),S([Object($["a"])()],C.prototype,"onCreatePlantClick",null),S([Object($["a"])("createPlantLoading")],C.prototype,"onSubmitCreatePlant",null),S([Object($["a"])("tableLoading")],C.prototype,"onDeletePlantClick",null),S([Object($["a"])()],C.prototype,"onEditPlantClick",null),S([Object($["a"])("editPlantLoading")],C.prototype,"onSubmitEditPlant",null),C=S([Object(g["a"])({name:"app-plants",components:{AppContent:f["a"],AppTableContainer:b["a"],AppModalForm:h["a"],AppButton:w["a"],AppSuperAdminMarker:j["a"],AppModalFormInfoArea:_["a"],AppOrderPpsView:M["a"],AppTable:k["a"],AppIcon:O["a"]}})],C);var A=C,L=A,E=n(32),z=Object(E["a"])(L,a,i,!1,null,null,null);z.options.__file="src/app/plant/plants.vue";t["default"]=z.exports}}]);