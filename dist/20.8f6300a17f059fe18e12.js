(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{312:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i(95);function r(e){var t=["KB","MB","GB","TB"],i=0;do{e/=1024}while(e>1024&&++i<t.length);return"".concat(Math.round(e)," ").concat(t[i])}},484:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("app-content",{attrs:{title:e.$t("documentation")}},[e.isSuperAdmin?i("div",{staticClass:"app-doc-files-table-toolbar"},[i("app-button",{attrs:{variant:"primary",superAdminProtected:!0},on:{click:e.onCreateDocFileClick}},[e._v(" "+e._s(e.$t("upload-new-doc-file"))+" ")])],1):e._e(),i("app-table-container",[i("app-table",{attrs:{columns:e.columns,rows:e.rows,loading:e.loading,hoverActions:!0},scopedSlots:e._u([{key:"cell(fileName)",fn:function(t){return[i("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),e.onFileClick(t.item)}}},[e._v(e._s(t.item.title||t.item.fileName))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.item.description,expression:"row.item.description"}],staticClass:"grayed"},[e._v(" "+e._s(t.item.description)+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.item.title&&e.isSuperAdmin,expression:"row.item.title && isSuperAdmin"}],staticClass:"grayed"},[i("small",[e._v(e._s(t.item.fileName))])])]}},{key:"cell(updatedAtBy)",fn:function(t){return[i("small",{domProps:{innerHTML:e._s(t.item.updatedAtBy)}})]}},{key:"hoverActions",fn:function(t){return[i("app-button",{attrs:{variant:"secondary",size:"sm",title:e.$t("copy-file-link"),icon:"clipboard"},on:{click:function(i){return e.onCopyDocFileClick(t.item)}}}),i("app-button",{attrs:{variant:"secondary",size:"sm",title:e.$t("edit-doc-file"),superAdminProtected:!0,icon:"wrench"},on:{click:function(i){return e.onEditDocFileClick(t.item)}}}),i("app-button",{attrs:{variant:"outline-danger",size:"sm",title:e.$t("delete-doc-file"),superAdminProtected:!0,icon:"trash"},on:{click:function(i){return e.onDeleteDocFileClick(t.item)}}})]}}])})],1),i("app-modal-form",{ref:"appDocFileModal",attrs:{id:"edit-doc-file-modal",title:e.docFileModalTitle,subtitle:e.docFileModalSubtitle,"ok-title":e.docFileModalOkTitle,modalLoading:e.docFileModalLoading,superAdminProtected:!0},on:{submit:e.onSubmitDocFile}},[e.currentDocFile?i("div",[i("b-form-group",{attrs:{label:e.$t("doc-file")}},[i("app-simple-file-upload",{attrs:{uploadProgress:e.uploadProgress},model:{value:e.currentDocFile.file,callback:function(t){e.$set(e.currentDocFile,"file",t)},expression:"currentDocFile.file"}})],1),i("b-form-group",{attrs:{label:e.$t("title")}},[i("b-form-input",{model:{value:e.currentDocFile.title,callback:function(t){e.$set(e.currentDocFile,"title",t)},expression:"currentDocFile.title"}})],1),i("b-form-group",{attrs:{label:e.$t("description")}},[i("b-form-textarea",{attrs:{id:"description"},model:{value:e.currentDocFile.description,callback:function(t){e.$set(e.currentDocFile,"description",t)},expression:"currentDocFile.description"}})],1)],1):e._e()])],1)},n=[];r._withStripped=!0;var o=i(59),c=i(6),a=i(11),l=i(19),s=i(20),u=i(23),d=i(22),p=i(27),h=(i(46),i(21),i(112),i(144),i(94),i(73),i(82),i(43),i(50),i(222),i(161),i(283),i(95),i(16)),f=i(281),m=i(147),b=i(47),v=i(42),F=i(372),w=i(97),g=i(146),k=i(312),D=i(302),y=i(79),S=i(71),x=i(279),O=function(e,t,i,r){var n,o=arguments.length,c=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)c=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(c=(o<3?n(c):o>3?n(t,i,c):n(t,i))||c);return o>3&&c&&Object.defineProperty(t,i,c),c},j=function(e){Object(u["a"])(i,e);var t=Object(d["a"])(i);function i(){var e;return Object(l["a"])(this,i),e=t.apply(this,arguments),e.columns=[],e.rows=[],e.loading=!1,e.docFileModalLoading=!1,e.docFileModalTitle="",e.docFileModalSubtitle="",e.docFileModalOkTitle="",e.currentDocFile=null,e.uploadProgress=null,e}return Object(s["a"])(i,[{key:"created",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(){var t,i=this;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.columns=[{key:"fileName",label:this.$t("document").toString()},{key:"updatedAtBy",label:this.$t("changed").toString()},{key:"size",label:this.$t("size").toString()}],e.next=3,this.updateDocFileRows();case 3:if(!this.$route.query.fileId){e.next=8;break}if(t=this.rows.find((function(e){return e.id===i.$route.query.fileId})),!t){e.next=8;break}return e.next=8,this.onFileClick(t,"_self");case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateDocFileRows",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(){var t=this;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,b["a"].getDocFiles();case 4:this.rows=e.sent.map((function(e){return{id:e.id,file:null,description:e.description||null,title:e.title,fileName:e.file_name,updatedAtBy:t.getChangedText(e),size:Object(k["a"])(e.size)}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.showError(e.t0);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFileClick",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(t,i){var r;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b["a"].getDocFileUrl(t.id);case 3:r=e.sent,D["a"].open(r.url,i||"_blank"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"onCopyDocFileClick",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(t){var i;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,i=new URL("doc/files?fileId=".concat(t.id),y["b"]).toString(),e.next=4,navigator.clipboard.writeText(i);case 4:this.showSuccess(this.$t("copy-file-link-success").toString()),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCreateDocFileClick",value:function(){try{this.currentDocFile={file:null,description:null,title:null},this.docFileModalTitle=this.$t("upload-new-doc-file").toString(),this.docFileModalSubtitle="",this.docFileModalOkTitle=this.$t("create").toString(),this.uploadProgress=null,this.appDocFileModal.show()}catch(e){this.showError(e)}}},{key:"onEditDocFileClick",value:function(e){try{this.currentDocFile=e,this.docFileModalTitle=this.$t("edit-doc-file").toString(),this.docFileModalSubtitle=e.fileName||"",this.docFileModalOkTitle=this.$t("apply").toString(),this.uploadProgress=null,this.appDocFileModal.show()}catch(t){this.showError(t)}}},{key:"onSubmitDocFile",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(){var t=this;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.docFileModalLoading=!0,e.prev=1,this.currentDocFile){e.next=4;break}throw new Error("Something went wrong! (Detais: currentDocFile is falsy)");case 4:if(!this.currentDocFile.id){e.next=12;break}if(this.currentDocFile.file||null!==this.currentDocFile.description&&void 0!==this.currentDocFile.description){e.next=7;break}throw{error:"MISSING_FILE_OR_DESCRIPTION",message:"Nothing changed..."};case 7:return e.next=9,b["a"].editDocFile(this.currentDocFile.id,this.currentDocFile.file||void 0,this.currentDocFile.title||void 0,this.currentDocFile.description||void 0,(function(e){return t.uploadProgress={total:e.total,loaded:e.loaded}}));case 9:this.showSuccess(this.$t("doc-file-updated-success").toString()),e.next=17;break;case 12:if(this.currentDocFile.file){e.next=14;break}throw{error:"MISSING_FILE",message:"Please select a document to upload"};case 14:return e.next=16,b["a"].createDocFile(this.currentDocFile.file,this.currentDocFile.title||void 0,this.currentDocFile.description||void 0,(function(e){return t.uploadProgress={total:e.total,loaded:e.loaded}}));case 16:this.showSuccess(this.$t("doc-file-created-success").toString());case 17:return this.appDocFileModal.hide(),e.next=20,this.updateDocFileRows();case 20:e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](1),this.showError(e.t0);case 25:return e.prev=25,this.docFileModalLoading=!1,e.finish(25);case 28:case"end":return e.stop()}}),e,this,[[1,22,25,28]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeleteDocFileClick",value:function(){var e=Object(a["a"])(Object(c["a"])().mark((function e(t){return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,e.prev=1,confirm(this.$t("sure-delete-doc-file",{fileName:t.fileName}).toString())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,b["a"].deleteDocFile(t.id);case 6:return this.showSuccess(this.$t("doc-file-deleted-success",{fileName:t.fileName}).toString()),e.next=9,this.updateDocFileRows();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),this.showError(e.t0);case 14:return e.prev=14,this.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getChangedText",value:function(e){var t=(e.user.first_name+" "+e.user.last_name).trim()||e.user.email,i="",r="";return e.updated_at?(i=this.$t("updated").toString(),r=this.$t.apply(this,Object(o["a"])(g["a"].getTimeDiff(e.updated_at))).toString()):(i=this.$t("created").toString(),r=this.$t.apply(this,Object(o["a"])(g["a"].getTimeDiff(e.created_at))).toString()),"".concat(i," ").concat(r," ").concat(this.$t("by").toString()," ").concat(t)}}]),i}(v["a"]);O([Object(h["c"])()],j.prototype,"appDocFileModal",void 0),j=O([Object(h["a"])({name:"app-doc-files",components:{AppContent:w["a"],AppTableContainer:f["a"],AppModalForm:m["a"],AppSimpleFileUpload:F["a"],AppButton:S["a"],AppTable:x["a"]}})],j);var $=j,_=$,M=i(32),C=Object(M["a"])(_,r,n,!1,null,null,null);C.options.__file="src/app/doc/doc-files.vue";t["default"]=C.exports}}]);