(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{272:function(e,t,n){},274:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"app-table-container "+(e.size?"app-table-container-"+e.size:"")},[e._t("default")],2)},i=[];a._withStripped=!0;var r=n(20),l=n(19),o=n(25),s=n(24),c=n(30),u=(n(47),n(23),n(17)),d=n(16),p=function(e,t,n,a){var i,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},m=function(e){Object(o["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(l["a"])(this,n),t.apply(this,arguments)}return Object(r["a"])(n)}(u["default"]);p([Object(d["b"])({default:""})],m.prototype,"size",void 0),m=p([d["a"]],m);var h=m,f=h,b=(n(277),n(34)),v=Object(b["a"])(f,a,i,!1,null,null,null);v.options.__file="src/app/shared/components/app-table-container/app-table-container.vue";t["a"]=v.exports},277:function(e,t,n){"use strict";n(272)},280:function(e,t,n){"use strict";var a=n(21),i=n(72),r=n(49),l=n(28),o=n(149),s=[],c=s.sort,u=l((function(){s.sort(void 0)})),d=l((function(){s.sort(null)})),p=o("sort"),m=u||!d||!p;a({target:"Array",proto:!0,forced:m},{sort:function(e){return void 0===e?c.call(r(this)):c.call(r(this),i(e))}})},287:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(19),i=n(20),r=function(){function e(){Object(a["a"])(this,e)}return Object(i["a"])(e,null,[{key:"download",value:function(e,t){var n=document.createElement("a");n.href=e,n.setAttribute("download",t||e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"open",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";null===(t=window.open(e,n))||void 0===t||t.focus()}}]),e}()},335:function(e,t,n){},392:function(e,t,n){"use strict";n(335)},409:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-content",{attrs:{title:e.$t("plants-overview"),subtitle:e.$t("plants-overview_descr")}},[e.isSuperAdmin?n("div",{staticClass:"plant-tools"},[n("app-button",{attrs:{variant:"secondary",superAdminProtected:!0},on:{click:function(t){return e.onCreatePlantClick()}}},[e._v(e._s(e.$t("create-plant")))])],1):e._e(),n("app-table-container",[n("b-table",{attrs:{hover:"",fields:e.columns,items:e.plants,"head-variant":"light","show-empty":"",emptyText:e.$t("no-data"),busy:e.tableLoading},scopedSlots:e._u([{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center"},[n("b-spinner",{staticClass:"align-middle"})],1)]},proxy:!0},{key:"head(customers)",fn:function(){return[e._v(" "+e._s(e.$t("customers"))+" "),n("app-super-admin-marker")]},proxy:!0},{key:"head(actions)",fn:function(){return[n("span",{staticClass:"hidden"},[e._v(e._s(e.$t("actions")))])]},proxy:!0},{key:"cell(name)",fn:function(t){return[n("router-link",{directives:[{name:"show",rawName:"v-show",value:t.item.digitized,expression:"row.item.digitized"}],attrs:{to:{name:"Plant",params:{id:t.item.id}}}},[e._v(" "+e._s(t.item.name)+" ")]),t.item.digitized?e._e():n("span",[e._v(e._s(t.item.name))])]}},{key:"cell(digitized)",fn:function(e){return[n("b-icon",{class:e.item.digitized?"green":"red",attrs:{icon:e.item.digitized?"check2":"x"}})]}},{key:"cell(established)",fn:function(e){return[n("b-icon",{class:e.item.established?"green":"red",attrs:{icon:e.item.established?"check2":"x"}})]}},{key:"cell(actions)",fn:function(t){return[n("div",{staticClass:"hover-cell pull-right"},[n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("upload-dt"),icon:"hammer",superAdminProtected:!0},on:{click:function(n){return e.onManagePlantClick(t.item)}}}),n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("edit-plant"),icon:"wrench",superAdminProtected:!0},on:{click:function(n){return e.onEditPlantClick(t.item)}}}),n("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"outline-danger",size:"sm",title:e.$t("delete-plant"),icon:"trash",superAdminProtected:!0},on:{click:function(n){return e.onDeletePlantClick(t.item)}}})],1),n("div",{staticClass:"clearfix"})]}}])})],1),n("app-modal-form",{ref:"managePlantModal",attrs:{id:"manage-plant-modal",title:e.$t("upload-dt"),subtitle:e.managePlantModel.plant&&e.managePlantModel.plant.name||"","ok-title":e.$t("apply"),modalLoading:e.plantModalLoading,superAdminProtected:!0},on:{submit:e.saveManagePlant}},[e.managePlantModel.plant?n("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.managePlantModel.plant.fieldgeometry,expression:"managePlantModel.plant.fieldgeometry"}]},[n("a",{attrs:{href:"#"},on:{click:function(t){return e.onFileClick(e.managePlantModel.plant.fieldgeometry)}}},[e._v(" "+e._s(e.managePlantModel.plant.fieldgeometry&&e.managePlantModel.plant.fieldgeometry.file_name)+" ")])]):e._e(),n("b-form-group",[n("b-form-checkbox",{attrs:{id:"clear-before-checkbox"},model:{value:e.managePlantModel.clearBefore,callback:function(t){e.$set(e.managePlantModel,"clearBefore",t)},expression:"managePlantModel.clearBefore"}},[e._v(" "+e._s(e.$t("clear-before"))+" ")])],1),n("b-form-group",{attrs:{label:e.$t("select-dt-json-file")}},[n("b-form-file",{attrs:{required:"",accept:".json"},model:{value:e.managePlantModel.file,callback:function(t){e.$set(e.managePlantModel,"file",t)},expression:"managePlantModel.file"}})],1)],1),n("app-modal-form",{ref:"appCreatePlantModal",attrs:{id:"create-plant-modal",title:e.$t("create-plant"),okTitle:e.$t("create"),modalLoading:e.createPlantLoading,superAdminProtected:!0},on:{submit:e.onSubmitCreatePlant}},[n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:e.$t("name")}},[n("b-form-input",{attrs:{id:"new-plant-name",required:"",placeholder:e.$t("name")},model:{value:e.newPlant.name,callback:function(t){e.$set(e.newPlant,"name",t)},expression:"newPlant.name"}})],1)],1)],1),n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:e.$t("technology")}},[n("b-form-select",{attrs:{id:"new-plant-technology",options:e.technologies,required:""},model:{value:e.newPlant.technology_id,callback:function(t){e.$set(e.newPlant,"technology_id",t)},expression:"newPlant.technology_id"}})],1)],1),n("b-col",[n("b-form-group",{attrs:{label:e.$t("customer")}},[n("b-form-select",{attrs:{id:"new-plant-customer",options:e.customers,required:""},model:{value:e.newPlant.customer_id,callback:function(t){e.$set(e.newPlant,"customer_id",t)},expression:"newPlant.customer_id"}})],1)],1)],1)],1),n("app-modal-form",{ref:"appEditPlantModal",attrs:{id:"edit-plant-modal",title:e.$t("edit-plant"),subtitle:e.managePlantModel.plant&&e.managePlantModel.plant.name||"",okTitle:e.$t("apply"),modalLoading:e.editPlantLoading,superAdminProtected:!0},on:{submit:e.onSubmitEditPlant}},[e.editPlant?n("b-form-group",{attrs:{label:e.$t("name")}},[n("b-form-input",{attrs:{id:"edit-plant-name",required:"",placeholder:e.$t("name")},model:{value:e.editPlant.name,callback:function(t){e.$set(e.editPlant,"name",t)},expression:"editPlant.name"}})],1):e._e(),e.editPlant&&e.editPlant.digitized?n("b-form-group",{attrs:{label:e.$t("setup-phase")}},[n("b-form-checkbox",{attrs:{switch:""},model:{value:e.editPlant.inSetupPhase,callback:function(t){e.$set(e.editPlant,"inSetupPhase",t)},expression:"editPlant.inSetupPhase"}},[e._v(" "+e._s(e.$t("in-setup-phase"))+" ")])],1):e._e(),e.editPlant&&e.editPlant.digitized?n("b-form-group",{attrs:{label:e.$t("orientation-angle")}},[n("b-form-input",{attrs:{type:"number",step:"0.01",min:"-90",max:"90"},model:{value:e.editPlant.orientation,callback:function(t){e.$set(e.editPlant,"orientation",t)},expression:"editPlant.orientation"}})],1):e._e()],1)],1)},i=[];a._withStripped=!0;var r=n(7),l=n(58),o=n(13),s=n(19),c=n(20),u=n(25),d=n(24),p=n(30),m=(n(47),n(23),n(111),n(94),n(112),n(80),n(280),n(148),n(95)),h=n(146),f=n(274),b=n(16),v=n(42),g=n(287),P=n(48),w=n(70),y=n(64),k=function(e,t,n,a){var i,r=arguments.length,l=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,n,a);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(r<3?i(l):r>3?i(t,n,l):i(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l},x=function(e){Object(u["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.plantModalLoading=!1,e.columns=null,e.plants=null,e.tableLoading=!1,e.managePlantModel={plant:null,clearBefore:!0,file:null},e.customers=[],e.technologies=[],e.createPlantLoading=!1,e.newPlant={name:"",technology_id:null,customer_id:null},e.editPlantLoading=!1,e.editPlant=null,e}return Object(c["a"])(n,[{key:"created",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.columns=[{key:"name",label:this.$t("name").toString()},{key:"digitized",label:this.$t("digitized").toString()},{key:"established",label:this.$t("established").toString()},{key:"analysesCount",label:this.$t("number-of-analyses").toString()},{key:"technology",label:this.$t("technology").toString()}],!this.isSuperAdmin){e.next=14;break}return this.columns.push({key:"customers",label:this.$t("customers").toString()}),this.columns.push({key:"actions"}),e.t0=[{value:null,text:""}],e.t1=l["a"],e.next=8,P["a"].getCustomers();case 8:return e.t2=e.sent.map((function(e){return{value:e.id,text:e.name}})),e.t3=(0,e.t1)(e.t2),this.customers=e.t0.concat.call(e.t0,e.t3),e.next=13,P["a"].getTechnologies();case 13:this.technologies=e.sent.map((function(e){return{value:e.id,text:e.abbrev}}));case 14:return e.next=16,this.updatePlants();case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updatePlants",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.tableLoading=!0,e.next=4,P["a"].getPlants(!0);case 4:t=e.sent,this.plants=t.map((function(e){var t;return{id:e.id,name:e.name,digitized:!!e.fieldgeometry,analysesCount:e.analysis_results_count,established:!e.in_setup_phase,fieldgeometry:e.fieldgeometry,technology:e.technology.abbrev,customers:null===(t=e.customers)||void 0===t?void 0:t.map((function(e){return e.name})).join(", ")}})).sort((function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n<a?-1:n>a?1:0})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:return e.prev=11,this.tableLoading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveManagePlant",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(){var t,n=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.plantModalLoading=!0,e.next=4,P["a"].importFieldgeometry(this.managePlantModel.file,this.managePlantModel.plant.id,this.managePlantModel.clearBefore);case 4:t=e.sent,P["a"].waitForTask(t.id,function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(t,a){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.plantModalLoading=!1,!a){e.next=5;break}n.showError({error:"SOMETHING_WENT_WRONG",message:t.output.error}),e.next=9;break;case 5:return n.managePlantModal.hide(),n.showSuccess(n.$t("dt-imported-successfully").toString()),e.next=9,n.updatePlants();case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),(function(e){n.managePlantModal.alertInfo(P["a"].getTaskOutputAsMessage(e,n.$t("wait-for-start").toString()))})),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),this.plantModalLoading=!1,this.showError(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onManagePlantClick",value:function(e){this.managePlantModel.plant=e,this.managePlantModel.clearBefore=!0,this.managePlantModel.file=null,this.managePlantModal.show()}},{key:"onFileClick",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(t){var n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P["a"].getFieldgeometryFileUrl(t.id);case 3:n=e.sent,g["a"].download(n.url,t.file_name),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCreatePlantClick",value:function(){var e;this.newPlant={name:"",technology_id:null,customer_id:(null===(e=this.selectedCustomer)||void 0===e?void 0:e.id)||null},this.appCreatePlantModal.hideAlert(),this.appCreatePlantModal.show()}},{key:"onSubmitCreatePlant",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.createPlantLoading=!0,e.prev=1,e.next=4,P["a"].createPlant({name:this.newPlant.name,technology_id:this.newPlant.technology_id,customer_id:this.newPlant.customer_id});case 4:return this.appCreatePlantModal.hide(),this.showSuccess(this.$t("plant-created-success").toString()),e.next=8,this.updatePlants();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),this.showError(e.t0);case 13:return e.prev=13,this.createPlantLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeletePlantClick",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.tableLoading=!0,e.prev=1,confirm(this.$t("sure-delete-plant",{plant:t.name}).toString())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,P["a"].deletePlant(t.id);case 6:return this.showSuccess(this.$t("plant-deleted-success",{plant:t.name}).toString()),e.next=9,this.updatePlants();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),this.showError(e.t0);case 14:return e.prev=14,this.tableLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onEditPlantClick",value:function(e){var t;this.editPlant={id:e.id,name:e.name,digitized:e.digitized,inSetupPhase:!e.established,orientation:null===(t=e.fieldgeometry)||void 0===t?void 0:t.orientation},this.appEditPlantModal.show()}},{key:"onSubmitEditPlant",value:function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.editPlantLoading=!0,e.prev=1,e.next=4,P["a"].updatePlant(this.editPlant.id,{name:this.editPlant.name,in_setup_phase:this.editPlant.inSetupPhase,orientation:(null===(t=this.editPlant)||void 0===t?void 0:t.orientation)||void 0});case 4:return this.appEditPlantModal.hide(),this.showSuccess(this.$t("plant-updated-success",{plant:this.editPlant.name}).toString()),e.next=8,this.updatePlants();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),this.showError(e.t0);case 13:return e.prev=13,this.editPlantLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()}]),n}(v["a"]);k([Object(b["c"])()],x.prototype,"managePlantModal",void 0),k([Object(b["c"])()],x.prototype,"appCreatePlantModal",void 0),k([Object(b["c"])()],x.prototype,"appEditPlantModal",void 0),x=k([Object(b["a"])({name:"app-analysis",components:{AppContent:m["a"],AppTableContainer:f["a"],AppModalForm:h["a"],AppButton:w["a"],AppSuperAdminMarker:y["a"]}})],x);var _=x,j=_,O=(n(392),n(34)),M=Object(O["a"])(j,a,i,!1,null,null,null);M.options.__file="src/app/plant/plants.vue";t["default"]=M.exports}}]);