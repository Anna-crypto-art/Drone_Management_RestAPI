(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{295:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(18),i=a(19),s=a(285),r=a(116),l=a(23),o=a(22),c=(a(76),a(309)),u=function(e){Object(l["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"on",value:function(e,t,n){Object(s["a"])(Object(r["a"])(a.prototype),"on",this).call(this,e,t,n)}},{key:"emit",value:function(e,t){for(var n,i=arguments.length,l=new Array(i>2?i-2:0),o=2;o<i;o++)l[o-2]=arguments[o];return(n=Object(s["a"])(Object(r["a"])(a.prototype),"emit",this)).call.apply(n,[this,e,t].concat(l))}}]),a}(c["a"]),p=new u},296:function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return n})),function(e){e["UPDATE_ANALYSIS"]="updateAnalysis",e["RUN_ANALYSIS_TASK"]="runAnalysisTask",e["FINISHED_ANALYSIS_TASK"]="finishedAnalysisTask",e["QFLY_SERVER_STATE_CHANGED"]="qflyServerStateChanged"}(n||(n={}))},319:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a(76);function n(e){var t=["KB","MB","GB","TB"],a=0;do{e/=1024}while(e>1024&&++a<t.length);return"".concat(Math.round(e)," ").concat(t[a])}},328:function(e,t,a){},329:function(e,t,a){},330:function(e,t,a){},333:function(e,t,a){},343:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-simple-file-upload"},[a("b-form-file",{attrs:{accept:e.accept},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}}),e.uploadProgress&&e.modelValue?a("div",{staticClass:"mar-top"},[e._v(" "+e._s(e.isUploadComplete?e.$t("upload-completed"):e.$t("uploading"))+" "),a("b-progress",{attrs:{max:e.uploadProgress.total}},[a("b-progress-bar",{attrs:{value:e.uploadProgress.loaded,variant:"success"}},[e.isUploadComplete?a("span",[e._v(" "+e._s(e.$t("upload-succes-filename",{filename:e.modelValue.name}))+" ")]):e._e(),e.uploadProgress.loaded<e.uploadProgress.total?a("span",[e._v(" "+e._s(Math.round(e.uploadProgress.loaded/e.uploadProgress.total*100))+"% ")]):e._e()])],1)],1):e._e()],1)},i=[];n._withStripped=!0;var s=a(18),r=a(19),l=a(23),o=a(22),c=a(27),u=(a(44),a(24),a(17)),p=a(15),d=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},f=function(e){Object(l["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.modelValue=null,e}return Object(r["a"])(a,[{key:"created",value:function(){this.modelValue=this.value}},{key:"onModelValueChanged",value:function(){this.$emit("input",this.modelValue)}},{key:"isUploadComplete",get:function(){return this.uploadProgress&&this.uploadProgress.loaded===this.uploadProgress.total||!1}}]),a}(u["default"]);d([Object(p["b"])({required:!0})],f.prototype,"value",void 0),d([Object(p["b"])({required:!0})],f.prototype,"uploadProgress",void 0),d([Object(p["b"])({default:"*"})],f.prototype,"accept",void 0),d([Object(p["d"])("modelValue")],f.prototype,"onModelValueChanged",null),f=d([Object(p["a"])({name:"app-simple-file-upload"})],f);var h=f,m=h,b=a(28),g=Object(b["a"])(m,n,i,!1,null,null,null);g.options.__file="src/app/shared/components/app-simple-file-upload/app-simple-file-upload.vue";t["a"]=g.exports},346:function(e,t,a){"use strict";var n,i;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),function(e){e["UNALLOCATED"]="UNALLOCATED",e["STOPPED"]="STOPPED",e["RUNNING"]="RUNNING"}(n||(n={})),function(e){e["ALLOCATE"]="ALLOCATE",e["ALLOCATE_AND_START"]="ALLOCATE_AND_START",e["START"]="START",e["RELEASE"]="RELEASE",e["SET_SERVER_SIZE_SMALL"]="SET_SERVER_SIZE_SMALL",e["SET_SERVER_SIZE_MEDIUM"]="SET_SERVER_SIZE_MEDIUM",e["SET_SERVER_SIZE_LARGE"]="SET_SERVER_SIZE_LARGE",e["STOP"]="STOP",e["STOP_AND_RELEASE"]="STOP_AND_RELEASE",e["INCREASE_EBS_SIZE_100GB"]="INCREASE_EBS_SIZE_100GB",e["INCREASE_EBS_SIZE_250GB"]="INCREASE_EBS_SIZE_250GB",e["INCREASE_EBS_SIZE_500GB"]="INCREASE_EBS_SIZE_500GB"}(i||(i={}))},353:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-dropdown",{class:e.cls,attrs:{variant:e.variant,disabled:e.isDisabled,size:e.size},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._t("title",[e._v(e._s(e.title))]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"app-button-loading"},[a("b-spinner",{attrs:{small:""}})],1)]},proxy:!0}],null,!0)},[e._t("default")],2)},i=[];n._withStripped=!0;var s=a(18),r=a(19),l=a(23),o=a(22),c=a(27),u=(a(44),a(24),a(17)),p=a(15),d=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},f=function(e){Object(l["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(r["a"])(a,[{key:"isDisabled",get:function(){return this.loading||this.disabled}}]),a}(u["default"]);d([Object(p["b"])({default:""})],f.prototype,"title",void 0),d([Object(p["b"])({default:""})],f.prototype,"cls",void 0),d([Object(p["b"])({default:"primary"})],f.prototype,"variant",void 0),d([Object(p["b"])({default:!1})],f.prototype,"disabled",void 0),d([Object(p["b"])({default:!1})],f.prototype,"loading",void 0),d([Object(p["b"])({default:""})],f.prototype,"size",void 0),f=d([Object(p["a"])({name:"app-dropdown-button"})],f);var h=f,m=h,b=(a(366),a(28)),g=Object(b["a"])(m,n,i,!1,null,null,null);g.options.__file="src/app/shared/components/app-dropdown-button/app-dropdown-button.vue";t["a"]=g.exports},359:function(e,t,a){"use strict";a(328)},360:function(e,t,a){"use strict";a(329)},361:function(e,t,a){"use strict";a(330)},364:function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return n})),function(e){e["import_analysis_results"]="import_analysis_results",e["run_qfly_wizard"]="run_qfly_wizard",e["download_analysis_files"]="download_analysis_files"}(n||(n={}))},366:function(e,t,a){"use strict";a(333)},379:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-analysis-upload"},[a("div",{staticClass:"mar-bottom-2x"},[a("b-form-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.analysis&&!e.analysisIsEmpty,expression:"analysis && !analysisIsEmpty"}],attrs:{disabled:e.dataCompleteVerified||!!e.analysisHasAvailableDrones&&!e.analysisHasSelectedDrone},on:{change:e.onChangeDataComplete},model:{value:e.dataComplete,callback:function(t){e.dataComplete=t},expression:"dataComplete"}},[e._v(" "+e._s(e.$t("data-complete"))+" "),a("app-explanation",[e._v(e._s(e.$t("data-complete_expl")))])],1)],1),a("b-alert",{attrs:{show:e.analysis&&e.allowUploadFurtherData&&e.analysisHasAvailableDrones&&!e.analysisHasSelectedDrone,variant:"info"}},[e._v(" "+e._s(e.$t("need-to-select-drone-to-set-complete"))+" ")]),a("b-alert",{attrs:{show:e.analysis&&e.analysisIsEmpty,variant:"info"}},[e._v(" "+e._s(e.$t("need-to-upload-data-to-set-complete"))+" ")]),a("b-alert",{attrs:{show:!e.allowUploadFurtherData,variant:"info"}},[e._v(" "+e._s(e.$t("cannot-upload-further-data-while-data-complete"))+" ")]),e.uploaderService?a("app-uploader",{directives:[{name:"show",rawName:"v-show",value:e.allowUploadFurtherData,expression:"allowUploadFurtherData"}],attrs:{uploaderService:e.uploaderService,title:e.$t("browse-or-drag-drop-files"),disableAfterUpload:!e.analysis}},[e._l(e.$slots,(function(t,n){return a("template",{slot:n},[e._t(n)],2)}))],2):e._e(),e.gotoNewAnalysis?a("div",{staticClass:"pull-right mar-top mar-bottom"},[a("app-button",{on:{click:e.onGotoNewAnalysisClick}},[e._v(e._s(e.$t("goto-analysis",{analysis:e.gotoNewAnalysis.name})))])],1):e._e()],1)},i=[];n._withStripped=!0;var s=a(6),r=a(9),l=a(18),o=a(19),c=a(23),u=a(22),p=a(27),d=(a(44),a(24),a(83),a(63)),f=a(123),h=a(100),m=a(292),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-file-upload"},[a("b-alert",{attrs:{variant:"danger"},model:{value:e.showErrorAlert,callback:function(t){e.showErrorAlert=t},expression:"showErrorAlert"}},[e.error?a("div",[e._v(" "+e._s(e.$t("error-occured-retrying"))+" "),a("span",{staticClass:"pad-left"},[a("b-spinner",{attrs:{small:""}}),e._v(" ("+e._s(e.errorTrials)+" "+e._s(e.$t("trials"))+") ")],1),e.errorTrials>10?a("div",{staticClass:"mar-top"},[a("app-button",{attrs:{variant:"secondary",size:"sm",loading:e.cancelLoading},on:{click:e.onCancelUploadClick}},[e._v(" "+e._s(e.$t("cancel-upload"))+" ")])],1):e._e(),a("div",{staticClass:"mar-top font-xs"},[e._v(" "+e._s(e.$t("details"))+": "),a("b",[e._v(e._s(e.error.error))]),a("br"),e._v(" "+e._s(e.error.message)+" ")])]):e._e()]),a("app-files-selection",{attrs:{disabled:e.disableFilesSelection},on:{filesSelected:e.onFilesSelected},scopedSlots:e._u([{key:"files",fn:function(){return[a("div",{directives:[{name:"show",rawName:"v-show",value:e.files.length>0,expression:"files.length > 0"}],staticClass:"app-file-upload-files mar-top"},e._l(e.files,(function(t){return a("app-file-uploader",{key:t.fileName,attrs:{uploaderService:e.uploaderService,uploading:e.uploading,file:t}})})),1)]},proxy:!0}])},[a("div",{staticClass:"app-file-upload-content mar-bottom"},[e.title?a("h3",{staticClass:"app-file-upload-content-title"},[e._v(e._s(e.title))]):e._e(),e._t("default")],2)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showUploadButton,expression:"showUploadButton"}],staticClass:"pull-right mar-top mar-bottom"},[a("app-button",{attrs:{loading:e.uploading,disabled:e.uploadButtonDisabled,cls:"mar-left pull-right"},on:{click:e.onStartUpload}},[e._v(" "+e._s(e.$t("upload"))+" ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.uploading,expression:"!uploading"}],staticClass:"pull-right"},[e._t("addActions")],2)],1)],1)},g=[];b._withStripped=!0;var v=a(15),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-file-upload-file mar-bottom-half"},[a("div",{staticClass:"app-file-upload-file-infos"},[a("div",{staticClass:"app-file-upload-file-name"},[a("small",{staticClass:"grayed"},[e._v(e._s(e.fileSize))]),a("span",{staticClass:"pad-left"},[e._v(e._s(e.file.fileName))]),e.file.description?a("span",{staticClass:"pad-left font-xs",domProps:{innerHTML:e._s(e.file.description)}}):e._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.uploading,expression:"!uploading"}],staticClass:"app-file-upload-file-remove",on:{click:e.onFileRemove}},[a("b-icon",{attrs:{icon:"x"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploading,expression:"uploading"}],staticClass:"app-file-upload-file-progress"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.success,expression:"!success"}]},[e._v(e._s(e.progress)+"%")]),a("b-icon",{directives:[{name:"show",rawName:"v-show",value:e.success,expression:"success"}],staticClass:"text-success",attrs:{icon:"check2"}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploading,expression:"uploading"}],ref:"uploadProgressBar",staticClass:"app-file-upload-file-progressbar"})])},_=[];y._withStripped=!0;var O=a(17),w=a(319),k=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},S=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.progress=0,e.success=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=this;this.file.onProgress((function(t){e.progress=t,e.uploadProgressBar&&(e.uploadProgressBar.style.width=e.progress+"%")})),this.file.onComplete((function(){e.success=!0,e.uploadProgressBar&&(e.uploadProgressBar.style.display="none"),e.progress=0}))}},{key:"fileSize",get:function(){return Object(w["a"])(this.file.size)}},{key:"onFileRemove",value:function(){this.uploading||this.uploaderService.removeFile(this.file.fileName)}}]),a}(O["default"]);k([Object(v["b"])({required:!0})],S.prototype,"file",void 0),k([Object(v["b"])({required:!0})],S.prototype,"uploading",void 0),k([Object(v["b"])({required:!0})],S.prototype,"uploaderService",void 0),k([Object(v["c"])()],S.prototype,"uploadProgressBar",void 0),S=k([Object(v["a"])({name:"app-file-uploader"})],S);var A=S,j=A,C=(a(359),a(28)),x=Object(C["a"])(j,y,_,!1,null,null,null);x.options.__file="src/app/shared/components/app-file-upload/app-file-uploader.vue";var E=x.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-file-selection mar-bottom",class:{dragging:e.dragging},on:{drop:e.onDrop,dragover:e.onDragOver,dragleave:e.onDragLeave}},[e._t("default"),a("div",{staticClass:"app-file-selection-button"},[a("app-file-input",{attrs:{disabled:e.disabled},model:{value:e.fileButtonSelection,callback:function(t){e.fileButtonSelection=t},expression:"fileButtonSelection"}})],1),e._t("files")],2)},D=[];I._withStripped=!0;var F=a(49),P=(a(155),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{staticClass:"app-file-input btn btn-primary",class:{disabled:e.disabled}},[a("input",{ref:"fileInputElement",staticClass:"app-file-input-file",attrs:{type:"file",disabled:e.disabled,accept:e.accept,multiple:e.multiple},on:{click:e.onClick,change:e.onChange}}),e._v(" "+e._s(e.$t("browse"))+" ")])}),R=[];P._withStripped=!0;var T=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},N=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.modelValue=null,e}return Object(o["a"])(a,[{key:"created",value:function(){this.modelValue=this.value}},{key:"onModelValueChanged",value:function(){this.$emit("input",this.modelValue)}},{key:"onClick",value:function(){this.fileInputElement.value=""}},{key:"onChange",value:function(){this.setFiles()}},{key:"setFiles",value:function(){if(this.fileInputElement.files&&0!==this.fileInputElement.files.length){for(var e=[],t=0;t<this.fileInputElement.files.length;t++)e.push(this.fileInputElement.files[t]);this.modelValue=e}else this.modelValue=null}}]),a}(O["default"]);T([Object(v["b"])({required:!0})],N.prototype,"value",void 0),T([Object(v["b"])({default:!0})],N.prototype,"multiple",void 0),T([Object(v["b"])({default:"*"})],N.prototype,"accept",void 0),T([Object(v["b"])({default:!1})],N.prototype,"disabled",void 0),T([Object(v["c"])()],N.prototype,"fileInputElement",void 0),T([Object(v["d"])("modelValue")],N.prototype,"onModelValueChanged",null),N=T([Object(v["a"])({name:"app-file-input"})],N);var U=N,$=U,L=(a(360),Object(C["a"])($,P,R,!1,null,null,null));L.options.__file="src/app/shared/components/app-file-upload/app-file-input.vue";var M=L.exports,G=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},B=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.fileButtonSelection=null,e.fileDropSelection=null,e.dragging=!1,e}return Object(o["a"])(a,[{key:"emitFiles",value:function(){this.disabled||this.$emit("filesSelected",this.fileDropSelection||this.fileButtonSelection)}},{key:"onFileButtonSelectionChanged",value:function(){this.fileButtonSelection&&(this.fileDropSelection=null),this.emitFiles()}},{key:"onDrop",value:function(e){e.preventDefault(),this.dragging=!1;var t=[];Object(F["a"])(e.dataTransfer.files).forEach((function(e){t.push(e)})),this.fileButtonSelection=null,t.length>0?this.fileDropSelection=t:this.fileDropSelection=null,this.emitFiles()}},{key:"onDragOver",value:function(e){e.preventDefault(),this.dragging=!0}},{key:"onDragLeave",value:function(){this.dragging=!1}}]),a}(O["default"]);G([Object(v["b"])({default:!1})],B.prototype,"disabled",void 0),G([Object(v["d"])("fileButtonSelection")],B.prototype,"onFileButtonSelectionChanged",null),B=G([Object(v["a"])({name:"app-files-selection",components:{AppFileInput:M}})],B);var z=B,V=z,H=(a(361),Object(C["a"])(V,I,D,!1,null,null,null));H.options.__file="src/app/shared/components/app-file-upload/app-files-selection.vue";var q,Y=H.exports;(function(e){e[e["SELECTING"]=0]="SELECTING",e[e["UPLOADING"]=10]="UPLOADING",e[e["RETRYING"]=11]="RETRYING",e[e["COMPLETED"]=20]="COMPLETED",e[e["CANCELED"]=21]="CANCELED"})(q||(q={}));var Z=a(97),K=a(45),W=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},J=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.uploaderState=q.SELECTING,e.uploading=!1,e.error=null,e.showErrorAlert=!1,e.showUploadButton=!0,e.cancelLoading=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.registerUploaderEvents();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"hasStateSelecting",get:function(){return this.uploaderState===q.SELECTING}},{key:"hasStateUploading",get:function(){return this.uploaderState===q.UPLOADING}},{key:"hasStateRetrying",get:function(){return this.uploaderState===q.RETRYING}},{key:"hasStateCompleted",get:function(){return this.uploaderState===q.COMPLETED}},{key:"hasStateCanceled",get:function(){return this.uploaderState===q.CANCELED}},{key:"onFilesSelected",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(t){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.uploaderService.fileUploaders=[],!t){e.next=4;break}return e.next=4,this.uploaderService.addFiles(t);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onStartUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.uploaderService.doUpload();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onCancelUploadClick",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(confirm(this.$t("sure-to-cancel-upload").toString())){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.uploaderService.cancelUpload();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"files",get:function(){return this.uploaderService.fileUploaders}},{key:"uploadButtonDisabled",get:function(){return 0===this.files.length||this.uploading}},{key:"disableFilesSelection",get:function(){return this.uploading||!this.showUploadButton}},{key:"errorTrials",get:function(){return this.uploaderService.getTrials()}},{key:"registerUploaderEvents",value:function(){var e=this;this.uploaderService.onStartUpload((function(){e.uploaderState=q.UPLOADING,e.uploading=!0,e.error=null,e.showErrorAlert=!1})),this.uploaderService.onResume((function(){e.uploaderState=q.UPLOADING,e.error=null,e.showErrorAlert=!1})),this.uploaderService.onError((function(t){e.uploaderState=q.RETRYING,e.uploading=!0,e.error=t,e.showErrorAlert=!0})),this.uploaderService.onUploadComplete((function(){e.uploaderState=q.COMPLETED,e.showUploadButton=!e.disableAfterUpload,e.uploading=!1,e.showSuccess(e.$t("upload-completed-successfully").toString(),!1)})),this.uploaderService.onUploadCanceled((function(){e.uploaderState=q.CANCELED,e.showUploadButton=!e.disableAfterUpload,e.uploading=!1,e.error=null,e.showErrorAlert=!1}))}}]),a}(K["a"]);W([Object(v["b"])({required:!0})],J.prototype,"uploaderService",void 0),W([Object(v["b"])()],J.prototype,"title",void 0),W([Object(v["b"])({default:!1})],J.prototype,"disableAfterUpload",void 0),W([Object(Z["a"])()],J.prototype,"onFilesSelected",null),W([Object(Z["a"])()],J.prototype,"onStartUpload",null),W([Object(Z["a"])("cancelLoading")],J.prototype,"onCancelUploadClick",null),J=W([Object(v["a"])({name:"app-uploader",components:{AppFileUploader:E,AppFilesSelection:Y,AppButton:d["a"]}})],J);var Q=J,X=Q,ee=Object(C["a"])(X,b,g,!1,null,null,null);ee.options.__file="src/app/shared/components/app-file-upload/app-uploader.vue";var te,ae=ee.exports,ne=a(59),ie=a(285),se=a(116),re=(a(118),a(76),a(77),a(85),a(42)),le=(a(96),a(75),a(151),a(222),a(221),a(150),a(311)),oe=a(344);a(46),a(54),a(122);(function(e){e["FILE_PROGRESS"]="UPLOAD_FILE_PROGRESS",e["FILE_COMPLETE"]="FILE_COMPLETE",e["FILE_CHUNK_COMPLETE"]="FILE_CHUNK_COMPLETE",e["ERROR"]="UPLOAD_ERROR",e["START_UPLOAD"]="START_UPLOAD",e["UPLOAD_COMPLETE"]="UPLOAD_COMPLETE",e["UPLOAD_CANCELED"]="UPLOAD_CANCELED",e["RESUME_UPLOAD_AFTER_ERROR"]="RESUME_UPLOAD_AFTER_ERROR"})(te||(te={}));var ce=function(){function e(t,a,n){Object(l["a"])(this,e),this.file=t,this.fileName=a,this.chunkSizeInMB=n,this.event=new le["EventEmitter"],this.complete=!1,this.uploadId=null,this.fileId=null,this.missingChunkNumbers=[],this.description=""}return Object(o["a"])(e,[{key:"onProgress",value:function(e){this.event.on(te.FILE_PROGRESS,e)}},{key:"onChunkComplete",value:function(e){this.event.on(te.FILE_CHUNK_COMPLETE,e)}},{key:"onComplete",value:function(e){this.event.on(te.FILE_COMPLETE,e)}},{key:"onError",value:function(e){this.event.on(te.ERROR,e)}},{key:"emitProgress",value:function(e){this.event.emit(te.FILE_PROGRESS,e)}},{key:"emitComplete",value:function(){this.event.emit(te.FILE_COMPLETE)}},{key:"emitError",value:function(){this.event.emit(te.ERROR)}},{key:"emitChunkComplete",value:function(){this.event.emit(te.FILE_CHUNK_COMPLETE)}},{key:"fileUploadCompleted",value:function(){this.complete=!0,this.emitComplete()}},{key:"size",get:function(){return this.file.size}},{key:"upload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){var t,a,n,i,r,l,o=this;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.complete){e.next=3;break}return this.fileUploadCompleted(),e.abrupt("return");case 3:t=1024*this.chunkSizeInMB*1024,a=this.file.size,n=0,i=!1,r=Object(s["a"])().mark((function e(){var r,l,c,u;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=o.getNextChunkNumber(n),!1!==r){e.next=3;break}return e.abrupt("return","break");case 3:return n=r-1,l=n*t,c=r*t,c>=a&&(i=!0,c=a),u=o.file.slice(l,c),e.next=10,re["a"].uploadFileChunk(o.uploadId,u,o.fileId,n+1,(function(e){var i=t/a*n,s=e.loaded/e.total,r=(c-l)/a,u=Math.round(100*(i+s*r));o.emitProgress(u)}));case 10:o.emitChunkComplete(),o.removeChunkNumber(),n++;case 13:case"end":return e.stop()}}),e)}));case 8:if(i){e.next=15;break}return e.delegateYield(r(),"t0",10);case 10:if(l=e.t0,"break"!==l){e.next=13;break}return e.abrupt("break",15);case 13:e.next=8;break;case 15:this.fileUploadCompleted();case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"unregisterEvents",value:function(){this.event.removeAllListeners()}},{key:"getNextChunkNumber",value:function(e){if(this.missingChunkNumbers.length>0){var t=this.missingChunkNumbers[0];if(-1===t){if(t=e+1,t>this.maxChunks)return!1;this.missingChunkNumbers.unshift(t)}return t}return!1}},{key:"removeChunkNumber",value:function(){if(this.missingChunkNumbers.length>0){var e=this.missingChunkNumbers[0];-1!==e&&this.missingChunkNumbers.splice(0,1)}}},{key:"maxChunks",get:function(){var e=1024*this.chunkSizeInMB*1024,t=this.file.size;return Math.ceil(t/e)}}]),e}(),ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(l["a"])(this,e),this.chunkSizeInMB=t,this.event=new le["EventEmitter"],this.fileUploaders=[],this.upload=null,this.trials=0}return Object(o["a"])(e,[{key:"addFiles",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(t){var a,n,i,r,l=this;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,re["a"].getSecuredFilenames(t.map((function(e){return e.name})));case 2:a=e.sent,n=Object(ne["a"])(a);try{for(r=function(){var e=i.value,a=t.find((function(t){return t.name===e.original_name}));if(!a)throw new Error("File mapping error");var n=new ce(a,e.secured_name,l.chunkSizeInMB);n.onChunkComplete((function(){l.emitResume()})),l.fileUploaders.push(n)},n.s();!(i=n.n()).done;)r()}catch(s){n.e(s)}finally{n.f()}case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeFile",value:function(e){var t=this.fileUploaders.findIndex((function(t){return t.fileName===e}));-1!==t&&this.fileUploaders.splice(t,1)}},{key:"onError",value:function(e){this.event.on(te.ERROR,e)}},{key:"onStartUpload",value:function(e){this.event.on(te.START_UPLOAD,e)}},{key:"onResume",value:function(e){this.event.on(te.RESUME_UPLOAD_AFTER_ERROR,e)}},{key:"onUploadComplete",value:function(e){this.event.on(te.UPLOAD_COMPLETE,e)}},{key:"onUploadCanceled",value:function(e){this.event.on(te.UPLOAD_CANCELED,e)}},{key:"getTrials",value:function(){return this.trials}},{key:"emitError",value:function(e){this.event.emit(te.ERROR,e),this.trials+=1}},{key:"emitResume",value:function(){this.trials=0,this.event.emit(te.RESUME_UPLOAD_AFTER_ERROR)}},{key:"emitCancel",value:function(){this.trials=0,this.event.emit(te.UPLOAD_CANCELED)}},{key:"getCreateUploadFiles",value:function(){return this.fileUploaders.map((function(e){return{name:e.fileName,size:e.file.size}}))}},{key:"prepareFileUploaders",value:function(){var e=this;if(!this.upload)throw new Error("Upload is undefined. Missing upload object");var t,a=Object(ne["a"])(this.fileUploaders);try{var n=function(){var a=t.value,n=e.upload.files.find((function(e){return e.name==a.fileName}));if(!n)throw new Error("File mapping error");a.uploadId=e.upload.upload_id,a.fileId=n.id,a.complete=n.complete,a.missingChunkNumbers=n.missing_chunks};for(a.s();!(t=a.n()).done;)n()}catch(i){a.e(i)}finally{a.f()}}},{key:"setUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(t){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=6;break}return e.next=3,re["a"].getUpload(t);case 3:this.upload=e.sent,e.next=7;break;case 6:this.upload=t;case 7:this.prepareFileUploaders();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"startUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){var t,a,n,i,r,l;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.upload){e.next=2;break}throw new Error("No upload created or resumed");case 2:if(0!==this.fileUploaders.length){e.next=4;break}throw new Error("No files to upload");case 4:if(!this.fileUploaders.find((function(e){return!e.fileId}))){e.next=6;break}throw new Error("Files not prepared for upload");case 6:if(t=this.getInvalidUploadFilesSelection(),!(t.missingFiles.length>0||t.unknownFiles.length>0)){e.next=9;break}throw new Error("Missing upload files or unknown upload files for resume upload");case 9:window.onbeforeunload=function(){return!0},this.event.emit(te.START_UPLOAD);case 11:if(void 0===(a=this.fileUploaders.find((function(e){return!e.complete})))){e.next=53;break}return e.prev=12,e.next=15,this.tryUpload(a);case 15:e.next=51;break;case 17:e.prev=17,e.t0=e["catch"](12),n=3;case 20:if(!(n>0)){e.next=35;break}return e.prev=21,e.next=24,this.tryUpload(a);case 24:return e.abrupt("break",35);case 27:return e.prev=27,e.t1=e["catch"](21),n--,i=1e3*Math.abs(n-3),e.next=33,Object(oe["b"])(i);case 33:e.next=20;break;case 35:r=!0;case 36:if(!r||!this.upload){e.next=51;break}return e.prev=37,e.next=40,this.refreshUpload();case 40:r=!1,e.next=49;break;case 43:return e.prev=43,e.t2=e["catch"](37),this.emitError(e.t2),l=this.trials<100?1e4:6e4,e.next=49,Object(oe["b"])(l);case 49:e.next=36;break;case 51:e.next=11;break;case 53:window.onbeforeunload=null;case 54:case"end":return e.stop()}}),e,this,[[12,17],[21,27],[37,43]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancelUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return window.onbeforeunload=null,e.next=3,re["a"].cancelUpload(this.upload.upload_id);case 3:this.reset(),this.emitCancel();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getInvalidUploadFilesSelection",value:function(){var e=this;if(!this.upload)throw new Error("upload is undefined");var t={missingFiles:this.upload.files.filter((function(t){return!e.fileUploaders.find((function(e){return e.fileName===t.name}))})).map((function(e){return e.name})),unknownFiles:this.fileUploaders.filter((function(t){return!e.upload.files.find((function(e){return e.name===t.fileName}))})).map((function(e){return e.fileName}))};return t}},{key:"tryUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(t){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.upload();case 3:this.isUploadComplete()&&(this.event.emit(te.UPLOAD_COMPLETE),this.reset()),e.next=11;break;case 6:throw e.prev=6,e.t0=e["catch"](0),t.emitError(),this.emitError(e.t0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"refreshUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.upload){e.next=2;break}throw new Error("Upload is undefined");case 2:return e.next=4,this.setUpload(this.upload.upload_id);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isUploadComplete",value:function(){return!this.fileUploaders.find((function(e){return!e.complete}))}},{key:"reset",value:function(){this.upload=null;var e,t=Object(ne["a"])(this.fileUploaders);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.unregisterEvents()}}catch(n){t.e(n)}finally{t.f()}this.fileUploaders=[]}}]),e}(),pe=a(119),de=a(295),fe=a(296),he=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(e,n,i){var s;return Object(l["a"])(this,a),s=t.call(this,i),s.plantId=e,s.analysisId=n,s.flownAt=void 0,s.orderProductPackageIds=void 0,s}return Object(o["a"])(a,[{key:"addFiles",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(t){var n,i,r,l,o,c,u,p,d;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ie["a"])(Object(se["a"])(a.prototype),"addFiles",this).call(this,t);case 2:if(this.analysisId){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,re["a"].getAnalysis(this.analysisId);case 6:if(n=e.sent,!n.files){e.next=15;break}for(i=[],r=0,l=Object.keys(n.files);r<l.length;r++)o=l[r],i=i.concat(n.files[o]);return e.next=12,re["a"].getAnalysisFiles(n.id,i);case 12:c=e.sent,u=Object(ne["a"])(this.fileUploaders);try{for(u.s();!(p=u.n()).done;)d=p.value,c[d.fileName]&&(d.description=pe["i18n"].t("file-exists-and-overide").toString())}catch(s){u.e(s)}finally{u.f()}case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"doUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.analysisId){e.next=5;break}if(this.flownAt){e.next=3;break}throw{error:"INVALID_OR_MISSING_PARAMS",message:pe["i18n"].t("missing").toString()+" "+pe["i18n"].t("acquisition-date").toString()};case 3:if(this.plantId){e.next=5;break}throw{error:"INVALID_OR_MISSING_PARAMS",message:pe["i18n"].t("missing").toString()+" "+pe["i18n"].t("plant").toString()};case 5:return e.next=7,this.createAnalysisUpload();case 7:return this.analysisId&&de["a"].emit(this.analysisId,fe["a"].UPDATE_ANALYSIS),e.prev=8,e.next=11,this.startUpload();case 11:return e.prev=11,this.analysisId&&de["a"].emit(this.analysisId,fe["a"].UPDATE_ANALYSIS),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[8,,11,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setFlownAt",value:function(e){this.flownAt=e}},{key:"setAnalysisId",value:function(e){this.analysisId=e}},{key:"setPlantId",value:function(e){this.plantId=e}},{key:"setOrderProductPackageIds",value:function(e){this.orderProductPackageIds=e}},{key:"createAnalysisUpload",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){var t;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.upload){e.next=7;break}return e.next=3,re["a"].createAnalysisUpload({chunk_size_in_mb:this.chunkSizeInMB,files:this.getCreateUploadFiles(),analysis_id:this.analysisId,create_analysis:!this.analysisId&&{flown_at:this.flownAt,plant_id:this.plantId,order_product_package_ids:this.orderProductPackageIds}||void 0});case 3:return t=e.sent,this.analysisId||(this.analysisId=t.analysis_id),e.next=7,this.setUpload(t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(ue),me=a(300),be=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},ge=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.dataComplete=!1,e.hasPlantMetadata=!1,e.uploaderService=null,e.gotoNewAnalysis=null,e.appContentEventId="newAnalysis",e}return Object(o["a"])(a,[{key:"created",value:function(){var e;this.uploaderService=new he(this.plantId||void 0,null===(e=this.analysis)||void 0===e?void 0:e.id),this.dataComplete=!!this.analysis&&this.analysis.data_complete,this.hasPlantMetadata=this.analysis&&this.analysis.has_plant_metadata||!1,this.analysis&&(this.appContentEventId=this.analysis.id),this.registerUploadEvents()}},{key:"onAnalysisChanged",value:function(){this.dataComplete=!!this.analysis&&this.analysis.data_complete,this.hasPlantMetadata=this.analysis&&this.analysis.has_plant_metadata||!1}},{key:"onPlantIdChanged",value:function(){this.plantId&&this.uploaderService.setPlantId(this.plantId)}},{key:"onFlownAtChanged",value:function(){this.flownAt&&this.uploaderService.setFlownAt(this.flownAt)}},{key:"onOrderProductPackageIdsChanged",value:function(){this.orderProductPackageIds&&this.uploaderService.setOrderProductPackageIds(this.orderProductPackageIds)}},{key:"registerUploadEvents",value:function(){var e=this;this.uploaderService.onStartUpload(Object(r["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=e.analysis,t.t0){t.next=5;break}return t.next=4,re["a"].getAnalysis(e.uploaderService.analysisId);case 4:t.t0=t.sent;case 5:a=t.t0,e.hasPlantMetadata=a.has_plant_metadata||!1;case 7:case"end":return t.stop()}}),t)})))),this.uploaderService.onUploadComplete(Object(r["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,re["a"].getAnalysis(e.uploaderService.analysisId);case 2:a=t.sent,a.has_plant_metadata&&a.data_complete&&f["a"].showInfo(e.appContentEventId,e.$t("analysis-with-metdata-data-complete_quest").toString()),e.hasPlantMetadata=a.has_plant_metadata||!1,e.analysis||(e.gotoNewAnalysis=a);case 6:case"end":return t.stop()}}),t)})))),this.uploaderService.onUploadCanceled(Object(r["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.analysis){t.next=4;break}return t.next=3,re["a"].getAnalysis(e.uploaderService.analysisId);case 3:e.gotoNewAnalysis=t.sent;case 4:case"end":return t.stop()}}),t)}))))}},{key:"allowUploadFurtherData",get:function(){return!(this.dataComplete&&this.analysis)}},{key:"dataCompleteVerified",get:function(){return!!(this.analysis&&this.analysis.current_state.state.id>=me["a"].DATA_COMPLETE_VERIFIED)}},{key:"analysisIsEmpty",get:function(){var e;return!(!this.analysis||(null===(e=this.analysis.current_state)||void 0===e?void 0:e.state.id)!=me["a"].EMPTY)}},{key:"analysisHasAvailableDrones",get:function(){return null!=this.droneOptions&&this.droneOptions.length>0}},{key:"analysisHasSelectedDrone",get:function(){return null!=this.selectedDrone&&null!=this.selectedDrone.id}},{key:"onChangeDataComplete",value:function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(){var t;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,re["a"].getAnalysis(this.uploaderService.analysisId);case 2:if(t=e.sent,t.plant.in_setup_phase||!this.dataComplete){e.next=7;break}if(confirm(this.$t("data-complete-sure-quest").toString())){e.next=7;break}return this.dataComplete=!1,e.abrupt("return");case 7:return e.next=9,re["a"].updateAnalysis(t.id,{data_complete:this.dataComplete});case 9:de["a"].emit(t.id,fe["a"].UPDATE_ANALYSIS);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onGotoNewAnalysisClick",value:function(){this.$router.push({name:"EditAnalysis",params:{id:this.gotoNewAnalysis.id}})}}]),a}(K["a"]);be([Object(v["b"])({default:null})],ge.prototype,"plantId",void 0),be([Object(v["b"])({default:null})],ge.prototype,"flownAt",void 0),be([Object(v["b"])({default:null})],ge.prototype,"analysis",void 0),be([Object(v["b"])({default:null})],ge.prototype,"orderProductPackageIds",void 0),be([Object(v["b"])({default:null})],ge.prototype,"selectedDrone",void 0),be([Object(v["b"])({default:null})],ge.prototype,"droneOptions",void 0),be([Object(v["d"])("analysis")],ge.prototype,"onAnalysisChanged",null),be([Object(v["d"])("plantId")],ge.prototype,"onPlantIdChanged",null),be([Object(v["d"])("flownAt")],ge.prototype,"onFlownAtChanged",null),be([Object(v["d"])("orderProductPackageIds")],ge.prototype,"onOrderProductPackageIdsChanged",null),be([Object(Z["a"])()],ge.prototype,"onChangeDataComplete",null),be([Object(Z["a"])()],ge.prototype,"onGotoNewAnalysisClick",null),ge=be([Object(v["a"])({name:"app-analysis-uploader",components:{AppContent:h["a"],AppUploader:ae,AppButton:d["a"],AppExplanation:m["a"]}})],ge);var ve=ge,ye=ve,_e=Object(C["a"])(ye,n,i,!1,null,null,null);_e.options.__file="src/app/analysis/shared/analysis-uploader.vue";t["a"]=_e.exports},393:function(e,t,a){},403:function(e,t,a){},404:function(e,t,a){},405:function(e,t,a){},406:function(e,t,a){},504:function(e,t,a){"use strict";a(393)},505:function(e,t,a){"use strict";a(403)},506:function(e,t,a){"use strict";a(404)},507:function(e,t,a){"use strict";a(405)},508:function(e,t,a){"use strict";a(406)},573:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.analysis?a("app-content",{attrs:{title:e.analysis.name||"",eventId:e.analysis.id,navbackPath:"/analyses"},scopedSlots:e._u([{key:"subtitle",fn:function(){return[a("div",{staticClass:"mar-top"},[a("app-step-progress",{attrs:{steps:e.analysisProgressSteps}})],1)]},proxy:!0}],null,!1,2214528238)},[a("div",{staticClass:"app-edit-analysis"},[a("b-tabs",{model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[a("b-tab",{staticClass:"app-edit-analysis-download-tab",attrs:{href:"#download"},scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"download"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("download")))])]},proxy:!0}],null,!1,1288288109)},[a("app-download-analysis-files",{attrs:{analysis:e.analysis}})],1),a("b-tab",{staticClass:"app-edit-analysis-upload-tab",attrs:{href:"#upload"},scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"upload"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("upload")))])]},proxy:!0}],null,!1,3987617677)},[e.isStateNotNull?a("app-upload-analysis-files",{attrs:{analysis:e.analysis,droneOptions:e.droneOptions,selectedDrone:e.selectedDrone}}):e._e()],1),a("b-tab",{staticClass:"app-edit-analysis-edit-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"pencil-square"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("edit")))])]},proxy:!0}],null,!1,725662720)},[a("b-row",[a("b-col",{attrs:{sm:""}},[a("app-box",{attrs:{title:e.$t("edit-analysis")}},[a("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmitEditAnalysis(t)}}},[a("b-form-group",{attrs:{label:e.$t("acquisition-date"),"label-cols-sm":"4","label-cols-lg":"2"}},[a("app-datepicker",{attrs:{required:""},model:{value:e.flownAt,callback:function(t){e.flownAt=t},expression:"flownAt"}})],1),a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:!e.changeProductPackagesAndDroneAllowed,expression:"!changeProductPackagesAndDroneAllowed"}],attrs:{"label-cols-sm":"4","label-cols-lg":"2"},scopedSlots:e._u([{key:"label",fn:function(){},proxy:!0}],null,!1,522070287)},[a("b-alert",{staticClass:"edit-analysis-info",attrs:{show:!e.changeProductPackagesAndDroneAllowed&&!e.isSuperAdmin,variant:"info"}},[e._v(" "+e._s(e.$t("can-only-change-pp-drone-before-data-complete"))+" ")]),a("b-alert",{staticClass:"edit-analysis-info",attrs:{show:!e.changeProductPackagesAndDroneAllowed&&e.isSuperAdmin,variant:"info"}},[e._v(" "+e._s(e.$t("can-only-change-pp-drone-before-data-complete-super-admin"))+" ")])],1),a("b-form-group",{attrs:{"label-cols-sm":"4","label-cols-lg":"2"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" "+e._s(e.$t("product-packages"))+" "),e.isSuperAdmin&&!e.changeProductPackagesAndDroneAllowed?a("app-super-admin-marker"):e._e()]},proxy:!0}],null,!1,4203300502)},[a("app-multiselect",{attrs:{options:e.productPackagesSelection,readonly:!(e.isSuperAdmin||e.changeProductPackagesAndDroneAllowed)},model:{value:e.selectedProductPackageIds,callback:function(t){e.selectedProductPackageIds=t},expression:"selectedProductPackageIds"}})],1),a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.isSelectedDroneUnavailable,expression:"isSelectedDroneUnavailable"}],attrs:{"label-cols-sm":"4","label-cols-lg":"2"}},[a("b-alert",{staticClass:"edit-analysis-info",attrs:{show:e.isSelectedDroneUnavailable&&e.isSuperAdmin,variant:"info"}},[e._v(" "+e._s(e.$t("previously-selected-drone-not-available"))+" ")])],1),a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.noDroneAvailable,expression:"noDroneAvailable"}],attrs:{"label-cols-sm":"4","label-cols-lg":"2"}},[a("b-alert",{staticClass:"edit-analysis-info",attrs:{show:e.noDroneAvailable,variant:"info"}},[e._v(" "+e._s(e.$t("no-drone-available-for-customer-plant"))+" ")])],1),a("b-form-group",{attrs:{"label-cols-sm":"4","label-cols-lg":"2"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" "+e._s(e.$t("drone"))+" "),e.isSuperAdmin&&!e.changeProductPackagesAndDroneAllowed?a("app-super-admin-marker"):e._e()]},proxy:!0}],null,!1,664292587)},[a("b-form-select",{attrs:{options:e.droneOptions,disabled:!(e.isSuperAdmin||e.changeProductPackagesAndDroneAllowed)||e.isSelectedDroneUnavailable||e.noDroneAvailable},model:{value:e.selectedDroneId,callback:function(t){e.selectedDroneId=t},expression:"selectedDroneId"}})],1),e.isSuperAdmin?a("b-form-group",{attrs:{"label-cols-sm":"4","label-cols-lg":"2"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" "+e._s(e.$t("add-pis"))+" "),a("app-super-admin-marker")]},proxy:!0}],null,!1,4209237872)},[a("app-multiselect",{attrs:{options:e.keyFiguresSelection},model:{value:e.selectedKeyFigureIds,callback:function(t){e.selectedKeyFigureIds=t},expression:"selectedKeyFigureIds"}})],1):e._e(),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("apply")))])],1)],1)],1)],1)],1),a("b-tab",{staticClass:"app-edit-analysis-flights-tab",attrs:{lazy:""},scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"calendar-range"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("flights")))])]},proxy:!0}],null,!1,3922638310)},[a("app-analysis-flight-campaigns",{attrs:{analysis:e.analysis}})],1),e.hasReferenceMeasurements?a("b-tab",{staticClass:"app-edit-analysis-ref-measures",attrs:{lazy:""},scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"clipboard-check"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("reference-measurements")))]),a("app-super-admin-marker")]},proxy:!0}],null,!1,1903157060)},[a("app-analysis-reference-measurements",{attrs:{analysis:e.analysis}})],1):e._e(),e.isSuperAdmin?a("b-tab",{staticClass:"app-edit-analysis-admin-tab",attrs:{lazy:""},scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"shield-shaded"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("admin-panel")))])]},proxy:!0}],null,!1,3957700052)},[a("app-edit-analysis-admin",{attrs:{analysis:e.analysis}})],1):e._e()],1)],1)]):e._e()},i=[];n._withStripped=!0;var s=a(49),r=a(6),l=a(9),o=a(18),c=a(19),u=a(23),p=a(22),d=a(27),f=(a(44),a(24),a(222),a(83),a(75),a(120),a(154),a(96),a(150),a(76),a(151),a(15)),h=a(45),m=a(60),b=a(42),g=a(100),v=a(63),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-button",{attrs:{disabled:e.isDownloadButtonDisabled,loading:e.downloadButtonLoading},on:{click:e.onDownloadSelectedFilesClick}},[e._v(" "+e._s(e.$t("download-selected-files"))+" ")]),e.isSuperAdmin?a("app-button",{attrs:{cls:"mar-left",variant:"secondary",disabled:e.isDownloadButtonDisabled,superAdminProtected:!0},on:{click:e.onMoveSelectedFilesClick}},[e._v(" "+e._s(e.$t("move-selected-files"))+" ")]):e._e(),e.isSuperAdmin?a("app-button",{attrs:{cls:"mar-left",variant:"outline-danger",disabled:e.isDownloadButtonDisabled,loading:e.deleteSelectedFilesLoading,superAdminProtected:!0},on:{click:e.onDeleteSelectedFilesClick}},[e._v(" "+e._s(e.$t("delete-selected-files"))+" ")]):e._e(),a("span",{directives:[{name:"show",rawName:"v-show",value:e.selectedDonwloadFiles.length>0,expression:"selectedDonwloadFiles.length > 0"}],staticClass:"mar-left"},[e._v(" "+e._s(e.$t("selected-files"))+": "+e._s(e.selectedDonwloadFiles.length)+" ")]),a("app-table-container",[a("app-table",{attrs:{rows:e.downloadFilesTableItems,columns:e.downloadFilesTableColumns,loading:e.isFilesLoading,selectMode:"range",selectAllColumns:!0,emptyText:e.$t("no-files-uploaded")},on:{rowSelected:e.onDownloadFilesSelected},scopedSlots:e._u([{key:"cell(size)",fn:function(t){return[e._v(" "+e._s(t.item.readableSize)+" ")]}},{key:"cell(uploadedAt)",fn:function(t){return[e._v(" "+e._s(e.getReadableDate(t.item.uploadedAt))+" ")]}}])})],1),a("app-modal-form",{ref:"moveSelectedFilesModal",attrs:{id:"moveSelectedFilesModal",modalLoading:e.moveSelectedFilesLoading,okTitle:e.$t("move"),"cancel-title":e.$t("cancel"),title:e.$t("move-selected-files"),superAdminProtected:!0},on:{submit:e.onMoveSelectedFiles}},[a("b-form-group",{attrs:{label:e.$t("select-analysis")}},[a("b-form-select",{attrs:{options:e.moveAnalysisSelection,required:""},model:{value:e.targetAnalysisId,callback:function(t){e.targetAnalysisId=t},expression:"targetAnalysisId"}})],1)],1)],1)},_=[];y._withStripped=!0;var O=a(59),w=(a(118),a(223),a(156),a(289),a(287)),k=a(284),S=a(160),A=a(319),j=a(300),C=a(123),x=a(152),E=a(153),I=a(295),D=a(296),F=a(97),P=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},R=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.isDownloadButtonDisabled=!0,e.downloadButtonLoading=!1,e.downloadFilesTableColumns=[{key:"name",label:e.$t("name").toString(),sortable:!0},{key:"size",label:e.$t("size").toString(),sortable:!0},{key:"uploadedAt",label:e.$t("uploaded-at").toString(),sortable:!0}],e.downloadFilesTableItems=[],e.selectedDonwloadFiles=[],e.isFilesLoading=!1,e.moveSelectedFilesLoading=!1,e.targetAnalysisId=null,e.moveAnalysisSelection=[],e.deleteSelectedFilesLoading=!1,e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadFiles();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onAnalysisChanged",value:function(){this.loadFiles()}},{key:"onDownloadFilesSelected",value:function(e){this.selectedDonwloadFiles=e,this.isDownloadButtonDisabled=0===this.selectedDonwloadFiles.length}},{key:"onDownloadSelectedFilesClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!==this.selectedDonwloadFiles.length){e.next=7;break}return e.next=3,b["a"].getAnalysisFileDownloadUrl(this.analysis.id,this.selectedDonwloadFiles[0].name);case 3:t=e.sent,S["a"].download(t.url,this.selectedDonwloadFiles[0].name),e.next=13;break;case 7:return a="analysis-".concat(this.analysis.name,"-selected-files.zip"),n=this.downloadFilesTableItems.length===this.selectedDonwloadFiles.length?"all":this.selectedDonwloadFiles.map((function(e){return e.name})),e.next=11,b["a"].generateDownloadUrl(b["a"].downloadMultipleAnalysisFilesUrl(this.analysis.id,n));case 11:i=e.sent,S["a"].download(i,a);case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getReadableDate",value:function(e){return e&&x["a"].toDateTime(e)||""}},{key:"onMoveSelectedFilesClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getAllAnalysis({plant_id:this.analysis.plant.id});case 2:this.moveAnalysisSelection=e.sent.filter((function(e){return e.id!==t.analysis.id})).map((function(e){return{value:e.id,text:e.name}})),this.moveSelectedFilesModal.show();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onMoveSelectedFiles",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].moveAnalysisFiles(this.analysis.id,this.targetAnalysisId,this.selectedDonwloadFiles.map((function(e){return e.name})));case 2:this.moveSelectedFilesModal.hide(),this.showSuccess(this.$t("selected-files-moved-success").toString()),I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeleteSelectedFilesClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(confirm(this.$t("delete-selected-files-sure").toString())){e.next=2;break}return e.abrupt("return");case 2:return this.deleteSelectedFilesLoading=!0,e.next=5,b["a"].deleteAnalysisFiles(this.analysis.id,this.selectedDonwloadFiles.map((function(e){return e.name})));case 5:this.showSuccess(this.$t("selected-files-deleted-success").toString()),I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadFiles",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n,i,s,l,o,c,u,p,d,f,h,m,g,v,y;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],this.downloadFilesTableItems=[],this.analysis.files){e.next=4;break}return e.abrupt("return");case 4:for(i=0,s=Object.keys(this.analysis.files);i<s.length;i++)l=s[i],n=n.concat(this.analysis.files[l]);return this.downloadFilesTableItems=[],e.next=8,b["a"].getAnalysisFiles(this.analysis.id,n);case 8:for(o=e.sent,c=0,u=Object.keys(o);c<u.length;c++)p=u[c],d=o[p],d?this.downloadFilesTableItems.push({name:p,size:d.size,readableSize:Object(A["a"])(d.size),uploadedAt:Date.parse(d.uploaded_at)}):this.downloadFilesTableItems.push({name:p,size:null,readableSize:null,uploadedAt:null});if(this.downloadFilesTableItems.sort((function(e,t){var a=e.uploadedAt||1,n=t.uploadedAt||1;return a<n?1:a>n?-1:0})),(null===(t=this.analysis.current_state)||void 0===t||null===(a=t.state)||void 0===a?void 0:a.id)!==j["a"].UPLOADING){e.next=21;break}return e.next=14,b["a"].getUploadingUsers(this.analysis.id);case 14:if(f=e.sent,!(f.length>0)){e.next=21;break}return e.next=18,b["a"].getMe();case 18:if(h=e.sent,f=f.filter((function(e){return e.email!=h.email})),f.length>0){m=[],g=Object(O["a"])(f);try{for(g.s();!(v=g.n()).done;)y=v.value,m.push(this.$t("user-is-uploading",{user:((y.first_name||"")+" "+(y.last_name||"")).trim()||y.email}).toString())}catch(r){g.e(r)}finally{g.f()}m.push(this.$t("files-of-files-uploaded",{current_files:Object.keys(o).filter((function(e){return!!o[e]})).length,max_files:Object.keys(o).length}).toString()),C["a"].showInfo(this.analysis.id,m.join("<br>"))}case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);P([Object(f["b"])({required:!0})],R.prototype,"analysis",void 0),P([Object(f["c"])()],R.prototype,"moveSelectedFilesModal",void 0),P([Object(f["d"])("analysis")],R.prototype,"onAnalysisChanged",null),P([Object(F["a"])("downloadButtonLoading")],R.prototype,"onDownloadSelectedFilesClick",null),P([Object(F["a"])()],R.prototype,"onMoveSelectedFilesClick",null),P([Object(F["a"])("moveSelectedFilesLoading")],R.prototype,"onMoveSelectedFiles",null),P([Object(F["a"])("deleteSelectedFilesLoading")],R.prototype,"onDeleteSelectedFilesClick",null),P([Object(F["a"])("isFilesLoading")],R.prototype,"loadFiles",null),R=P([Object(f["a"])({name:"app-download-analysis-files",components:{AppTableContainer:w["a"],AppButton:v["a"],AppModalForm:E["a"],AppTable:k["a"]}})],R);var T=R,N=T,U=a(28),$=Object(U["a"])(N,y,_,!1,null,null,null);$.options.__file="src/app/analysis/edit-analysis/download-analysis-files.vue";var L=$.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-row",[a("b-col",{attrs:{cols:"12",lg:"6"}},[a("app-update-analysis-state",{attrs:{analysis:e.analysis}})],1),a("b-col",{attrs:{cols:"12",lg:"6"}},[a("app-import-analysis-result",{attrs:{analysis:e.analysis}})],1),a("b-col",{attrs:{cols:"12",lg:"6"}},[a("app-analysis-notes-and-history",{attrs:{analysis:e.analysis}})],1),a("b-col",{attrs:{cols:"12",lg:"6"}},[a("app-analysis-file-actions",{attrs:{analysis:e.analysis}}),a("app-delete-analysis",{attrs:{analysis:e.analysis}})],1)],1)],1)},G=[];M._withStripped=!0;var B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{scopedSlots:e._u([{key:"title",fn:function(){return[a("h4",{staticStyle:{"margin-bottom":"1em"}},[e._v(" "+e._s(e.$t("update-analysis-state"))+" ")])]},proxy:!0}])},[e.analysis.plant.in_setup_phase?e._e():a("b-alert",{attrs:{variant:"warning",show:""}},[a("span",{domProps:{innerHTML:e._s(e.$t("attention-state-update-starts-evaulation_expl"))}})]),a("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmitUpdateState(t)}}},[a("b-form-group",[a("b-form-checkbox",{model:{value:e.sendNotification,callback:function(t){e.sendNotification=t},expression:"sendNotification"}},[e._v(" "+e._s(e.$t("send-notification"))+" ")])],1),a("b-form-group",{attrs:{label:e.$t("select-new-analysis-state")}},[a("b-form-select",{attrs:{required:"",options:e.updateStateOptions},model:{value:e.selectedUpdateState,callback:function(t){e.selectedUpdateState=t},expression:"selectedUpdateState"}})],1),a("b-form-group",{attrs:{label:e.$t("message")}},[a("b-form-textarea",{attrs:{placeholder:e.$t("message"),row:"5"},model:{value:e.selectedUpdateStateMessage,callback:function(t){e.selectedUpdateStateMessage=t},expression:"selectedUpdateStateMessage"}})],1),a("app-button",{attrs:{type:"submit",loading:e.loading}},[e._v(e._s(e.$t("update")))])],1)],1)},z=[];B._withStripped=!0;var V=a(290),H=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},q=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.selectedUpdateState=null,e.updateStateOptions=null,e.selectedUpdateStateMessage="",e.sendNotification=!1,e.analysisStates=null,e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysisStates();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onUpdateAnalysis",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysisStates();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateAnalysisStates",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,null!==this.analysisStates){e.next=5;break}return e.next=4,b["a"].getStates();case 4:this.analysisStates=e.sent;case 5:this.setUpdateStateOptions(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSubmitUpdateState",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.loading=!0,this.selectedUpdateState){e.next=4;break}throw{error:"NO_STATE_SELECTED",message:"Please, selecte a state"};case 4:return e.next=6,b["a"].updateAnalysisState(this.analysis.id,{state_id:this.selectedUpdateState,message:this.selectedUpdateStateMessage,do_send_mail:this.sendNotification,force:!0});case 6:I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS),this.showSuccess(this.$t("update-analysis-state-success").toString()),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.showError(e.t0);case 13:return e.prev=13,this.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setUpdateStateOptions",value:function(){var e=this;if(this.analysis.current_state){var t=this.analysisStates[this.analysis.current_state.state.id];0!==t.length?this.updateStateOptions=t.map((function(t){return{value:t,text:e.$t(j["b"][t]).toString()}})):this.updateStateOptions=[]}else this.updateStateOptions=[]}}]),a}(h["a"]);H([Object(f["b"])({required:!0})],q.prototype,"analysis",void 0),H([Object(f["d"])("analysis")],q.prototype,"onUpdateAnalysis",null),q=H([Object(f["a"])({name:"app-update-analysis-state",components:{AppButton:v["a"],AppBox:V["a"]}})],q);var Y=q,Z=Y,K=Object(U["a"])(Z,B,z,!1,null,null,null);K.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/update-analysis-state.vue";var W=K.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{attrs:{title:e.$t("manage-result-files")}},[a("b-alert",{attrs:{variant:"info"},model:{value:e.showAlertInfo,callback:function(t){e.showAlertInfo=t},expression:"showAlertInfo"}},[e._v(" "+e._s(e.$t("import-task-running-on-qfly-server"))+" ")]),a("b-form",{on:{submit:function(t){return t.preventDefault(),e.saveManageResultFiles(t)}}},[a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.analysis.analysis_result,expression:"analysis.analysis_result"}],attrs:{label:e.$t("download-existing-result-files")}},e._l(e.importedResultFiles,(function(t){return a("a",{key:t.id,attrs:{href:"#"},on:{click:function(a){return e.onResultFileClick(t)}}},[e._v(" "+e._s(t.filename)+" ")])})),0),a("b-form-group",{directives:[{name:"show",rawName:"v-show",value:e.analysis.analysis_result,expression:"analysis.analysis_result"}]},[a("b-alert",{attrs:{show:e.isAnalysisResultReleased,variant:"info"}},[e._v(" "+e._s(e.$t("remove-result-files-not-allowed_descr"))+" ")]),a("b-form-checkbox",{attrs:{id:"removeAllAnalysisResultFiles",disabled:e.isAnalysisResultReleased},model:{value:e.removeAllAnalysisResultFiles,callback:function(t){e.removeAllAnalysisResultFiles=t},expression:"removeAllAnalysisResultFiles"}},[e._v(" "+e._s(e.$t("remove-result-files"))+" ")])],1),a("b-form-group",{attrs:{label:e.$t("select-json-result-file-import")}},[a("b-form-file",{attrs:{accept:".json"},model:{value:e.jsonFile,callback:function(t){e.jsonFile=t},expression:"jsonFile"}})],1),a("b-form-group",{attrs:{label:e.$t("select-result-image-files-zip")}},[a("app-simple-file-upload",{attrs:{uploadProgress:e.uploadProgress,accept:".zip"},model:{value:e.imageFilesZip,callback:function(t){e.imageFilesZip=t},expression:"imageFilesZip"}})],1),a("b-alert",{attrs:{show:!e.hasStateCompleteVerified,variant:"info"}},[e._v(" "+e._s(e.$t("import-result-files-not-allowed_descr"))+" ")]),a("app-button",{attrs:{type:"submit",loading:e.loading,disabled:e.applyButtonDisabled}},[e._v(e._s(e.$t("apply")))])],1)],1)},Q=[];J._withStripped=!0;var X=a(364),ee=a(346),te=a(343),ae=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},ne=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.importedResultFiles=[],e.removeAllAnalysisResultFiles=!1,e.jsonFile=null,e.imageFilesZip=null,e.uploadProgress=null,e.showAlertInfo=!1,e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.setManageImportFiles();case 2:I["a"].on(this.analysis.id,D["a"].RUN_ANALYSIS_TASK,(function(e){e.name===X["a"].import_analysis_results&&(t.loading=!0)})),I["a"].on(this.analysis.id,D["a"].FINISHED_ANALYSIS_TASK,(function(e){e.name===X["a"].import_analysis_results&&(t.loading=!1,"SUCCESSFUL"===e.state&&t.successfullyFinished())})),I["a"].on(this.analysis.id,D["a"].QFLY_SERVER_STATE_CHANGED,(function(e){t.showAlertInfo=e===ee["b"].RUNNING}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onUpdateAnalysis",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.setManageImportFiles();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onResultFileClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b["a"].getAnalysisResultFileUrl(t.id);case 3:a=e.sent,S["a"].download(a.url,t.filename),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.showError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"applyButtonDisabled",get:function(){return!this.hasStateCompleteVerified||this.isAnalysisResultReleased||!this.jsonFile&&!this.removeAllAnalysisResultFiles}},{key:"hasStateCompleteVerified",get:function(){return this.analysis.current_state&&this.analysis.current_state.state.id>=j["a"].DATA_COMPLETE_VERIFIED||!1}},{key:"isAnalysisResultReleased",get:function(){var e;return(null===(e=this.analysis.analysis_result)||void 0===e?void 0:e.released)||!1}},{key:"setManageImportFiles",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.analysis.analysis_result){e.next=4;break}return e.next=3,b["a"].getAnalysisResultFiles(this.analysis.analysis_result.id);case 3:this.importedResultFiles=e.sent;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveManageResultFiles",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.loading=!0,!this.analysis.analysis_result||!this.removeAllAnalysisResultFiles){e.next=5;break}return e.next=5,b["a"].deleteAnalysisResult(this.analysis.analysis_result.id);case 5:if(!this.jsonFile){e.next=15;break}return C["a"].showInfo(this.analysis.id,"Uploading result file..."),e.next=9,b["a"].importAnalysisResult(this.jsonFile,this.analysis.id,null===(t=this.imageFilesZip)||void 0===t?void 0:t.name);case 9:if(I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS),!this.imageFilesZip){e.next=13;break}return e.next=13,b["a"].uploadImportAnalysisResultImageFiles(this.analysis.id,this.imageFilesZip,(function(e){a.uploadProgress={total:e.total,loaded:e.loaded}}));case 13:e.next=16;break;case 15:this.successfullyFinished();case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](0),this.showError(e.t0),this.loading=!1;case 22:return e.prev=22,this.uploadProgress=null,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[0,18,22,25]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"successfullyFinished",value:function(){this.showSuccess(this.$t("success-managing-result-files").toString()),this.loading=!1,I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS)}}]),a}(h["a"]);ae([Object(f["b"])({required:!0})],ne.prototype,"analysis",void 0),ae([Object(f["d"])("analysis")],ne.prototype,"onUpdateAnalysis",null),ne=ae([Object(f["a"])({name:"app-import-analysis-result",components:{AppButton:v["a"],AppBox:V["a"],AppSimpleFileUpload:te["a"]}})],ne);var ie=ne,se=ie,re=Object(U["a"])(se,J,Q,!1,null,null,null);re.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/import-analysis-result.vue";var le=re.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{attrs:{title:e.$t("danger-zone")}},[a("app-button",{attrs:{type:"button",variant:"danger",loading:e.finishTaskLoading,disabled:!e.analysis.task_id},on:{click:e.onFinishTaskClick}},[e._v(" "+e._s(e.$t("finish-running-task"))+" ")]),a("hr"),a("app-button",{attrs:{type:"button",variant:"danger",loading:e.loading},on:{click:e.onDeleteAnalysisClick}},[e._v(" "+e._s(e.$t("delete"))+" ")])],1)},ce=[];oe._withStripped=!0;var ue=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},pe=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.finishTaskLoading=!1,e}return Object(c["a"])(a,[{key:"onDeleteAnalysisClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!confirm("Delete analysis and all according files? This cannot be undone.")){e.next=6;break}return this.loading=!0,e.next=5,b["a"].deleteAnalysis(this.analysis.id);case 5:this.$router.push({name:"Analyses"});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.showError(e.t0);case 11:return e.prev=11,this.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFinishTaskClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.finishTaskLoading=!0,e.prev=1,e.next=4,b["a"].finishRunningTask(this.analysis.id);case 4:I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS),this.showSuccess(this.$t("successfully-finished-running-task").toString()),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),this.showError(e.t0);case 11:return e.prev=11,this.finishTaskLoading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);ue([Object(f["b"])({required:!0})],pe.prototype,"analysis",void 0),pe=ue([Object(f["a"])({name:"app-delete-analysis",components:{AppButton:v["a"],AppBox:V["a"]}})],pe);var de=pe,fe=de,he=Object(U["a"])(fe,oe,ce,!1,null,null,null);he.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/delete-analysis.vue";var me=he.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{attrs:{title:e.$t("analysis-file-actions")}},[a("app-button",{attrs:{type:"button",loading:e.plantCoverageLoading},on:{click:e.onPlantCoverageClick}},[e._v(" "+e._s(e.$t("check-drone-plant-coverage"))+" ")])],1)},ge=[];be._withStripped=!0;var ve=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},ye=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.plantCoverageLoading=!1,e}return Object(c["a"])(a,[{key:"onPlantCoverageClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.plantCoverageLoading=!0,null===(t=this.analysis)||void 0===t||!t.id){e.next=7;break}return e.next=4,b["a"].getDronePlantCoverage(null===(a=this.analysis)||void 0===a?void 0:a.id);case 4:n=e.sent,console.log(n),this.showSuccess(this.$t("successfully-checked-drone-coverage").toString());case 7:this.plantCoverageLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);ve([Object(f["b"])({required:!0})],ye.prototype,"analysis",void 0),ve([Object(F["a"])("plantCoverageLoading")],ye.prototype,"onPlantCoverageClick",null),ye=ve([Object(f["a"])({name:"app-analysis-file-actions",components:{AppButton:v["a"],AppBox:V["a"]}})],ye);var _e=ye,Oe=_e,we=Object(U["a"])(Oe,be,ge,!1,null,null,null);we.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/analysis-file-actions.vue";var ke=we.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-box",{staticClass:"app-analysis-notes-and-history",attrs:{title:e.$t("notes-and-history")}},[a("div",{staticClass:"notes-container font-xs mar-bottom",domProps:{innerHTML:e._s(e.notesAndHistory)}}),a("b-form-group",{attrs:{label:e.$t("note")}},[a("b-textarea",{model:{value:e.note,callback:function(t){e.note=t},expression:"note"}})],1),a("app-button",{attrs:{type:"button",loading:e.loading,disabled:e.isAppendNoteButtonDisabled},on:{click:e.onAppendNoteClick}},[e._v(" "+e._s(e.$t("append-note"))+" ")])],1)},Ae=[];Se._withStripped=!0;a(98),a(227),a(320);var je=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Ce=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.notesAndHistory="",e.note=null,e.loading=!1,e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return I["a"].on(this.analysis.id,D["a"].UPDATE_ANALYSIS,Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.updateNotesAndHistory();case 2:case"end":return e.stop()}}),e)})))),e.next=3,this.updateNotesAndHistory();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isAppendNoteButtonDisabled",get:function(){return null===this.note||""===this.note.trim()}},{key:"onAppendNoteClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.note){e.next=2;break}throw{error:"EMPTY_NOTE",message:"Please type a note"};case 2:if(confirm(this.$t("add-analysis-note-are-you-sure").toString())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,b["a"].appendAnalysisNote(this.analysis.id,this.note);case 6:return e.next=8,this.updateNotesAndHistory();case 8:this.note=null;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateNotesAndHistory",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getAnalysisNotesAndHistory(this.analysis.id);case 2:t=e.sent.notes_and_history,t=t.replace(/(\\n|\n)/g,"<br>"),a=Object(O["a"])(t.match(/([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2} \| NOTE \|[^<]*)/g)||[]);try{for(a.s();!(n=a.n()).done;)i=n.value,t=t.replace(i,"<b>".concat(i,"</b>"))}catch(s){a.e(s)}finally{a.f()}this.notesAndHistory=t;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);je([Object(f["b"])({required:!0})],Ce.prototype,"analysis",void 0),je([Object(F["a"])()],Ce.prototype,"created",null),je([Object(F["a"])("loading")],Ce.prototype,"onAppendNoteClick",null),Ce=je([Object(f["a"])({name:"app-analysis-notes-and-history",components:{AppButton:v["a"],AppBox:V["a"]}})],Ce);var xe=Ce,Ee=xe,Ie=(a(504),Object(U["a"])(Ee,Se,Ae,!1,null,null,null));Ie.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/analysis-notes-and-history.vue";var De=Ie.exports,Fe=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Pe=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(c["a"])(a)}(h["a"]);Fe([Object(f["b"])({required:!0})],Pe.prototype,"analysis",void 0),Pe=Fe([Object(f["a"])({name:"app-edit-analysis-result-admin",components:{AppUpdateAnalysisState:W,AppImportAnalysisResult:le,AppDeleteAnalysis:me,AppAnalysisFileActions:ke,AppAnalysisNotesAndHistory:De}})],Pe);var Re=Pe,Te=Re,Ne=Object(U["a"])(Te,M,G,!1,null,null,null);Ne.options.__file="src/app/analysis/edit-analysis/edit-analysis-admin/edit-analysis-admin.vue";var Ue=Ne.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-alert",{attrs:{show:!e.uploadAllowed,variant:"info"}},[e._v(" "+e._s(e.$t("upload-not-allowed_descr"))+" ")]),e.uploadAllowed?a("app-analysis-uploader",{attrs:{analysis:e.analysis,droneOptions:e.droneOptions,selectedDrone:e.selectedDrone}}):e._e()],1)},Le=[];$e._withStripped=!0;var Me=a(379),Ge=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Be=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(c["a"])(a,[{key:"uploadAllowed",get:function(){return this.analysis&&this.analysis.current_state.state.id<j["a"].DATA_COMPLETE_VERIFIED||!1}}]),a}(h["a"]);Ge([Object(f["b"])({required:!0})],Be.prototype,"analysis",void 0),Ge([Object(f["b"])({default:null})],Be.prototype,"selectedDrone",void 0),Ge([Object(f["b"])({default:[]})],Be.prototype,"droneOptions",void 0),Be=Ge([Object(f["a"])({name:"app-upload-analysis-files",components:{AppAnalysisUploader:Me["a"]}})],Be);var ze=Be,Ve=ze,He=Object(U["a"])(Ve,$e,Le,!1,null,null,null);He.options.__file="src/app/analysis/edit-analysis/upload-analysis-files.vue";var qe=He.exports,Ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{icon:"arrow-right-circle-fill",variant:"secondary",loading:e.loading,cls:"mar-top pull-right"},on:{click:e.onMoveClick}},[e._v(" "+e._s(e.$t("move-to-another-analysis"))+" ")]),a("div",{staticClass:"clear"}),a("app-reference-measurement-values",{ref:"appReferenceMeasurementValues",attrs:{analysis:e.analysis}}),a("app-modal-form",{ref:"moveModal",attrs:{id:"move-modal",title:e.$t("move-to-another-analysis"),"ok-title":e.$t("move"),"cancel-title":e.$t("cancel"),modalLoading:e.moveModalLoading},on:{submit:e.onMove}},[a("b-form-group",{attrs:{label:e.$t("select-analysis")}},[a("b-form-select",{attrs:{options:e.moveToAnalyses,required:""},model:{value:e.moveTargetAnalysisId,callback:function(t){e.moveTargetAnalysisId=t},expression:"moveTargetAnalysisId"}})],1)],1)],1)},Ze=[];Ye._withStripped=!0;var Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-reference-measurement-values"},[a("app-table-container",[a("app-table",{attrs:{rows:e.refMeasureValueItems,columns:e.refMeasureValueColumns,loading:e.loading,hoverActions:!0},scopedSlots:e._u([{key:"cell(values)",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(t.item.values)}})]}},{key:"hoverActions",fn:function(t){return[a("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:t.item.ignored?e.$t("ignore-value-undo"):e.$t("ignore-value"),icon:t.item.ignored?"plus-circle":"dash-circle"},on:{click:function(a){return e.onIgnoreClick(t.item)}}})]}}])})],1)],1)},We=[];Ke._withStripped=!0;var Je=a(297),Qe=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Xe=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.refMeasureValueItems=[],e.refMeasureValueColumns=[{key:"pcs",label:e.$t("pcs").toString()},{key:"notes",label:e.$t("notes").toString()},{key:"values",label:e.$t("values").toString()},{key:"ignored",label:e.$t("ignored").toString()}],e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateRefMeasurements();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onIgnoreClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].ignoreReferenceMeasurement(t.id,!t.ignored);case 2:t.ignored=!t.ignored,this.showSuccess(this.$t("reference-measurement-value-change-success").toString());case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"refresh",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateRefMeasurements();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateRefMeasurements",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n,i,s,l,o,c,u,p=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getReferenceMeasurements(this.analysis.id);case 2:t=e.sent,a=Je["a"].getPIs(t.columns.map((function(e){return{keyFigureId:e.pi_column.key_figure_id,piFieldName:e.pi_column.pi_field_name}}))),n=[],i=Object(O["a"])(t.items);try{for(i.s();!(s=i.n()).done;){for(u in l=s.value,o=[],c=function(e){var n=t.columns.find((function(t){return t.id===e})),i=a.find((function(e){return e.keyFigureId===n.pi_column.key_figure_id&&e.piFieldName===n.pi_column.pi_field_name}));o.push("".concat(p.$t(i.transName).toString(),": ").concat(l.column_values[e]))},l.column_values)c(u);n.push({id:l.id,pcs:l.fieldgeometry_component.kks,notes:l.notes,ignored:l.ignore_as_ref_measure,values:o.join("<br>")})}}catch(r){i.e(r)}finally{i.f()}this.refMeasureValueItems=n.sort((function(e,t){var a=e.pcs.toLowerCase(),n=t.pcs.toLowerCase();return a<n?-1:a>n?1:0}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);Qe([Object(f["b"])({required:!0})],Xe.prototype,"analysis",void 0),Qe([Object(F["a"])()],Xe.prototype,"onIgnoreClick",null),Qe([Object(F["a"])("loading")],Xe.prototype,"updateRefMeasurements",null),Xe=Qe([Object(f["a"])({name:"app-reference-measurement-values",components:{AppTableContainer:w["a"],AppTable:k["a"],AppButton:v["a"]}})],Xe);var et=Xe,tt=et,at=Object(U["a"])(tt,Ke,We,!1,null,null,null);at.options.__file="src/app/analysis/edit-analysis/reference-measurement/reference-measurement-values.vue";var nt=at.exports,it=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},st=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.refMeasureItems=[],e.refMeasureColumns=[{key:"measureDate",label:e.$t("measure-date").toString()},{key:"measureNotes",label:e.$t("notes").toString()},{key:"user_created",label:e.$t("acquired-by").toString()}],e.selectedRefMeasureId=null,e.moveTargetAnalysisId=null,e.moveToAnalyses=[],e.moveModalLoading=!1,e}return Object(c["a"])(a,[{key:"onMoveClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getAllAnalysis({plant_id:this.analysis.plant.id});case 2:this.moveToAnalyses=e.sent.filter((function(e){return e.id!==t.analysis.id})).map((function(e){return{value:e.id,text:e.name}})),this.moveTargetAnalysisId=null,this.moveModal.show();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onMove",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.moveTargetAnalysisId){e.next=2;break}throw{error:"MISSING_TARGET_ANALYSIS",message:"Please select an analysis"};case 2:return e.next=4,b["a"].moveObservations(this.analysis.id,this.moveTargetAnalysisId);case 4:return this.showSuccess(this.$t("reference-measurement-moved-success").toString()),I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS),this.moveModal.hide(),e.next=9,this.appReferenceMeasurementValues.refresh();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);it([Object(f["b"])({required:!0})],st.prototype,"analysis",void 0),it([Object(f["c"])()],st.prototype,"appReferenceMeasurementValues",void 0),it([Object(f["c"])()],st.prototype,"moveModal",void 0),it([Object(F["a"])("loading")],st.prototype,"onMoveClick",null),it([Object(F["a"])("moveModalLoading")],st.prototype,"onMove",null),st=it([Object(f["a"])({name:"app-analysis-reference-measurements",components:{AppTableContainer:w["a"],AppTable:k["a"],AppModalForm:E["a"],AppReferenceMeasurementValues:nt,AppButton:v["a"]}})],st);var rt=st,lt=rt,ot=Object(U["a"])(lt,Ye,Ze,!1,null,null,null);ot.options.__file="src/app/analysis/edit-analysis/reference-measurement/analysis-reference-measurements.vue";var ct=ot.exports,ut=a(65),pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-step-progress"},e._l(e.realSteps,(function(t){return a("div",{key:t.id,class:"app-step-progress-step "+t.class,attrs:{id:"appStepProgressStep"+t.id}},[a("div",{class:"app-step-progress-step-counter "+(t.danger?"text-danger":"")},[e._v(" "+e._s(t.danger?"X":t.id)+" ")]),a("div",{class:"app-step-progress-step-name "+(t.danger?"text-danger":"")},[e._v(" "+e._s(t.name)+" ")]),t.active?a("b-popover",{attrs:{target:"appStepProgressStep"+t.id,triggers:"hover",placement:"top"}},[a("span",{domProps:{innerHTML:e._s(t.description)}})]):e._e()],1)})),0)},dt=[];pt._withStripped=!0;a(155),a(77),a(85);var ft=a(17),ht=a(292),mt=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},bt=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.realSteps=[],e}return Object(c["a"])(a,[{key:"created",value:function(){this.onStepsChanged()}},{key:"onStepsChanged",value:function(){var e=this,t=300;this.realSteps=[],this.steps.forEach((function(a,n){var i={id:a.id,name:a.name,description:a.description,active:a.active,danger:a.danger,class:""};e.realSteps.push(i),setTimeout((function(){return i.class=e.getStepClass(a)}),n*t)}))}},{key:"getStepClass",value:function(e){return this.isStepComplete(e)?"completed":this.isActiveStep(e)?"active":""}},{key:"isStepComplete",value:function(e){return this.activeStep&&this.activeStep.id>e.id||!1}},{key:"isActiveStep",value:function(e){return this.activeStep&&this.activeStep.id===e.id||!1}},{key:"activeStep",get:function(){return this.steps.find((function(e){return e.active}))}}]),a}(ft["default"]);mt([Object(f["b"])({required:!0})],bt.prototype,"steps",void 0),mt([Object(f["d"])("steps")],bt.prototype,"onStepsChanged",null),bt=mt([Object(f["a"])({name:"app-step-progress",components:{AppExplanation:ht["a"]}})],bt);var gt=bt,vt=gt,yt=(a(505),Object(U["a"])(vt,pt,dt,!1,null,null,null));yt.options.__file="src/app/shared/components/app-step-progress/app-step-progress.vue";var _t,Ot=yt.exports,wt=a(308),kt=a(318),St=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"app-analysis-flight-campaigns-table-toolbar"},[a("app-button",{attrs:{variant:"primary"},on:{click:e.onCreateFlightCampaignClick}},[e._v(" "+e._s(e.$t("create-flight-campaign"))+" ")])],1),a("app-table-container",[a("app-table",{attrs:{rows:e.flightCampaignItems,columns:e.flightCampaignColumns,selectMode:"single",loading:e.loading,hoverActions:!0},on:{rowSelected:e.onFlightCampaignSelected},scopedSlots:e._u([{key:"cell(name)",fn:function(t){return[a("span",{class:e.isGenerating(t.item)?"orange":e.failedToGenerate(t.item)?"red":"",style:e.failedToGenerate(t.item)?"text-decoration: line-through;":""},[e._v(" "+e._s(t.item.name)+" ")])]}},{key:"cell(start_date)",fn:function(t){return[a("span",{class:e.isGenerating(t.item)?"orange":e.failedToGenerate(t.item)?"red":"",style:e.failedToGenerate(t.item)?"text-decoration: line-through;":""},[e._v(" "+e._s(t.item.start_date)+" ")])]}},{key:"cell(drone)",fn:function(t){return[a("span",{class:e.isGenerating(t.item)?"orange":e.failedToGenerate(t.item)?"red":"",style:e.failedToGenerate(t.item)?"text-decoration: line-through;":""},[e._v(" "+e._s(e.appendDroneNameAndSerialNumber(t.item.drone))+" ")])]}},{key:"cell(plant_status)",fn:function(t){return[e.isGenerating(t.item)?a("span",[a("app-explanation",[e._v(e._s(e.$t("flight-type-not-yet-available_expl")))])],1):a("span",{class:e.isGenerating(t.item)?"orange":e.failedToGenerate(t.item)?"red":"",style:e.failedToGenerate(t.item)?"text-decoration: line-through;":""},[e._v(" "+e._s(t.item.plant_status.map((function(e){return e.name})).join(", "))+" ")])]}},{key:"cell(user_created)",fn:function(t){return[a("span",{class:e.isGenerating(t.item)?"orange":e.failedToGenerate(t.item)?"red":"",style:e.failedToGenerate(t.item)?"text-decoration: line-through;":""},[e._v(" "+e._s(t.item.user_created)+" ")])]}},{key:"hoverActions",fn:function(t){return[a("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin&&e.isGenerated(t.item),expression:"isSuperAdmin && isGenerated(row.item)"}],attrs:{icon:"arrow-right-circle-fill",variant:"secondary",size:"sm",title:e.$t("export-to-third-party")},on:{click:function(a){return e.onExportClick(t.item)}}}),a("app-button",{attrs:{variant:"outline-danger",size:"sm",icon:"trash",title:e.$t("delete")},on:{click:function(a){return e.onDeleteClick(t.item)}}})]}}])})],1),a("app-modal-form",{ref:"appFlightCampaignModal",attrs:{id:"flight-campaign-modal",title:e.flightCampaignModalTitle,"ok-title":e.flightCampaignModalOkTitle,modalLoading:e.flightCampaignModalLoading,"cancel-title":e.$t("cancel")},on:{submit:e.onSubmitFlightCampaign}},[e.newFlightCampaign?a("div",[a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:e.$t("name")}},[a("b-form-input",{attrs:{id:"new-flight-campaign-name",required:"",placeholder:e.$t("name")},model:{value:e.newFlightCampaign.name,callback:function(t){e.$set(e.newFlightCampaign,"name",t)},expression:"newFlightCampaign.name"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:e.$t("drone")}},[a("b-form-select",{attrs:{id:"drone-selection",options:e.droneSelection},model:{value:e.selectedDroneId,callback:function(t){e.selectedDroneId=t},expression:"selectedDroneId"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:e.$t("start-date")}},[a("app-datepicker",{attrs:{required:""},model:{value:e.newFlightCampaign.startDate,callback:function(t){e.$set(e.newFlightCampaign,"startDate",t)},expression:"newFlightCampaign.startDate"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:e.$t("product-packages")}},[a("app-multiselect",{attrs:{options:e.availableProductPackages},model:{value:e.newFlightCampaign.orderProductPackageIds,callback:function(t){e.$set(e.newFlightCampaign,"orderProductPackageIds",t)},expression:"newFlightCampaign.orderProductPackageIds"}})],1)],1)],1),a("b-row",[a("b-col",[e.isSuperAdmin?a("b-form-group",{attrs:{label:e.$t("force-add-flight-types")},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" "+e._s(e.$t("force-add-flight-types"))+" "),a("app-super-admin-marker")]},proxy:!0}],null,!1,4026018900)},[a("app-multiselect",{attrs:{options:e.availableFlightTypes},model:{value:e.newFlightCampaign.forceAddFlightTypeIds,callback:function(t){e.$set(e.newFlightCampaign,"forceAddFlightTypeIds",t)},expression:"newFlightCampaign.forceAddFlightTypeIds"}})],1):e._e()],1)],1),a("b-row",[a("b-col",[a("b-form-checkbox",{attrs:{id:"new-flight-campaign-battery-hotswapping"},model:{value:e.newFlightCampaign.batteryHotswapping,callback:function(t){e.$set(e.newFlightCampaign,"batteryHotswapping",t)},expression:"newFlightCampaign.batteryHotswapping"}},[e._v(" "+e._s(e.$t("battery-hotswapping"))+" "),a("app-explanation",[e._v(e._s(e.$t("battery-hotswapping_expl")))])],1)],1)],1),a("b-row",[a("b-col",[a("b-form-checkbox",{attrs:{id:"new-flight-campaign-autoexport-litchi"},model:{value:e.newFlightCampaign.autoExportLitchi,callback:function(t){e.$set(e.newFlightCampaign,"autoExportLitchi",t)},expression:"newFlightCampaign.autoExportLitchi"}},[e._v(" "+e._s(e.$t("auto-export-litchi"))+" "),a("app-explanation",[e._v(e._s(e.$t("auto-export-litchi_expl")))])],1)],1)],1),a("b-row",[a("b-col",[a("b-form-checkbox",{attrs:{id:"new-flight-campaign-optimize-torsion-flights"},model:{value:e.newFlightCampaign.optimizeTorsionFlights,callback:function(t){e.$set(e.newFlightCampaign,"optimizeTorsionFlights",t)},expression:"newFlightCampaign.optimizeTorsionFlights"}},[e._v(" "+e._s(e.$t("optimize-torsion-flights"))+" "),a("app-explanation",[e._v(e._s(e.$t("optimize-torsion-flights_expl")))])],1)],1)],1)],1):e._e()]),e.selectedFlightCampaign?a("div",[a("app-button",{staticClass:"app-analysis-flight-campaigns-print-flight-campaign-btn pull-right",attrs:{variant:"primary",icon:"file-earmark-pdf"},on:{click:e.onPrintFlightCampaignClick}},[e._v(" "+e._s(e.$t("print-flight-campaign"))+" ")])],1):e._e(),e.selectedFlightCampaign?a("div",[a("app-flight-campaign-routes",{attrs:{id:"flight-campaign-routes-area",analysis:e.analysis,flightCampaign:e.selectedFlightCampaign}})],1):e._e(),a("app-modal-form",{ref:"exportModal",attrs:{id:"export-modal",title:e.$t("export-to-third-party"),"ok-title":e.$t("export"),"cancel-title":e.$t("cancel"),modalLoading:e.exportModalLoading},on:{submit:e.onExport}},[a("b-form-group",{attrs:{label:e.$t("select-export-target")}},[a("b-form-select",{attrs:{options:e.exportTargetOptions,required:""},on:{change:e.onExportTargetChanged},model:{value:e.exportTargetId,callback:function(t){e.exportTargetId=t},expression:"exportTargetId"}})],1),a("b-form-group",{attrs:{label:e.$t("username")}},[a("b-form-input",{attrs:{placeholder:e.$t("username"),required:"",disabled:!e.enableExportUserPasswordAuth},model:{value:e.exportUsername,callback:function(t){e.exportUsername=t},expression:"exportUsername"}})],1),a("b-form-group",{attrs:{label:e.$t("password")}},[a("b-form-input",{attrs:{placeholder:e.$t("password"),required:"",disabled:!e.enableExportUserPasswordAuth,type:"password"},model:{value:e.exportPassword,callback:function(t){e.exportPassword=t},expression:"exportPassword"}})],1)],1)],1)},At=[];St._withStripped=!0,function(e){e[e["GENERATING"]=1]="GENERATING",e[e["FINISHED_GENERATING"]=2]="FINISHED_GENERATING",e[e["FAILED_GENERATING"]=3]="FAILED_GENERATING"}(_t||(_t={}));var jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.flightCampaign,expression:"flightCampaign"}]},[a("div",{staticClass:"app-flight-campaign-routes-print-headline mb-5"},[a("h2",[e._v(" "+e._s(e.flightCampaign.name)+" ")]),a("p",[e._v(" "+e._s(this.$t("date")+": "+e.flightCampaign.start_date)+" ")]),a("p",[e._v(" "+e._s(this.$t("drone")+": "+e.appendDroneNameAndSerialNumber(e.flightCampaign.drone))+" ")])]),e._l(e.flightRoutesDays,(function(t,n){return a("div",{key:n},[a("h3",{staticClass:"app-flight-campaign-routes-table-header"},[e._v(" "+e._s(e.$t("day-with-number",{number:n+1}))+", "+e._s(e.getWeekDay(t.date))+" ")]),a("app-table-container",[a("app-table",{attrs:{rows:t.flightRoutesActions,columns:e.flightRouteColumns,loading:e.loading,hoverActions:!0},scopedSlots:e._u([{key:"cell(startTime)",fn:function(t){return[e._v(" "+e._s(t.item.startTime)+" ")]}},{key:"cell(drone)",fn:function(t){return[e._v(" "+e._s(e.appendDroneNameAndSerialNumber(t.item.drone))+" ")]}},{key:"cell(plantStatus)",fn:function(t){return[a("span",[e._v(" "+e._s(t.item.plantStatus?t.item.plantStatus.name:"")+" ")]),t.item.plantStatus?a("app-explanation",[e._v(e._s(t.item.plantStatus.description))]):e._e()]}},{key:"cell(action)",fn:function(t){return[e._v(" "+e._s(t.item.action?t.item.action:"")+" ")]}},{key:"cell(duration)",fn:function(t){return[e._v(" "+e._s(t.item.duration?e.$t("number-with-minutes",{number:t.item.duration}):"")+" ")]}},{key:"hoverActions",fn:function(t){return[t.item.drone?a("app-dropdown-button",{staticClass:"d-none app-flight-campaign-routes-show-when-not-printing",attrs:{variant:"secondary",size:"sm"},scopedSlots:e._u([{key:"title",fn:function(){return[a("app-icon",{attrs:{icon:"download"}})]},proxy:!0}],null,!0)},[a("b-dropdown-item-button",{on:{click:function(a){return e.onDownloadJsonClick(t.item)}}},[e._v(" "+e._s(e.$t("download-json"))+" ")]),a("b-dropdown-item-button",{attrs:{disabled:!e.isDJIWPMZDownloadAllowed(t.item)},on:{click:function(a){return e.onDownloadWPMZClick(t.item)}}},[e._v(" "+e._s(e.$t("download-wpml-file"))+" ")]),e.isSuperAdmin?a("b-dropdown-item-button",{on:{click:function(a){return e.onDownloadUnleashClick(t.item)}}},[e._v(" "+e._s(e.$t("download-unleash-route"))+" ")]):e._e()],1):e._e(),a("app-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],staticClass:"d-none app-flight-campaign-routes-show-when-not-printing",attrs:{variant:"outline-danger",size:"sm",icon:"trash",title:e.$t("delete")},on:{click:function(a){return e.onDeleteClick(t.item)}}})]}}],null,!0)})],1)],1)}))],2)},Ct=[];jt._withStripped=!0;var xt=a(157),Et=a(353),It=a(159),Dt=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Ft=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.flightRoutesDays=[],e.flightRouteColumns=[{key:"startTime",label:e.$t("start-time").toString()},{key:"plantArea",label:e.$t("plant-area").toString()},{key:"plantStatus",label:e.$t("plant-status").toString()},{key:"action",label:e.$t("action").toString()},{key:"duration",label:e.$t("duration").toString(),labelExpl:e.$t("flight-route-duration_expl").toString()}],e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateFlightRoutes();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFlightCampaignChanged",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateFlightRoutes();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDownloadJsonClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.flightCampaign){e.next=5;break}return e.next=3,b["a"].generateDownloadUrl(b["a"].getFlightRouteJsonUrl(t.id));case 3:a=e.sent,S["a"].download(a);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onDownloadWPMZClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.flightCampaign){e.next=5;break}return e.next=3,b["a"].generateDownloadUrl(b["a"].getFlightRouteDjiWpmlUrl(t.id));case 3:a=e.sent,S["a"].download(a);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onDownloadUnleashClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.flightCampaign){e.next=5;break}return e.next=3,b["a"].generateDownloadUrl(b["a"].getFlightRouteUnleashUrl(t.id));case 3:a=e.sent,S["a"].download(a);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onDeleteClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.flightCampaign){e.next=14;break}if(!t.drone){e.next=8;break}if(confirm(this.$t("flight-route-delete-are-you-sure").toString())){e.next=4;break}return e.abrupt("return");case 4:b["a"].deleteFlightRoute(t.id),this.showSuccess(this.$t("flight-route-delete-success").toString()),e.next=12;break;case 8:if(confirm(this.$t("plant-action-delete-are-you-sure").toString())){e.next=10;break}return e.abrupt("return");case 10:b["a"].deletePlantOperationAction(this.flightCampaign.id,t.id),this.showSuccess(this.$t("plant-action-delete-success").toString());case 12:return e.next=14,this.updateFlightRoutes();case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateFlightRoutes",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a,n,i,l,o,c,u,p,d,f=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.flightCampaign){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,b["a"].getPlantActionsOfFlightCampaign(this.flightCampaign.id);case 4:return t=e.sent.map((function(e){return{id:e.id,startTime:x["a"].toDateTime(e.timestamp,!0),action:e.action_text}})),e.next=7,b["a"].getFlightRoutesOfFlightCampaign(this.flightCampaign.id);case 7:a=e.sent.map((function(e){return{id:e.id,startTime:x["a"].toDateTime(e.start_time,!0),drone:e.drone,plantArea:e.plant_area,plantStatus:e.plant_status,duration:e.duration,action:f.$t("fly-drone-action").toString()}})),n=Object(It["b"])([].concat(Object(s["a"])(t),Object(s["a"])(a)),(function(e){return e.startTime})),i=[],l=null,o=Object(O["a"])(n);try{for(o.s();!(c=o.n()).done;)u=c.value,p=u.startTime.substring(0,10),l&&l===p||i.push({date:p,flightRoutesActions:[]}),d=i[i.length-1],d.flightRoutesActions.push(u),l=p}catch(r){o.e(r)}finally{o.f()}this.flightRoutesDays=i;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"appendDroneNameAndSerialNumber",value:function(e){return void 0==e?"":this.$t("drone-with-sn",{droneName:e.custom_name,droneSerialNumber:e.serial_number}).toString()}},{key:"getWeekday",value:function(e){return x["a"].getWeekDay(e)}},{key:"isDJIWPMZDownloadAllowed",value:function(e){var t;return"M3T"===(null===(t=e.drone)||void 0===t?void 0:t.drone_model.name_abbrev)}}]),a}(h["a"]);Dt([Object(f["b"])({required:!0})],Ft.prototype,"analysis",void 0),Dt([Object(f["b"])({default:null})],Ft.prototype,"flightCampaign",void 0),Dt([Object(f["d"])("flightCampaign")],Ft.prototype,"onFlightCampaignChanged",null),Dt([Object(F["a"])()],Ft.prototype,"onDownloadJsonClick",null),Dt([Object(F["a"])()],Ft.prototype,"onDownloadWPMZClick",null),Dt([Object(F["a"])()],Ft.prototype,"onDownloadUnleashClick",null),Dt([Object(F["a"])()],Ft.prototype,"onDeleteClick",null),Dt([Object(F["a"])("loading")],Ft.prototype,"updateFlightRoutes",null),Ft=Dt([Object(f["a"])({name:"app-flight-campaign-routes",components:{AppTableContainer:w["a"],AppTable:k["a"],AppButton:v["a"],AppExplanation:ht["a"],AppDropdownButton:Et["a"],AppIcon:xt["a"]}})],Ft);var Pt=Ft,Rt=Pt,Tt=(a(506),Object(U["a"])(Rt,jt,Ct,!1,null,null,null));Tt.options.__file="src/app/analysis/edit-analysis/flight-campaign/flight-campaign-route.vue";var Nt=Tt.exports,Ut=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},$t=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.loading=!1,e.droneSelection=[],e.selectedDroneId=null,e.availableProductPackages=[],e.availableFlightTypes=[],e.flightCampaignModalLoading=!1,e.flightCampaignModalTitle="",e.flightCampaignModalOkTitle="",e.exportModalLoading=!1,e.exportTargetOptions=["Unleash","Litchi"],e.exportTargetId="Unleash",e.enableExportUserPasswordAuth=!1,e.exportUsername="",e.exportPassword="",e.flightCampaignSelectedForExport=null,e.newFlightCampaign=null,e.flightCampaignItems=[],e.flightCampaignColumns=[{key:"name",label:e.$t("name").toString()},{key:"start_date",label:e.$t("start-date").toString()},{key:"drone",label:e.$t("drone").toString()},{key:"plant_status",label:e.$t("flight-types").toString()},{key:"user_created",label:e.$t("created-by").toString()}],e.selectedFlightCampaign=null,e}return Object(c["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getAvailableDronesForAnalysis(this.analysis.id);case 2:return this.droneSelection=e.sent.map((function(e){return{value:e.id.toString(),text:t.appendDroneNameAndSerialNumber(e)}})),e.next=5,this.updateFlightCampaigns();case 5:return e.next=7,b["a"].getOrderPPsMulitselectOptions(this.analysis.plant.id,this.analysis.flown_at,this.analysis.customer.id);case 7:return this.availableProductPackages=e.sent,e.next=10,b["a"].getAllPlantStatus();case 10:this.availableFlightTypes=e.sent.filter((function(e){return e.technology_id===t.analysis.plant.technology_id})).map((function(e){return{id:e.id.toString(),label:e.name}}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onCreateFlightCampaignClick",value:function(){var e;this.newFlightCampaign={name:this.analysis.name+" "+this.$t("flight-campaign")+" "+(this.flightCampaignItems.length+1).toString(),analysisId:this.analysis.id,startDate:this.analysis.flown_at,batteryHotswapping:!0,orderProductPackageIds:this.analysis.order_product_packages.map((function(e){return e.id})),forceAddFlightTypeIds:[],autoExportLitchi:!1,optimizeTorsionFlights:!1},this.selectedDroneId=null===(e=this.analysis.drone)||void 0===e?void 0:e.id,this.flightCampaignModalTitle=this.$t("create-flight-campaign").toString(),this.flightCampaignModalOkTitle=this.$t("create").toString(),this.appFlightCampaignModal.show()}},{key:"onSubmitFlightCampaign",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.newFlightCampaign){e.next=3;break}return e.abrupt("return");case 3:if(this.newFlightCampaign.name){e.next=5;break}throw{error:"INVALID_FLIGHT_CAMPAIGN_NAME",message:"Please enter a name for the flight campaign"};case 5:if(this.selectedDroneId){e.next=7;break}throw{error:"INVALID_OR_MISSING_DRONE_SELECTION",message:"Please select a drone"};case 7:if(0!=this.newFlightCampaign.orderProductPackageIds.length||this.isSuperAdmin){e.next=9;break}throw{error:"MISSING_PRODUCT_PACKAGE_SELECTION",message:"Please select a product package"};case 9:if(0!=this.newFlightCampaign.orderProductPackageIds.length||0!=this.newFlightCampaign.forceAddFlightTypeIds.length||!this.isSuperAdmin){e.next=11;break}throw{error:"MISSING_PRODUCT_PACKAGE_OR_FLIGHT_TYPE",message:"Please select a product package or additional flight type"};case 11:return e.next=13,b["a"].createFlightCampaign({name:this.newFlightCampaign.name,analysis_id:this.newFlightCampaign.analysisId,drone_id:this.selectedDroneId,start_date:this.newFlightCampaign.startDate,original_start_date:this.newFlightCampaign.startDate,battery_hotswapping:this.newFlightCampaign.batteryHotswapping,order_product_package_ids:this.newFlightCampaign.orderProductPackageIds,force_add_flight_type_ids:this.newFlightCampaign.forceAddFlightTypeIds,auto_export_litchi:this.newFlightCampaign.autoExportLitchi,optimize_torsion_flights:this.newFlightCampaign.optimizeTorsionFlights});case 13:return this.showSuccess(this.$t("now-creating-flight-campaign",{flight_campaign:this.newFlightCampaign.name}).toString()),this.appFlightCampaignModal.hide(),e.next=17,this.updateFlightCampaigns();case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](0),this.showError(e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateFlightCampaigns",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=It["b"],e.next=3,b["a"].getFlightCampaignsOfAnalysis(this.analysis.id);case 3:e.t1=e.sent.map((function(e){return{id:e.id,name:e.name,drone:e.drone,start_date:x["a"].toDate(e.start_date),original_start_date:x["a"].toDate(e.original_start_date),plant_status:e.plant_status,flight_campaign_state:e.flight_campaign_state,user_created:e.user_created?(e.user_created.first_name+" "+e.user_created.last_name).trim()||e.user_created.email:""}})),e.t2=function(e){return e.start_date},e.t3=function(e){return e.name.toLowerCase()},this.flightCampaignItems=(0,e.t0)(e.t1,e.t2,e.t3);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFlightCampaignSelected",value:function(e){e.length>0?e[0].flight_campaign_state==_t.GENERATING?(alert(this.$t("flight-campaign-being-generated")),this.selectedFlightCampaign=null):e[0].flight_campaign_state==_t.FAILED_GENERATING?(alert(this.$t("flight-campaign-generation-failed")),this.selectedFlightCampaign=null):this.selectedFlightCampaign=e[0]:this.selectedFlightCampaign=null}},{key:"onDeleteClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(confirm(this.$t("flight-campaign-delete-are-you-sure").toString())){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,b["a"].deleteFlightCampaign(t.id);case 4:return this.showSuccess(this.$t("flight-campaign-delete-success").toString()),e.next=7,this.updateFlightCampaigns();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"appendDroneNameAndSerialNumber",value:function(e){return this.$t("drone-with-sn",{droneName:e.custom_name,droneSerialNumber:e.serial_number}).toString()}},{key:"onExportClick",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.flightCampaignSelectedForExport=t,this.onExportTargetChanged(),this.exportModal.show();case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onExportTargetChanged",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.exportUsername="",this.exportPassword="","Litchi"==this.exportTargetId?this.enableExportUserPasswordAuth=!0:"Unleash"==this.exportTargetId&&(this.enableExportUserPasswordAuth=!1);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onExport",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.flightCampaignSelectedForExport){e.next=3;break}return this.showError("No flight campaign selected for export"),e.abrupt("return");case 3:if("Unleash"!=this.exportTargetId){e.next=10;break}return e.next=6,b["a"].exportFlightCampaignToUnleash(this.flightCampaignSelectedForExport.id);case 6:this.showSuccess(this.$t("flight-campaign-export-unleash-success").toString()),this.exportModal.hide(),e.next=11;break;case 10:this.showError("Not yet implemented");case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isGenerating",value:function(e){return e.flight_campaign_state==_t.GENERATING}},{key:"failedToGenerate",value:function(e){return e.flight_campaign_state==_t.FAILED_GENERATING}},{key:"isGenerated",value:function(e){return e.flight_campaign_state==_t.FINISHED_GENERATING}},{key:"onPrintFlightCampaignClick",value:function(){var e;this.$htmlToPaper("flight-campaign-routes-area",{windowTitle:(null===(e=this.selectedFlightCampaign)||void 0===e?void 0:e.name)+" - "+this.analysis.name+" - "+this.analysis.plant.name})}}]),a}(h["a"]);Ut([Object(f["b"])({required:!0})],$t.prototype,"analysis",void 0),Ut([Object(f["c"])()],$t.prototype,"appFlightCampaignModal",void 0),Ut([Object(f["c"])()],$t.prototype,"exportModal",void 0),Ut([Object(F["a"])()],$t.prototype,"created",null),Ut([Object(F["a"])()],$t.prototype,"onCreateFlightCampaignClick",null),Ut([Object(F["a"])("flightCampaignModalLoading")],$t.prototype,"onSubmitFlightCampaign",null),Ut([Object(F["a"])("loading")],$t.prototype,"onDeleteClick",null),Ut([Object(F["a"])()],$t.prototype,"onPrintFlightCampaignClick",null),$t=Ut([Object(f["a"])({name:"app-analysis-flight-campaigns",components:{AppTableContainer:w["a"],AppTable:k["a"],AppModalForm:E["a"],AppButton:v["a"],AppDatepicker:kt["a"],AppSuperAdminMarker:ut["a"],AppMultiselect:wt["a"],AppFlightCampaignRoutes:Nt,AppExplanation:ht["a"]}})],$t);var Lt=$t,Mt=Lt,Gt=(a(507),Object(U["a"])(Mt,St,At,!1,null,null,null));Gt.options.__file="src/app/analysis/edit-analysis/flight-campaign/flight-campaign.vue";var Bt=Gt.exports,zt=function(e,t,a,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(r=(s<3?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},Vt=function(e){Object(u["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.analysis=null,e.flownAt="",e.loading=!1,e.hasReferenceMeasurements=!1,e.productPackagesSelection=[],e.selectedProductPackageIds=null,e.keyFiguresSelection=[],e.selectedKeyFigureIds=null,e.selectedDrone=null,e.selectedDroneId=null,e.droneOptionsRaw=[],e.droneOptions=null,e.tabIndex=0,e.tabs=["#download","#upload"],e}return Object(c["a"])(a,[{key:"mounted",value:function(){var e=this;this.tabIndex=this.tabs.findIndex((function(t){return t===e.$route.meta.hash}))}},{key:"created",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysis(this.$route.params.id);case 2:I["a"].on(this.analysis.id,D["a"].UPDATE_ANALYSIS,(function(){t.updateAnalysis(t.analysis.id)}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"analysisProgressSteps",get:function(){var e,t,a=2;return[{id:j["a"].UPLOADING,name:this.hasState([j["a"].UPLOAD_FAILED,j["a"].DATA_INCOMPLETE])?this.$t((null===(e=this.analysis.current_state)||void 0===e?void 0:e.state.name)||"").toString():this.$t(j["b"][j["a"].UPLOADING]).toString(),description:this.hasState([j["a"].UPLOAD_FAILED,j["a"].DATA_INCOMPLETE])?this.$t((null===(t=this.analysis.current_state)||void 0===t?void 0:t.state.name)+"_descr").toString():this.$t(j["b"][j["a"].UPLOADING]+"_descr").toString(),danger:this.hasState([j["a"].UPLOAD_FAILED,j["a"].DATA_INCOMPLETE]),active:this.hasState([j["a"].UPLOADING,j["a"].UPLOAD_FAILED,j["a"].DATA_INCOMPLETE])},{id:j["a"].DATA_COMPLETE-a,name:this.$t(j["b"][j["a"].DATA_COMPLETE]).toString(),description:this.$t(j["b"][j["a"].DATA_COMPLETE]+"_descr").toString(),active:this.hasState([j["a"].DATA_COMPLETE])},{id:j["a"].DATA_COMPLETE_VERIFIED-a,name:this.$t(j["b"][j["a"].DATA_COMPLETE_VERIFIED]).toString(),description:this.$t(j["b"][j["a"].DATA_COMPLETE_VERIFIED]+"_descr").toString(),active:this.hasState([j["a"].DATA_COMPLETE_VERIFIED])},{id:j["a"].PROCESSING-a,name:this.$t(j["b"][j["a"].PROCESSING]).toString(),description:this.$t(j["b"][j["a"].PROCESSING]+"_descr").toString(),active:this.hasState([j["a"].PROCESSING])},{id:j["a"].FINISHED-a,name:this.$t(j["b"][j["a"].FINISHED]).toString(),description:this.$t(j["b"][j["a"].FINISHED]+"_descr").toString(),active:this.hasState([j["a"].FINISHED])}]}},{key:"hasState",value:function(e){var t;return this.isStateNotNull&&this.analysis&&this.analysis.current_state&&e.includes(null===(t=this.analysis.current_state)||void 0===t?void 0:t.state.id)||!1}},{key:"isStateNotNull",get:function(){var e;return void 0!=(null===(e=this.analysis)||void 0===e?void 0:e.current_state)}},{key:"updateAnalysis",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(t){var a,n,i,l=this;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].getAnalysis(t);case 2:if(this.analysis=e.sent,this.flownAt=this.analysis.flown_at,!this.isSuperAdmin){e.next=9;break}return e.next=7,b["a"].getReferenceMeasurements(this.analysis.id);case 7:e.t0=e.sent.items.length,this.hasReferenceMeasurements=e.t0>0;case 9:return e.next=11,b["a"].getOrderPPsMulitselectOptions(this.analysis.plant.id,this.analysis.flown_at,this.analysis.customer.id);case 11:if(this.productPackagesSelection=e.sent,this.selectedProductPackageIds=this.analysis.order_product_packages.map((function(e){return e.id})),!this.isSuperAdmin){e.next=18;break}return e.next=16,b["a"].getAllKeyFigures();case 16:this.keyFiguresSelection=e.sent.filter((function(e){return e.component.technology_id===l.analysis.plant.technology_id})).map((function(e){return{id:e.id.toString(),label:e.name}})),this.selectedKeyFigureIds=(null===(a=this.analysis.analysis_key_figures)||void 0===a?void 0:a.map((function(e){return e.key_figure_id.toString()})))||null;case 18:return this.watchAnalysisTask(),this.isStateNotNull&&(this.isSuperAdmin&&this.analysis.analysis_result&&this.analysis.analysis_result.released&&(null===(n=this.analysis.current_state)||void 0===n?void 0:n.state.id)!==j["a"].FINISHED&&C["a"].showInfo(this.analysis.id,this.$t("analysis-not-finished_descr").toString()),!this.isSuperAdmin||(null===(i=this.analysis.current_state)||void 0===i?void 0:i.state.id)!==j["a"].FINISHED||this.analysis.analysis_result&&this.analysis.analysis_result.released||C["a"].showInfo(this.analysis.id,this.$t("analysis-not-released_descr").toString())),this.selectedDrone=this.analysis.drone,this.selectedDrone&&(this.selectedDroneId=this.selectedDrone.id),e.next=24,b["a"].getAvailableDronesForAnalysis(this.analysis.id);case 24:this.droneOptionsRaw=e.sent.map((function(e){return{value:e.id,text:l.$t("drone-with-sn",{droneName:e.custom_name,droneSerialNumber:e.serial_number}).toString()}})),this.isSelectedDroneUnavailable?this.droneOptions=[].concat(Object(s["a"])(this.droneOptionsRaw),[{value:this.selectedDrone.id,text:this.$t("drone-with-sn",{droneName:this.selectedDrone.custom_name,droneSerialNumber:this.selectedDrone.serial_number}).toString()}]):this.droneOptions=this.droneOptionsRaw;case 26:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isSelectedDroneUnavailable",get:function(){var e=this;return!!this.selectedDrone&&!this.droneOptionsRaw.find((function(t){return t.value==e.selectedDrone.id}))}},{key:"watchAnalysisTask",value:function(){var e=this;this.analysis.task_id&&this.isSuperAdmin&&b["a"].waitForTask(this.analysis.task_id,(function(t,a){a?C["a"].showError(e.analysis.id,{error:m["a"].SOMETHING_WENT_WRONG,message:"<b>".concat(t.output.error,"</b><br><br>")+b["a"].getTaskOutputAsMessage(t)}):C["a"].showSuccess(e.analysis.id,b["a"].getTaskOutputAsMessage(t)),I["a"].emit(e.analysis.id,D["a"].FINISHED_ANALYSIS_TASK,t)}),(function(t){C["a"].showInfo(e.analysis.id,b["a"].getTaskOutputAsMessage(t,e.$t("wait-for-start").toString())),I["a"].emit(e.analysis.id,D["a"].RUN_ANALYSIS_TASK,t)}))}},{key:"onSubmitEditAnalysis",value:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].updateAnalysis(this.analysis.id,{flown_at:null===(t=this.flownAt)||void 0===t?void 0:t.substring(0,10),order_product_package_ids:this.selectedProductPackageIds||void 0,key_figure_ids:(null===(a=this.selectedKeyFigureIds)||void 0===a?void 0:a.map((function(e){return parseInt(e)})))||void 0,drone_id:this.selectedDroneId||void 0});case 2:this.showSuccess(this.$t("analysis-updated-successfully").toString()),I["a"].emit(this.analysis.id,D["a"].UPDATE_ANALYSIS);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeProductPackagesAndDroneAllowed",get:function(){var e;return!!this.isStateNotNull&&((null===(e=this.analysis.current_state)||void 0===e?void 0:e.state.id)||"")<j["a"].DATA_COMPLETE}},{key:"selectedDroneIsCurrentlyAvailable",get:function(){var e,t=this;return null==(null===(e=this.selectedDrone)||void 0===e?void 0:e.id)||this.droneOptionsRaw.find((function(e){var a;return e.value==(null===(a=t.selectedDrone)||void 0===a?void 0:a.id)}))}},{key:"noDroneAvailable",get:function(){return!(!this.droneOptions||0!=this.droneOptions.length)}}]),a}(h["a"]);zt([Object(F["a"])()],Vt.prototype,"updateAnalysis",null),zt([Object(F["a"])("loading")],Vt.prototype,"onSubmitEditAnalysis",null),Vt=zt([Object(f["a"])({name:"app-edit-analysis",components:{AppContent:g["a"],AppButton:v["a"],AppDownloadAnalysisFiles:L,AppEditAnalysisAdmin:Ue,AppUploadAnalysisFiles:qe,AppBox:V["a"],AppAnalysisReferenceMeasurements:ct,AppSuperAdminMarker:ut["a"],AppStepProgress:Ot,AppMultiselect:wt["a"],AppDatepicker:kt["a"],AppAnalysisFlightCampaigns:Bt}})],Vt);var Ht=Vt,qt=Ht,Yt=(a(508),Object(U["a"])(qt,n,i,!1,null,null,null));Yt.options.__file="src/app/analysis/edit-analysis/edit-analysis.vue";t["default"]=Yt.exports}}]);