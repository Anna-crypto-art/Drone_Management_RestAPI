(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{250:function(e,t,a){},252:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"app-table-container "+(e.size?"app-table-container-"+e.size:"")},[e._t("default")],2)},s=[];n._withStripped=!0;var i=a(25),r=a(24),o=a(31),l=a(30),c=a(40),u=(a(61),a(26),a(15)),p=a(33),d=function(e,t,a,n){var s,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(i<3?s(r):i>3?s(t,a,r):s(t,a))||r);return i>3&&r&&Object.defineProperty(t,a,r),r},f=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a)}(u["default"]);d([Object(p["b"])({default:""})],f.prototype,"size",void 0),f=d([p["a"]],f);var h=f,v=h,y=(a(255),a(39)),b=Object(y["a"])(v,n,s,!1,null,null,null);b.options.__file="src/app/shared/components/app-table-container/app-table-container.vue";t["a"]=b.exports},253:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a(26),a(265),a(61);var n=a(97);function s(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Object(n["a"])(e),null===e)break;return e}function i(){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,a){var n=s(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:a):i.value}},i.apply(this,arguments)}},255:function(e,t,a){"use strict";a(250)},265:function(e,t,a){var n=a(18),s=a(29),i=a(34),r=a(35),o=a(56),l=a(99);function c(e,t){var a,n,u=arguments.length<3?e:arguments[2];return i(e)===u?e[t]:(a=o.f(e,t))?r(a,"value")?a.value:void 0===a.get?void 0:a.get.call(u):s(n=l(e))?c(n,t,u):void 0}n({target:"Reflect",stat:!0},{get:c})},266:function(e,t,a){},267:function(e,t,a){},269:function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s})),function(e){e["UPLOADING"]="UPLOADING",e["UPLOAD_FAILED"]="UPLOAD_FAILED",e["PICK_ME_UP"]="PICK_ME_UP",e["PROCESSING"]="PROCESSING",e["PROCESS_FAILED"]="PROCESS_FAILED",e["ABANDONED"]="ABANDONED",e["FINISHED"]="FINISHED"}(n||(n={}));var s={UPLOADING:[n.PICK_ME_UP,n.UPLOAD_FAILED,n.ABANDONED],UPLOAD_FAILED:[n.UPLOADING,n.ABANDONED,n.PICK_ME_UP],PICK_ME_UP:[n.PROCESSING,n.ABANDONED],PROCESSING:[n.FINISHED,n.ABANDONED,n.PROCESS_FAILED],PROCESS_FAILED:[n.PROCESSING,n.ABANDONED],ABANDONED:[],FINISHED:[]}},271:function(e,t,a){"use strict";a(266)},272:function(e,t,a){"use strict";a(267)},273:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n="new-analysis-storage-key"},274:function(e,t,a){"use strict";var n=a(18),s=a(57),i=a(41),r=a(20),o=a(130),l=[],c=l.sort,u=r((function(){l.sort(void 0)})),p=r((function(){l.sort(null)})),d=o("sort"),f=u||!p||!d;n({target:"Array",proto:!0,forced:f},{sort:function(e){return void 0===e?c.call(i(this)):c.call(i(this),s(e))}})},275:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(24),s=a(25),i=function(){function e(){Object(n["a"])(this,e)}return Object(s["a"])(e,null,[{key:"download",value:function(e,t){var a=document.createElement("a");a.href=e,a.setAttribute("download",t||e),document.body.appendChild(a),a.click()}}]),e}()},277:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-file-upload"},[a("div",{staticClass:"app-file-upload-dropzone",attrs:{id:"file-upload-dropzone-id"}},[a("div",{staticClass:"app-file-upload-dropzone-content"},[e.title?a("h3",{staticClass:"app-file-upload-dropzone-content-title"},[e._v(e._s(e.title))]):e._e(),e._t("default")],2),a("div",{staticClass:"app-file-upload-dropzone-browsebutton"},[a("b-button",{attrs:{variant:"primary",id:"file-upload-browsebutton-id"}},[e._v(e._s(e.$t("browse...")))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.keyResumFiles>0,expression:"keyResumFiles > 0"}],key:e.keyResumFiles,staticClass:"app-file-upload-dropzone-files",staticStyle:{"margin-top":"30px"}},e._l(e.files,(function(t){return a("app-file-upload-file",{key:t.uniqueIdentifier,ref:"uploadFiles",refInFor:!0,attrs:{uploading:e.uploading,file:t}})})),1)])])},s=[];n._withStripped=!0;var i=a(24),r=a(25),o=a(31),l=a(30),c=a(40),u=(a(61),a(26),a(125),a(15)),p=a(33),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-file-upload-file"},[a("div",{staticClass:"app-file-upload-file-infos"},[a("div",{staticClass:"app-file-upload-file-name"},[a("small",{staticClass:"app-file-upload-file-name-size grayed"},[e._v(e._s(e.getFileSize(e.file.size)))]),e._v(" "+e._s(e.file.fileName)+" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"app-file-upload-file-name-error",class:{"text-danger":!e.retry}},[e._v(" "+e._s(e.retry&&e.$t("retrying...")||e.error)+" ")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.uploading,expression:"!uploading"}],staticClass:"app-file-upload-file-remove",on:{click:e.onFileRemove}},[a("b-icon",{attrs:{icon:"x"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploading,expression:"uploading"}],staticClass:"app-file-upload-file-progress"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.success,expression:"!success"}]},[e._v(e._s(e.progress)+"%")]),a("b-icon",{directives:[{name:"show",rawName:"v-show",value:e.success,expression:"success"}],staticClass:"text-success",attrs:{icon:"check2"}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploading,expression:"uploading"}],ref:"uploadProgressBar",staticClass:"app-file-upload-file-progressbar"})])},f=[];d._withStripped=!0;a(124);var h=a(49),v=a(259),y=function(e,t,a,n){var s,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(i<3?s(r):i>3?s(t,a,r):s(t,a))||r);return i>3&&r&&Object.defineProperty(t,a,r),r},b=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.progress=0,e.error="",e.retry=!1,e.success=!1,e}return Object(r["a"])(a,[{key:"created",value:function(){this.uploading&&(this.emitProgress(),100===this.progress&&this.emitSuccess())}},{key:"uniqueIdentifier",get:function(){return this.file.uniqueIdentifier}},{key:"getFileSize",value:function(e){var t=["KB","MB","GB","TB"],a=0;do{e/=1024}while(e>1024&&++a<t.length);return"".concat(Math.round(e)," ").concat(t[a])}},{key:"onFileRemove",value:function(){this.file.cancel(),v["a"].emitFileRemoved(this.file)}},{key:"emitError",value:function(e){try{var t=JSON.parse(e);t.error&&(this.error=t.error)}catch(a){console.error(e),this.error=h["a"].SOMETHING_WENT_WRONG}this.success=!1,this.retry=!1}},{key:"emitRetry",value:function(){this.success=!1,this.retry=!0}},{key:"emitProgress",value:function(){var e=Math.round(100*this.file.progress(!1));e!==this.progress&&(this.progress=e,this.error="",this.retry=!1,this.uploadProgressBar&&(this.uploadProgressBar.style.width=this.progress+"%"))}},{key:"emitSuccess",value:function(){this.error="",this.retry=!1,this.progress=0,this.success=!0,this.uploadProgressBar&&(this.uploadProgressBar.style.display="none")}}]),a}(u["default"]);y([Object(p["b"])({required:!0})],b.prototype,"file",void 0),y([Object(p["b"])({required:!0})],b.prototype,"uploading",void 0),y([Object(p["c"])()],b.prototype,"uploadProgressBar",void 0),b=y([Object(p["a"])({name:"app-file-upload-file"})],b);var m=b,g=m,w=(a(271),a(39)),O=Object(w["a"])(g,d,f,!1,null,null,null);O.options.__file="src/app/shared/components/app-file-upload/app-file-upload-file.vue";var _=O.exports,S=a(261),k=function(e,t,a,n){var s,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(i<3?s(r):i>3?s(t,a,r):s(t,a))||r);return i>3&&r&&Object.defineProperty(t,a,r),r},F=function(e){Object(o["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.keyResumFiles=0,e.uploading=!1,e}return Object(r["a"])(a,[{key:"mounted",value:function(){this.checkUploadState(),this.registerUploadEvents()}},{key:"checkUploadState",value:function(){v["a"].hasState(S["b"].UPLOADING)?(this.uploading=!0,this.keyResumFiles=v["a"].files.length):v["a"].init("file-upload-dropzone-id","file-upload-browsebutton-id")}},{key:"registerUploadEvents",value:function(){var e=this;v["a"].on(S["a"].FILE_SUCCESS,(function(t){var a=e.getFileUploadFile(t);a&&a.emitSuccess()})),v["a"].on(S["a"].FILE_ERROR,(function(t,a){var n=e.getFileUploadFile(t);n&&n.emitError(a)})),v["a"].on(S["a"].FILE_PROGRESS,(function(t){var a=e.getFileUploadFile(t);a&&a.emitProgress()})),v["a"].on(S["a"].FILE_RETRY,(function(t,a){var n=e.getFileUploadFile(t);n&&n.emitRetry()})),v["a"].on(S["a"].FILE_ADDED,(function(t){e.keyResumFiles+=1})),v["a"].on(S["a"].FILE_REMOVED,(function(t){e.keyResumFiles-=1}))}},{key:"upload",value:function(e,t){this.uploading=!0,this.keyResumFiles+=100,v["a"].upload(e,t)}},{key:"files",get:function(){return v["a"].files}},{key:"cancel",value:function(){v["a"].cancel(),this.uploading=!1,this.keyResumFiles-=100}},{key:"getFileUploadFile",value:function(e){return this.uploadFiles.find((function(t){return t.uniqueIdentifier===e.uniqueIdentifier}))}}]),a}(u["default"]);k([Object(p["c"])()],F.prototype,"uploadFiles",void 0),k([Object(p["b"])()],F.prototype,"title",void 0),F=k([Object(p["a"])({name:"app-file-upload",components:{AppFileUploadFile:_}})],F);var D=F,A=D,E=(a(272),Object(w["a"])(A,n,s,!1,null,null,null));E.options.__file="src/app/shared/components/app-file-upload/app-file-upload.vue";t["a"]=E.exports},282:function(e,t,a){},317:function(e,t,a){"use strict";a(282)},348:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.analysis?a("app-content",{attrs:{title:e.analysis.name||"",navback:!0},scopedSlots:e._u([{key:"subtitle",fn:function(){return[e.analysis.current_state?a("div",[a("b",[e._v(e._s(e.$t(e.analysis.current_state.state.name)))])]):e._e()]},proxy:!0}],null,!1,80026355)},[a("div",{staticClass:"app-edit-analysis"},[a("b-tabs",[e._e(),a("b-tab",{staticClass:"app-edit-analysis-download-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"download"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("download")))])]},proxy:!0}],null,!1,1288288109)},[a("app-button",{attrs:{disabled:e.isDownloadButtonDisabled},on:{click:e.onDownloadSelectedFilesClick}},[e._v(" "+e._s(e.$t("download-selected-files"))+" ")]),a("app-table-container",[a("b-table",{ref:"downloadFilesTable",attrs:{items:e.downloadFilesTableItems,fields:e.downloadFilesTableColumns,"select-mode":"multi",selectable:"",hover:"","head-variant":"light"},on:{"row-selected":e.onDownloadFilesSelected},scopedSlots:e._u([{key:"head(selected)",fn:function(){return[a("b-checkbox",{attrs:{checked:e.allDownloadFilesSelected},on:{change:e.onSelectAllDownloadFiles}})]},proxy:!0},{key:"cell(selected)",fn:function(e){var t=e.rowSelected;return[a("b-checkbox",{staticClass:"b-table-selectable-checkbox",attrs:{checked:t,disabled:""}})]}},{key:"row-details",fn:function(t){return e._l(t.item.kpis,(function(t){return a("span",{key:t.id,staticClass:"analysis-selection-sidebar-kpi-badge"},[a("b-badge",{style:"background-color: "+e.getKpiColor(t),attrs:{variant:"primary"}},[e._v(e._s(t.name))])],1)}))}}],null,!1,4275099661)})],1)],1),e.isSuperAdmin?a("b-tab",{staticClass:"app-edit-analysis-admin-tab",scopedSlots:e._u([{key:"title",fn:function(){return[a("b-icon",{attrs:{icon:"braces"}}),a("span",{staticClass:"pad-left"},[e._v(e._s(e.$t("admin-panel")))])]},proxy:!0}],null,!1,3372386877)},[a("div",{staticClass:"admin-box"},[a("h4",[e._v(e._s(e.$t("update-analysis-state")))]),a("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmitUpdateState(t)}}},[a("b-form-group",{attrs:{label:e.$t("select-new-analysis-state")}},[a("b-form-select",{attrs:{required:"",options:e.updateStateOptions},model:{value:e.selectedUpdateState,callback:function(t){e.selectedUpdateState=t},expression:"selectedUpdateState"}})],1),a("b-form-group",{attrs:{label:e.$t("message")}},[a("b-form-textarea",{attrs:{placeholder:e.$t("message"),row:"5"},model:{value:e.selectedUpdateStateMessage,callback:function(t){e.selectedUpdateStateMessage=t},expression:"selectedUpdateStateMessage"}})],1),a("app-button",{attrs:{type:"submit"}},[e._v(e._s(e.$t("update")))])],1)],1)]):e._e()],1)],1)]):e._e()},s=[];n._withStripped=!0;var i=a(75),r=a(16),o=a(24),l=a(25),c=a(31),u=a(30),p=a(40),d=(a(62),a(61),a(26),a(243),a(95),a(100),a(124),a(274),a(96),a(33)),f=a(63),h=a(77),v=a(74),y=a(79),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-analysis-upload"},[a("b-form",{staticStyle:{"margin-bottom":"50px"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("b-row",{directives:[{name:"show",rawName:"v-show",value:!e.analysis,expression:"!analysis"}],staticStyle:{"margin-bottom":"25px"}},[a("b-col",{attrs:{sm:"4"}},[a("b-form-group",{attrs:{"label-cols":"auto",label:e.$t("plant")}},[a("b-form-select",{attrs:{required:"",options:e.plantOptions},model:{value:e.newAnalysis.plant_id,callback:function(t){e.$set(e.newAnalysis,"plant_id",t)},expression:"newAnalysis.plant_id"}})],1)],1)],1),a("app-file-upload",{ref:"appFileUpload",attrs:{title:e.$t("select-files")}}),a("app-button",{ref:"uploadButton",attrs:{type:"submit",cls:"pull-right"}},[e._v(e._s(e.uploadButtonTxt))]),a("app-button",{directives:[{name:"show",rawName:"v-show",value:e.showCancelButton,expression:"showCancelButton"}],ref:"cancelUploadButton",attrs:{variant:"secondary",type:"button"},on:{click:e.onCancelUpload}},[e._v(e._s(e.$t("cancel")))]),a("div",{staticClass:"clearfix"})],1)],1)},m=[];b._withStripped=!0;var g=a(253),w=a(97),O=(a(127),a(277)),_=a(246),S=a(269),k=a(259),F=a(261),D=a(273),A=a(119),E=function(e,t,a,n){var s,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(i<3?s(r):i>3?s(t,a,r):s(t,a))||r);return i>3&&r&&Object.defineProperty(t,a,r),r},R=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.uploadButtonTxt="",e.showCancelButton=!1,e.plantOptions=[],e.newAnalysis={files:[],plant_id:""},e.storageKey=D["a"],e}return Object(l["a"])(a,[{key:"mounted",value:function(){this.registerUploadEvents()}},{key:"created",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(g["a"])(Object(w["a"])(a.prototype),"created",this).call(this);case 2:return this.uploadButtonTxt=this.$t("upload").toString(),e.prev=3,e.next=6,v["a"].getAllPlants();case 6:t=e.sent,this.plantOptions=t.map((function(e){return{value:e.id,text:e.name}})),1===t.length&&(this.newAnalysis.plant_id=t[0].id),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),f["a"].showError(e.t0);case 14:n=this.fetchData(),n?(this.analysis=n.analysis,this.newAnalysis=n.newAnalysis,this.waitForFiles=n.fileNames):this.analysis_id&&(this.analysis={id:this.analysis_id});case 16:case"end":return e.stop()}}),e,this,[[3,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updated",value:function(){this.checkUploadState()}},{key:"registerUploadEvents",value:function(){var e=this;k["a"].on(F["a"].COMPLETED,function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v["a"].updateAnalysisState(a.id,{state:S["b"].PICK_ME_UP});case 3:A["a"].removeItem(D["a"]),f["a"].showSuccessAlert(e.$t("upload-completed-successfully").toString()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),f["a"].showError(t.t0);case 10:e.isCreated&&(e.uploadButton.stopLoading(),e.uploadButton.disable(),e.analysis=void 0,e.showCancelButton=!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()),k["a"].on(F["a"].FAILED,function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return f["a"].showErrorAlert(e.$t(S["b"].UPLOAD_FAILED).toString()),console.error(a),t.prev=2,t.next=5,v["a"].updateAnalysisState(k["a"].getMetadata().id,{state:S["b"].UPLOAD_FAILED,message:a});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),console.error(t.t0);case 10:e.isCreated&&e.onFailed();case 11:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e){return t.apply(this,arguments)}}()),k["a"].on(F["a"].FILE_RETRY,(function(t,a){f["a"].showWarningAlert("".concat(e.$t("upload-error-retry").toString()," ").concat(a,"/").concat(k["a"].getMaxRetries()),"resumable-upload-error-retry")}))}},{key:"checkUploadState",value:function(){k["a"].hasState(F["b"].UPLOADING)?this.uploadButton.startLoading():k["a"].hasState(F["b"].FAILED)?this.onFailed():this.analysis&&this.waitForFiles&&this.waitForFiles.length>0&&(f["a"].showInfoAlert(this.$t("need-files-to-upload_descr").toString()+'<ul style="margin: 5px 0 0 40px;"><li>'+this.waitForFiles.join("</li><li>")+"</li></ul>"),this.uploadButtonTxt=this.$t("resume-upload").toString(),this.uploadButton.disable(),this.showCancelButton=!0)}},{key:"fetchData",value:function(){return A["a"].getItem(this.storageKey)}},{key:"storeData",value:function(){var e=this.getStorageData();e?A["a"].setItem(this.storageKey,e):A["a"].removeItem(this.storageKey)}},{key:"getStorageData",value:function(){return this.analysis&&{newAnalysis:{files:[],plant_id:this.newAnalysis.plant_id},analysis:this.analysis,fileNames:this.appFileUpload.files.map((function(e){return e.fileName}))}||void 0}},{key:"onSubmit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!k["a"].hasState(F["b"].FAILED)){e.next=3;break}return this.$router.go(0),e.abrupt("return");case 3:if(e.prev=3,this.onUploading(),this.analysis){e.next=9;break}return e.next=8,v["a"].createAnalysis(this.newAnalysis);case 8:this.analysis=e.sent;case 9:this.storeData(),this.appFileUpload.upload(v["a"].getAnalysisFileUploadUrl(this.analysis.id),{id:this.analysis.id}),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](3),f["a"].showError(e.t0),this.uploadButton.stopLoading();case 17:case"end":return e.stop()}}),e,this,[[3,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onFailed",value:function(){this.uploadButton.stopLoading(),this.uploadButtonTxt=this.$t("retry-upload").toString(),this.showCancelButton=!0}},{key:"onUploading",value:function(){this.uploadButton.startLoading(),this.showCancelButton=!1}},{key:"onCancelUpload",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.analysis){e.next=2;break}return e.abrupt("return");case 2:return this.cancelUploadButton.startLoading(),this.appFileUpload.cancel(),A["a"].removeItem(this.storageKey),this.uploadButton.stopLoading(),this.uploadButton.enable(),this.uploadButtonTxt=this.$t("upload").toString(),f["a"].clearAlert(),e.prev=9,e.next=12,v["a"].cancelAnalysisUpload(this.analysis.id);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](9),console.error(e.t0);case 17:return e.prev=17,this.analysis=void 0,this.cancelUploadButton.stopLoading(),this.showCancelButton=!1,this.$router.go(0),e.finish(17);case 23:case"end":return e.stop()}}),e,this,[[9,14,17,23]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);E([Object(d["c"])()],R.prototype,"appFileUpload",void 0),E([Object(d["c"])()],R.prototype,"uploadButton",void 0),E([Object(d["c"])()],R.prototype,"cancelUploadButton",void 0),E([Object(d["b"])({default:null})],R.prototype,"analysis_id",void 0),R=E([Object(d["a"])({name:"app-analysis-upload",components:{AppContent:y["a"],AppFileUpload:O["a"],AppButton:_["a"]}})],R);var x=R,j=x,U=a(39),I=Object(U["a"])(j,b,m,!1,null,null,null);I.options.__file="src/app/analysis/analysis-upload.vue";var C=I.exports,P=a(252),B=a(275),N=a(245),L=function(e,t,a,n){var s,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(i<3?s(r):i>3?s(t,a,r):s(t,a))||r);return i>3&&r&&Object.defineProperty(t,a,r),r},$=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.analysis=null,e.isDownloadButtonDisabled=!0,e.downloadFilesRows=[],e.downloadFilesTableColumns=[{key:"selected",label:""},{key:"name",label:e.$t("name").toString()}],e.downloadFilesTableItems=[],e.selectedDonwloadFiles=[],e.allDownloadFilesSelected=!1,e.selectedUpdateState=null,e.updateStateOptions=null,e.selectedUpdateStateMessage="",e}return Object(l["a"])(a,[{key:"created",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateAnalysis(this.$route.params.id);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDownloadFilesSelected",value:function(e){this.selectedDonwloadFiles=e,this.isDownloadButtonDisabled=0===this.selectedDonwloadFiles.length}},{key:"onDownloadSelectedFilesClick",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=Object(i["a"])(this.selectedDonwloadFiles),e.prev=2,t.s();case 4:if((a=t.n()).done){e.next=12;break}return n=a.value,e.next=8,v["a"].getAnalysisFileDownloadUrl(this.analysis.id,n.name);case 8:s=e.sent,B["a"].download(s.url,n.name);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),t.e(e.t0);case 17:return e.prev=17,t.f(),e.finish(17);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e["catch"](0),f["a"].showError(e.t1);case 25:case"end":return e.stop()}}),e,this,[[0,22],[2,14,17,20]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onSelectAllDownloadFiles",value:function(e){if(e){for(var t=0;t<this.downloadFilesTableItems.length;t++)this.downloadFilesTable.selectRow(t);this.onDownloadFilesSelected(this.downloadFilesTableItems.slice())}else{for(var a=0;a<this.downloadFilesTableItems.length;a++)this.downloadFilesTable.unselectRow(a);this.onDownloadFilesSelected([])}}},{key:"onSubmitUpdateState",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,N["a"].startLoading(),this.selectedUpdateState){e.next=4;break}throw{error:"NO_STATE_SELECTED",message:"Please, selecte a state"};case 4:return e.next=6,v["a"].updateAnalysisState(this.analysis.id,{state:this.selectedUpdateState,message:this.selectedUpdateStateMessage});case 6:return e.next=8,this.updateAnalysis(this.analysis.id);case 8:f["a"].showSuccessAlert(this.$t("update-analysis-state-success").toString()),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),f["a"].showError(e.t0);case 14:return e.prev=14,N["a"].stopLoading(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[0,11,14,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setDownloadFilesTableItems",value:function(){var e=[];this.analysis.files.video_files&&(e=e.concat(this.analysis.files.video_files)),this.analysis.files.drone_metadata_files&&(e=e.concat(this.analysis.files.drone_metadata_files)),this.analysis.files.other_files&&(e=e.concat(this.analysis.files.other_files)),e.sort(),this.downloadFilesTableItems=e.map((function(e){return{name:e}}))}},{key:"setUpdateStateOptions",value:function(){var e=this;if(!this.analysis.current_state)return null;var t=S["a"][this.analysis.current_state.state.name];if(0===t.length)return null;this.updateStateOptions=t.map((function(t){return{value:t,text:e.$t(t).toString()}}))}},{key:"updateAnalysis",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v["a"].getAnalysis(t);case 3:this.analysis=e.sent,this.setDownloadFilesTableItems(),this.setUpdateStateOptions(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),f["a"].showError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}()}]),a}(h["a"]);L([Object(d["c"])()],$.prototype,"downloadFilesTable",void 0),$=L([Object(d["a"])({name:"app-edit-analysis",components:{AppContent:y["a"],AppTableContainer:P["a"],AppButton:_["a"],AppAnalysisUpload:C}})],$);var T=$,M=T,G=(a(317),Object(U["a"])(M,n,s,!1,null,null,null));G.options.__file="src/app/analysis/edit-analysis.vue";t["default"]=G.exports}}]);