(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{378:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-content",{attrs:{title:e.$t("plants-overview"),subtitle:e.$t("plants-overview_descr")}},[a("app-table-container",[a("b-table",{attrs:{hover:"",fields:e.columns,items:e.plants,"head-variant":"light","show-empty":"",emptyText:e.$t("no-data"),busy:e.tableLoading},scopedSlots:e._u([{key:"head(actions)",fn:function(){return[a("span",{staticClass:"hidden"},[e._v(e._s(e.$t("actions")))])]},proxy:!0},{key:"cell(name)",fn:function(t){return[a("router-link",{directives:[{name:"show",rawName:"v-show",value:t.item.digitized,expression:"row.item.digitized"}],attrs:{to:{name:"Plant",params:{id:t.item.id}}}},[e._v(" "+e._s(t.item.name)+" ")]),t.item.digitized?e._e():a("span",[e._v(e._s(t.item.name))])]}},{key:"cell(digitized)",fn:function(e){return[a("b-icon",{class:e.item.digitized?"green":"red",attrs:{icon:e.item.digitized?"check2":"x"}})]}},{key:"cell(actions)",fn:function(t){return[a("div",{staticClass:"hover-cell pull-right"},[a("b-button",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdmin,expression:"isSuperAdmin"}],attrs:{variant:"secondary",size:"sm",title:e.$t("upload-dt")},on:{click:function(a){return e.onManagePlantClick(t.item)}}},[a("b-icon",{attrs:{icon:"hammer"}})],1)],1),a("div",{staticClass:"clearfix"})]}}])})],1),a("app-modal-form",{ref:"managePlantModal",attrs:{id:"manage-plant-modal",title:e.$t("upload-dt"),subtitle:e.$t("upload-dt_descr"),"ok-title":e.$t("apply")},on:{submit:e.saveManagePlant}},[a("b-form-group",[a("b-form-checkbox",{attrs:{id:"clear-before-checkbox"},model:{value:e.managePlantModel.clearBefore,callback:function(t){e.$set(e.managePlantModel,"clearBefore",t)},expression:"managePlantModel.clearBefore"}},[e._v(" "+e._s(e.$t("clear-before"))+" ")])],1),a("b-form-group",{attrs:{label:e.$t("select-dt-json-file")}},[a("b-form-file",{attrs:{required:"",accept:".json"},model:{value:e.managePlantModel.file,callback:function(t){e.$set(e.managePlantModel,"file",t)},expression:"managePlantModel.file"}})],1)],1)],1)},r=[];n._withStripped=!0;var i=a(78),s=a(16),l=a(24),o=a(25),c=a(29),u=a(28),d=a(45),p=(a(62),a(61),a(37),a(248),a(124),a(122),a(32)),m=a(81),f=a(261),h=a(77),g=a(80),b=a(276),v=a(63),k=a(250),y=function(e,t,a,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(d["a"])(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,a,s):r(t,a))||s);return i>3&&s&&Object.defineProperty(t,a,s),s},w=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.columns=null,e.plants=null,e.tableLoading=!1,e.managePlantModel={plant:null,clearBefore:!0,file:null},e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.columns=[{key:"name",label:this.$t("name").toString()},{key:"digitized",label:this.$t("digitized").toString()},{key:"analysesCount",label:this.$t("number-of-analyses").toString()}],this.isSuperAdmin&&this.columns.push({key:"actions"}),e.next=4,this.updatePlants();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updatePlants",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s,l,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.tableLoading=!0,t=[],!this.isSuperAdmin){e.next=29;break}return e.next=6,h["a"].getCustomers();case 6:a=e.sent,n=Object(i["a"])(a),e.prev=8,n.s();case 10:if((r=n.n()).done){e.next=19;break}return s=r.value,e.t0=t,e.next=15,h["a"].getPlants(s.id);case 15:e.t1=e.sent,t=e.t0.concat.call(e.t0,e.t1);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t2=e["catch"](8),n.e(e.t2);case 24:return e.prev=24,n.f(),e.finish(24);case 27:e.next=32;break;case 29:return e.next=31,h["a"].getPlants();case 31:t=e.sent;case 32:this.plants=[],l=Object(i["a"])(t),e.prev=34,l.s();case 36:if((o=l.n()).done){e.next=50;break}return c=o.value,e.t3=this.plants,e.t4=c.id,e.t5=c.customer_id,e.t6=c.name,e.t7=!!c.fieldgeometry,e.next=45,h["a"].getAnalysisResults(c.id);case 45:e.t8=e.sent.length,e.t9={id:e.t4,customerId:e.t5,name:e.t6,digitized:e.t7,analysesCount:e.t8},e.t3.push.call(e.t3,e.t9);case 48:e.next=36;break;case 50:e.next=55;break;case 52:e.prev=52,e.t10=e["catch"](34),l.e(e.t10);case 55:return e.prev=55,l.f(),e.finish(55);case 58:e.next=63;break;case 60:e.prev=60,e.t11=e["catch"](0),v["a"].showError(e.t11);case 63:return e.prev=63,this.tableLoading=!1,e.finish(63);case 66:case"end":return e.stop()}}),e,this,[[0,60,63,66],[8,21,24,27],[34,52,55,58]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveManagePlant",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,k["a"].startLoading(),e.next=4,h["a"].importFieldgeometry(this.managePlantModel.file,this.managePlantModel.plant.customerId,this.managePlantModel.plant.id,this.managePlantModel.clearBefore);case 4:t=e.sent,h["a"].waitForTask(t.id,function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(k["a"].stopLoading(),"SUCCESS"!==t.state){e.next=8;break}return a.managePlantModal.hide(),v["a"].showSuccessAlert(a.$t("dt-imported-successfully").toString()),e.next=6,a.updatePlants();case 6:e.next=9;break;case 8:"FAILURE"===t.state?a.managePlantModal.alertError({error:"SOMETHING_WENT_WRONG",details:t.result}):a.managePlantModal.alertError({error:"UNEXPECTED_TASK_STATE",details:t.state+". "+t.result});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.managePlantModal.alertError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onManagePlantClick",value:function(e){this.managePlantModel.plant=e,this.managePlantModel.clearBefore=!0,this.managePlantModel.file=null,this.managePlantModal.show()}}]),a}(g["a"]);y([Object(p["c"])()],w.prototype,"managePlantModal",void 0),w=y([Object(p["a"])({name:"app-analysis",components:{AppContent:m["a"],AppTableContainer:f["a"],AppModalForm:b["a"]}})],w);var x=w,P=x,M=a(39),_=Object(M["a"])(P,n,r,!1,null,null,null);_.options.__file="src/app/plant/plants.vue";t["default"]=_.exports}}]);