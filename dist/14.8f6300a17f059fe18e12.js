(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{279:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-table"},[n("b-table",{ref:"appTable",attrs:{id:e.id,fields:e.fields,items:e.rows,hover:e.hover,busy:e.loading,emptyText:e.emptyText||e.$t("no-data"),selectable:null!==e.selectMode,"select-mode":e.selectMode,"per-page":e.perPage,"current-page":e.currentPage,"head-variant":"light","show-empty":""},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([null!==e.loading?{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center"},[n("b-spinner",{staticClass:"align-middle"})],1)]},proxy:!0}:null,{key:"empty",fn:function(t){return[n("span",{staticClass:"grayed"},[e._v(e._s(t.emptyText))])]}},{key:"head()",fn:function(t){return[e._v(" "+e._s(t.label)+" "),t.field.superAdminOnly?n("app-super-admin-marker"):e._e()]}},{key:"head(selected)",fn:function(){return[n("b-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.enableAllSelection,expression:"enableAllSelection"}],on:{change:e.onSelectAllFiles}})]},proxy:!0},{key:"cell(selected)",fn:function(t){var r=t.rowSelected;return[n("b-checkbox",{directives:[{name:"show",rawName:"v-show",value:"multi"===e.selectMode,expression:"selectMode === 'multi'"}],staticClass:"b-table-selectable-checkbox",attrs:{checked:r,disabled:""}})]}},{key:"cell(actions)",fn:function(t){return[e.hoverActions?n("div",{staticClass:"hover-cell pull-right"},[e._t("hoverActions",null,null,t)],2):e._e(),e.hoverActions?n("div",{staticClass:"clear"}):e._e()]}},e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)})],1)},o=[];r._withStripped=!0;var s=n(6),a=n(11),c=n(19),l=n(20),i=n(23),u=n(22),p=n(27),d=(n(46),n(21),n(150),n(17)),m=n(60),f=n(16),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(p["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},b=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(l["a"])(n,[{key:"created",value:function(){this.onColumnsChanged()}},{key:"onColumnsChanged",value:function(){var e=JSON.parse(JSON.stringify(this.columns));this.hoverActions&&e.push({key:"actions",label:""}),"multi"===this.selectMode&&e.unshift({key:"selected",label:""}),this.fields=e}},{key:"onSelectModeChanged",value:function(){this.onColumnsChanged()}},{key:"onRowSelected",value:function(e){this.$emit("rowSelected",e)}},{key:"onSelectAllFiles",value:function(e){e?this.appTable.selectAllRows():this.appTable.clearSelected()}},{key:"enableAllSelection",get:function(){return"multi"===this.selectMode&&this.selectAllColumns}},{key:"selectRow",value:function(e){this.appTable.selectRow(e)}},{key:"unselectRow",value:function(e){this.appTable.unselectRow(e)}},{key:"clearSelected",value:function(){this.appTable.clearSelected()}},{key:"selectAllRows",value:function(){this.appTable.selectAllRows()}},{key:"refresh",value:function(){var e=Object(a["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.appTable.refresh();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(d["default"]);h([Object(f["b"])({required:!0})],b.prototype,"columns",void 0),h([Object(f["b"])({default:[]})],b.prototype,"rows",void 0),h([Object(f["b"])({default:null})],b.prototype,"id",void 0),h([Object(f["b"])({default:!0})],b.prototype,"hover",void 0),h([Object(f["b"])({default:""})],b.prototype,"emptyText",void 0),h([Object(f["b"])({default:!1})],b.prototype,"loading",void 0),h([Object(f["b"])({default:!1})],b.prototype,"hoverActions",void 0),h([Object(f["b"])({default:null})],b.prototype,"perPage",void 0),h([Object(f["b"])({default:null})],b.prototype,"currentPage",void 0),h([Object(f["b"])({default:null})],b.prototype,"selectMode",void 0),h([Object(f["b"])({default:0})],b.prototype,"maxRowSelectoin",void 0),h([Object(f["b"])({default:!1})],b.prototype,"selectAllColumns",void 0),h([Object(f["c"])()],b.prototype,"appTable",void 0),h([Object(f["d"])("columns")],b.prototype,"onColumnsChanged",null),h([Object(f["d"])("selectMode")],b.prototype,"onSelectModeChanged",null),b=h([Object(f["a"])({name:"app-table",components:{AppSuperAdminMarker:m["a"]}})],b);var v=b,y=v,C=(n(300),n(32)),w=Object(C["a"])(y,r,o,!1,null,null,null);w.options.__file="src/app/shared/components/app-table/app-table.vue";t["a"]=w.exports},281:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"app-table-container "+(e.size?"app-table-container-"+e.size:"")},[e._t("default")],2)},o=[];r._withStripped=!0;var s=n(20),a=n(19),c=n(23),l=n(22),i=n(27),u=(n(46),n(21),n(17)),p=n(16),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(i["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(e){Object(c["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(a["a"])(this,n),t.apply(this,arguments)}return Object(s["a"])(n)}(u["default"]);d([Object(p["b"])({default:""})],m.prototype,"size",void 0),m=d([p["a"]],m);var f=m,h=f,b=(n(299),n(32)),v=Object(b["a"])(h,r,o,!1,null,null,null);v.options.__file="src/app/shared/components/app-table-container/app-table-container.vue";t["a"]=v.exports},284:function(e,t,n){"use strict";var r=n(24),o=n(74),s=n(51),a=n(29),c=n(153),l=[],i=l.sort,u=a((function(){l.sort(void 0)})),p=a((function(){l.sort(null)})),d=c("sort"),m=u||!p||!d;r({target:"Array",proto:!0,forced:m},{sort:function(e){return void 0===e?i.call(s(this)):i.call(s(this),o(e))}})},285:function(e,t,n){},286:function(e,t,n){},299:function(e,t,n){"use strict";n(285)},300:function(e,t,n){"use strict";n(286)},342:function(e,t,n){},423:function(e,t,n){"use strict";n(342)},470:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-settings-customers"},[n("div",{staticClass:"app-settings-customers-table-toolbar"},[n("app-button",{directives:[{name:"b-modal",rawName:"v-b-modal.edit-customer-modal",modifiers:{"edit-customer-modal":!0}}],attrs:{variant:"primary"},on:{click:e.onCreateCustomerClick}},[e._v(" "+e._s(e.$t("create-customer"))+" ")])],1),n("app-table-container",[n("app-table",{attrs:{columns:e.columns,rows:e.rows,loading:e.loading,hoverActions:!0},scopedSlots:e._u([{key:"cell(plants)",fn:function(t){return[n("span",{staticClass:"grayed"},[e._v(" "+e._s(t.item.plants.map((function(e){return e.name})).join(", "))+" ")])]}},{key:"hoverActions",fn:function(t){return[n("app-button",{attrs:{variant:"secondary",size:"sm",title:e.$t("edit-customer"),icon:"wrench"},on:{click:function(n){return e.onEditCustomerClick(t.item)}}}),n("app-button",{attrs:{variant:"outline-danger",size:"sm",title:e.$t("delete-customer"),icon:"trash"},on:{click:function(n){return e.onDeleteCustomerClick(t.item)}}})]}}])})],1),n("app-modal-form",{ref:"appCustomerModal",attrs:{id:"edit-customer-modal",title:e.customerModalTitle,"ok-title":e.customerModalOkTitle,modalLoading:e.customerModalLoading},on:{submit:e.onSubmitCustomer}},[e.currentCustomer?n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:e.$t("name"),"label-for":"name"}},[n("b-form-input",{attrs:{id:"customerName",placeholder:e.$t("name"),required:""},model:{value:e.currentCustomer.name,callback:function(t){e.$set(e.currentCustomer,"name",t)},expression:"currentCustomer.name"}})],1)],1),n("b-col",[n("b-form-group",{attrs:{label:e.$t("role"),"label-for":"role"}},[n("b-form-select",{attrs:{id:"role",options:e.roles},model:{value:e.currentCustomer.role,callback:function(t){e.$set(e.currentCustomer,"role",t)},expression:"currentCustomer.role"}})],1)],1)],1):e._e(),n("b-row",[n("b-col",[n("div",[n("b",[e._v(e._s(e.$t("plants")))])]),n("div",{staticClass:"app-settings-customers-plants-selection"},e._l(e.selectPlants,(function(t){return n("div",{key:t.plant.id},[n("b-checkbox",{model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"selectPlant.selected"}},[e._v(" "+e._s(t.plant.name)+" "),t.otherCustomers?n("small",{staticClass:"grayed"},[e._v(e._s(t.otherCustomers))]):e._e()])],1)})),0)])],1)],1)],1)},o=[];r._withStripped=!0;var s,a=n(6),c=n(59),l=n(11),i=n(19),u=n(20),p=n(23),d=n(22),m=n(27),f=(n(46),n(21),n(112),n(95),n(94),n(116),n(284),n(72),n(151),n(144),n(145),n(16)),h=n(281),b=n(279),v=n(71),y=n(147),C=n(47);(function(e){e["SERVICE"]="Service",e["OWNER"]="Owner",e["OPERATOR"]="Operator"})(s||(s={}));var w=n(42),O=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(m["a"])(Reflect))&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},k=function(e){Object(p["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;return Object(i["a"])(this,n),e=t.apply(this,arguments),e.columns=[],e.rows=[],e.loading=!1,e.customerModalLoading=!1,e.customerModalTitle="",e.customerModalOkTitle="",e.selectPlants=[],e.currentCustomer=null,e}return Object(u["a"])(n,[{key:"created",value:function(){var e=Object(l["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.columns=[{key:"name",label:this.$t("name").toString()},{key:"role",label:this.$t("role").toString()},{key:"plants",label:this.$t("plants").toString()}],this.roles=[{value:null,text:""}].concat(Object(c["a"])(Object.keys(s).map((function(e){return{value:s[e],text:s[e]}})))),e.next=4,this.updateCustomerRows();case 4:return e.prev=4,e.next=7,C["a"].getAllPlants();case 7:this.plants=e.sent.sort((function(e,t){var n=e.name.toLowerCase(),r=t.name.toLowerCase();return n<r?-1:n>r?1:0})),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](4),this.showError(e.t0);case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateCustomerRows",value:function(){var e=Object(l["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,C["a"].getCustomers();case 4:this.rows=e.sent.map((function(e){return{id:e.id,name:e.name,role:e.role,plants:e.plants}})).sort((function(e,t){var n=e.name.toLowerCase(),r=t.name.toLowerCase();return n<r?-1:n>r?1:0})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.showError(e.t0);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onCreateCustomerClick",value:function(){this.currentCustomer={id:null,name:"",role:null,plants:[]},this.selectPlants=this.plants.map((function(e){return{plant:e,selected:!1,otherCustomers:e.customers.map((function(e){return e.name})).join(", ")}})),this.customerModalTitle=this.$t("create-customer").toString(),this.customerModalOkTitle=this.$t("create").toString(),this.appCustomerModal.show()}},{key:"onEditCustomerClick",value:function(e){this.currentCustomer=e,this.selectPlants=this.plants.map((function(t){return{plant:t,selected:!!e.plants.find((function(e){return e.id===t.id})),otherCustomers:t.customers.filter((function(t){return t.id!==e.id})).map((function(e){return e.name})).join(", ")}})),this.customerModalTitle=this.$t("edit-customer").toString()+": "+e.name,this.customerModalOkTitle=this.$t("apply").toString(),this.appCustomerModal.show()}},{key:"onSubmitCustomer",value:function(){var e=Object(l["a"])(Object(a["a"])().mark((function e(){var t;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.customerModalLoading=!0,e.prev=1,t=this.selectPlants.filter((function(e){return e.selected})).map((function(e){return e.plant.id})),null!==this.currentCustomer.id){e.next=9;break}return e.next=6,C["a"].createCustomer({name:this.currentCustomer.name,role:this.currentCustomer.role||void 0,plant_ids:t});case 6:this.showSuccess(this.$t("customer-created-success").toString()),e.next=12;break;case 9:return e.next=11,C["a"].updateCustomer(this.currentCustomer.id,{name:this.currentCustomer.name,role:this.currentCustomer.role||void 0,plant_ids:t});case 11:this.showSuccess(this.$t("customer-updated-success").toString());case 12:return this.appCustomerModal.hide(),e.next=15,this.updateCustomerRows();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](1),this.showError(e.t0);case 20:return e.prev=20,this.customerModalLoading=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[1,17,20,23]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeleteCustomerClick",value:function(){var e=Object(l["a"])(Object(a["a"])().mark((function e(t){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,e.prev=1,confirm(this.$t("sure-delete-customer",{customer:t.name}).toString())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,C["a"].deleteCustomer(t.id);case 6:return this.showSuccess(this.$t("customer-deleted-success",{customer:t.name}).toString()),e.next=9,this.updateCustomerRows();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),this.showError(e.t0);case 14:return e.prev=14,this.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(w["a"]);O([Object(f["c"])()],k.prototype,"appCustomerModal",void 0),k=O([Object(f["a"])({name:"app-settings-customers",components:{AppTableContainer:h["a"],AppModalForm:y["a"],AppTable:b["a"],AppButton:v["a"]}})],k);var g=k,j=g,_=(n(423),n(32)),x=Object(_["a"])(j,r,o,!1,null,null,null);x.options.__file="src/app/settings/customers/customers.vue";t["default"]=x.exports}}]);